(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    241647,       5595]
NotebookOptionsPosition[    231433,       5425]
NotebookOutlinePosition[    232221,       5451]
CellTagsIndexPosition[    232178,       5448]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["DiFfRG Master package", "Title",
 CellChangeTimes->{{3.93548538697089*^9, 
  3.935485390763062*^9}},ExpressionUUID->"6248d5fa-c573-4525-a670-\
9e386e01b70a"],

Cell[CellGroupData[{

Cell["Package Setup", "Chapter",
 CellChangeTimes->{{3.935485401139076*^9, 
  3.935485439328948*^9}},ExpressionUUID->"2e9a49bb-c5b9-4ce9-8785-\
5639cec0c785"],

Cell[CellGroupData[{

Cell["Welcome  Message", "Section",
 CellChangeTimes->{{3.933860697506505*^9, 
  3.933860701282316*^9}},ExpressionUUID->"da5a7dc4-ae9d-446f-93ac-\
ea9cd52b1279"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Print", "[", 
  "\"\<Mathematica package \
\!\(\*StyleBox[\"DiFfRG\",FontWeight->\"Bold\"]\)\!\(\*StyleBox[\" \
\",FontWeight->\"Bold\"]\)loaded\n\
\!\(\*StyleBox[\"Authors\",FontWeight->\"Bold\"]\): Franz Richard Sattler\n\!\
\(\*StyleBox[\"Version\",FontWeight->\"Bold\"]\): 1.0\n\
\!\(\*StyleBox[\"Year\",FontWeight->\"Bold\"]\): 2024\n\>\"", "]"}]], "Input",\

 CellChangeTimes->{{3.93382135272999*^9, 3.933821544369678*^9}, {
   3.933852102960898*^9, 3.93385215369654*^9}, {3.9338533716572638`*^9, 
   3.933853391208394*^9}, 3.933853820321669*^9, {3.9338561865614557`*^9, 
   3.9338561884407663`*^9}, {3.933856230552123*^9, 3.933856361417264*^9}, {
   3.93385647006616*^9, 3.933856531233593*^9}, {3.9338604605457373`*^9, 
   3.933860560578547*^9}, 3.933918356157299*^9, {3.933996906999851*^9, 
   3.933996927267945*^9}, {3.935485443963874*^9, 3.935485454241703*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"94c25270-d3c0-4203-b83e-cd7c70b60a77"],

Cell[BoxData["\<\"Mathematica package \
\\!\\(\\*StyleBox[\\\"DiFfRG\\\",FontWeight->\\\"Bold\\\"]\\)\\!\\(\\*\
StyleBox[\\\" \
\\\",FontWeight->\\\"Bold\\\"]\\)loaded\\n\\!\\(\\*StyleBox[\\\"Authors\\\",\
FontWeight->\\\"Bold\\\"]\\): Franz Richard \
Sattler\\n\\!\\(\\*StyleBox[\\\"Version\\\",FontWeight->\\\"Bold\\\"]\\): 1.0\
\\n\\!\\(\\*StyleBox[\\\"Year\\\",FontWeight->\\\"Bold\\\"]\\): \
2024\\n\"\>"], "Print",
 CellChangeTimes->{
  3.933860706886597*^9, 3.933864540851795*^9, 3.933904794757718*^9, 
   3.933914006318946*^9, 3.933917960176111*^9, 3.933919663865212*^9, 
   3.933919699568782*^9, {3.933919781117552*^9, 3.9339198102042923`*^9}, 
   3.933919882713066*^9, {3.933919943833292*^9, 3.933919951572888*^9}, 
   3.933920004188856*^9, 3.933920107416561*^9, {3.933920201830823*^9, 
   3.93392022537457*^9}, 3.933920258100485*^9, 3.933920343864513*^9, 
   3.933920421528428*^9, 3.933920473229265*^9, 3.933920578955982*^9, {
   3.933920647660254*^9, 3.933920657380004*^9}, 3.9339206952689247`*^9, 
   3.93392079028916*^9, 3.933921177442209*^9, 3.933921214570123*^9, 
   3.9339212458662176`*^9, {3.933921276573933*^9, 3.93392129481119*^9}, 
   3.93392134875428*^9, {3.9339214368741083`*^9, 3.933921455203621*^9}, {
   3.933921878274128*^9, 3.933921903297876*^9}, 3.933921954254926*^9, 
   3.9339220537696037`*^9, 3.933922087351147*^9, 3.933922147861457*^9, 
   3.933922268200555*^9, {3.933922327282453*^9, 3.933922344399807*^9}, {
   3.933922395531685*^9, 3.9339224405799913`*^9}, {3.933922685785295*^9, 
   3.933922704800593*^9}, 3.9339227626011486`*^9, 3.933922828596006*^9, 
   3.933922865770799*^9, 3.933922932078459*^9, 3.933923042865692*^9, 
   3.933923244320567*^9, 3.93392329106692*^9, 3.933923334446946*^9, 
   3.933923402636452*^9, {3.933923576205758*^9, 3.933923597894836*^9}, 
   3.933923781989824*^9, {3.9339238342502117`*^9, 3.933923850142005*^9}, 
   3.933923881712904*^9, 3.933923946260261*^9, 3.933923994048168*^9, {
   3.933924047243856*^9, 3.933924098824136*^9}, {3.933924169137102*^9, 
   3.933924177372635*^9}, 3.933936124831513*^9, 3.933942762661152*^9, {
   3.93394279568764*^9, 3.9339428003176603`*^9}, 3.933943030163054*^9, 
   3.933943076315659*^9, {3.933943155744521*^9, 3.9339431844059668`*^9}, 
   3.9339432393250637`*^9, {3.933943290831739*^9, 3.9339433553221273`*^9}, 
   3.933943460297895*^9, 3.933943495172192*^9, {3.933959099311705*^9, 
   3.933959114695131*^9}, 3.9339591819910307`*^9, 3.933959219955804*^9, 
   3.933959318606521*^9, 3.933959364982352*^9, {3.933959430319045*^9, 
   3.933959491316974*^9}, {3.933996482765983*^9, 3.933996508225358*^9}, {
   3.933996542317891*^9, 3.933996556448373*^9}, 3.933996704785754*^9, 
   3.933996741489249*^9, 3.93399682173739*^9, 3.93548546088989*^9, 
   3.9354863139505*^9, 3.9354863779396567`*^9, 3.935487513210314*^9, 
   3.935487587220757*^9, {3.935487621799477*^9, 3.935487633277811*^9}, 
   3.935488335053338*^9, 3.935488398235867*^9, 3.935488444267528*^9, 
   3.93554502615327*^9, 3.935545129168933*^9, 3.935545373580345*^9, 
   3.935545447041874*^9, 3.935545520837718*^9, {3.935545724142696*^9, 
   3.935545779693371*^9}, 3.9355459851988783`*^9, 3.935546031949313*^9, 
   3.935546073306765*^9, 3.93554612071553*^9, 3.935546154595777*^9, {
   3.9355462312085648`*^9, 3.935546244963451*^9}, 3.93554628344197*^9, {
   3.9355463256710157`*^9, 3.9355464763862667`*^9}, {3.935549087020557*^9, 
   3.935549232551683*^9}, {3.9355492980045433`*^9, 3.935549339253636*^9}, {
   3.935549371586961*^9, 3.935549396359469*^9}, {3.935549428544395*^9, 
   3.935549453764368*^9}, {3.935549490655353*^9, 3.9355495382103233`*^9}, {
   3.935549582294598*^9, 3.935549607624114*^9}, 3.935549637921973*^9, {
   3.935549737299839*^9, 3.935549782550447*^9}, 3.93554982122682*^9, 
   3.935549929458479*^9, 3.935550016916847*^9, {3.935550094144041*^9, 
   3.935550130044713*^9}, 3.935550162647263*^9, {3.935550223916675*^9, 
   3.935550253043428*^9}, 3.9355502917832108`*^9, {3.935550334786324*^9, 
   3.935550355558663*^9}, 3.935550423978838*^9, {3.9355504903796997`*^9, 
   3.935550496911358*^9}, 3.9355505404226418`*^9, 3.935550651063843*^9, {
   3.93555068430879*^9, 3.935550695109069*^9}, 3.935550740544815*^9, {
   3.935550784244273*^9, 3.9355508139549828`*^9}, 3.9355508925622396`*^9, {
   3.9355509328453283`*^9, 3.935550957256585*^9}, {3.935551055366331*^9, 
   3.9355510750436983`*^9}, 3.9355511632634373`*^9, 3.935551310896968*^9, 
   3.935551358172439*^9, 3.935553461911615*^9, 3.937488758957712*^9, 
   3.940306437350896*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"412ae56e-d50c-4fb0-97f4-ff95f2c10346"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load QMeS and TensorBases ", "Section",
 CellChangeTimes->{{3.93548548465976*^9, 
  3.935485499970652*^9}},ExpressionUUID->"4dc5bed6-6c6a-4d50-aeab-\
1ddf7e9466bf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QMeSInstalled", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "QMeSDirectory", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"QMeSDirectory", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"SelectFirst", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"FileNameJoin", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "$UserBaseDirectory", ",", "\"\<Applications\>\"", ",", 
                   "\"\<QMeSderivation\>\""}], "}"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"FileNameJoin", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "$BaseDirectory", ",", "\"\<Applications\>\"", ",", 
                   "\"\<QMeSderivation\>\""}], "}"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"FileNameJoin", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "$InstallationDirectory", ",", "\"\<AddOns\>\"", ",", 
                   "\"\<Applications\>\"", ",", "\"\<QMeSderivation\>\""}], 
                  "}"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"FileNameJoin", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "$InstallationDirectory", ",", "\"\<AddOns\>\"", ",", 
                   "\"\<Packages\>\"", ",", "\"\<QMeSderivation\>\""}], "}"}],
                  "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"FileNameJoin", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "$InstallationDirectory", ",", "\"\<AddOns\>\"", ",", 
                   "\"\<ExtraPackages\>\"", ",", "\"\<QMeSderivation\>\""}], 
                  "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Select", "[", 
               RowBox[{"$Path", ",", 
                RowBox[{
                 RowBox[{"StringContainsQ", "[", 
                  RowBox[{"#", ",", "\"\<QMeSderivation\>\""}], "]"}], 
                 "&"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"DirectoryQ", "[", "#", "]"}], "&"}]}], 
           "\[IndentingNewLine]", "]"}], "<>", "\"\</\>\""}], "//", 
         "Quiet"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "QMeSDirectory", "]"}], "=!=", "String"}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"QMeSInstalled", "[", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ChoiceDialog", "[", 
        RowBox[{
        "\"\<QMeS does not seem to be installed. Do you want to install it?\>\
\"", ",", 
         RowBox[{"WindowTitle", "->", "\"\<Install QMeS\>\""}], ",", 
         RowBox[{"WindowSize", "->", 
          RowBox[{"{", 
           RowBox[{"Medium", ",", "All"}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Import", "[", 
        "\"\<https://raw.githubusercontent.com/QMeS-toolbox/QMeS-Derivation/\
main/QMeSInstaller.m\>\"", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<The \!\(\*StyleBox[\"DiFfRG\",FontWeight->\"Bold\"]\) package \
requires \!\(\*StyleBox[\"QMeS\",FontWeight->\"Bold\"]\) to run.\>\"", "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.93548528018814*^9, 3.9354853778676157`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"ee90b9ab-0619-46b5-a41f-8d6e747c207f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TensorBasesInstalled", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "TensorBasesDirectory", "}"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"TensorBasesDirectory", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"SelectFirst", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"FileNameJoin", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "$UserBaseDirectory", ",", "\"\<Applications\>\"", ",", 
                   "\"\<TensorBases\>\""}], "}"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"FileNameJoin", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "$BaseDirectory", ",", "\"\<Applications\>\"", ",", 
                   "\"\<TensorBases\>\""}], "}"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"FileNameJoin", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "$InstallationDirectory", ",", "\"\<AddOns\>\"", ",", 
                   "\"\<Applications\>\"", ",", "\"\<TensorBases\>\""}], 
                  "}"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"FileNameJoin", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "$InstallationDirectory", ",", "\"\<AddOns\>\"", ",", 
                   "\"\<Packages\>\"", ",", "\"\<TensorBases\>\""}], "}"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"FileNameJoin", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "$InstallationDirectory", ",", "\"\<AddOns\>\"", ",", 
                   "\"\<ExtraPackages\>\"", ",", "\"\<TensorBases\>\""}], 
                  "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Select", "[", 
               RowBox[{"$Path", ",", 
                RowBox[{
                 RowBox[{"StringContainsQ", "[", 
                  RowBox[{"#", ",", "\"\<TensorBases\>\""}], "]"}], "&"}]}], 
               "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"DirectoryQ", "[", "#", "]"}], "&"}]}], 
           "\[IndentingNewLine]", "]"}], "<>", "\"\</\>\""}], "//", 
         "Quiet"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "TensorBasesDirectory", "]"}], "=!=", 
          "String"}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"TensorBasesInstalled", "[", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ChoiceDialog", "[", 
        RowBox[{
        "\"\<TensorBases does not seem to be installed. Do you want to \
install it?\>\"", ",", 
         RowBox[{"WindowTitle", "->", "\"\<Install TensorBases\>\""}], ",", 
         RowBox[{"WindowSize", "->", 
          RowBox[{"{", 
           RowBox[{"Medium", ",", "All"}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Import", "[", 
        "\"\<https://raw.githubusercontent.com/satfra/TensorBases/main/\
TensorBasesInstaller.m\>\"", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<The \!\(\*StyleBox[\"DiFfRG\",FontWeight->\"Bold\"]\) package \
requires \!\(\*StyleBox[\"TensorBases\",FontWeight->\"Bold\"]\) to run.\>\"", 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.93548528018814*^9, 3.9354853778676157`*^9}, {
  3.9354855248021913`*^9, 3.935485575963646*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"b6c058c7-8472-4d64-af22-d443900c6253"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<\!\(\*StyleBox[\"Loading\",FontSize->10,FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\" \",FontSize->10,FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"external\
\",FontSize->10,FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSize->10,FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"packages\",FontSize->\
10,FontSlant->\"Italic\"]\)\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<FunKit`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<\!\(\*StyleBox[\"FunKit\",FontSize->10,FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\" \
\",FontSize->10,FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"loaded\",FontSize->\
10,FontSlant->\"Italic\"]\)\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<QMeSderivation`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<\!\(\*StyleBox[\"QMeS\",FontSize->10,FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\" \
\",FontSize->10,FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"loaded\",FontSize->\
10,FontSlant->\"Italic\"]\)\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<TensorBases`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<\!\(\*StyleBox[\"TensorBases\",FontSize->10,FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\" \
\",FontSize->10,FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"loaded\",FontSize->\
10,FontSlant->\"Italic\"]\)\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<DiFfRG`CodeTools`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<\!\(\*StyleBox[\"CodeTools\",FontSize->10,FontSlant->\"Italic\"]\)\!\(\
\*StyleBox[\" \",FontSize->10,FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"loaded\
\",FontSize->10,FontSlant->\"Italic\"]\)\>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.935485596659787*^9, {3.941266610456051*^9, 3.941266613472143*^9}, {
   3.9461106876753387`*^9, 3.946110705945713*^9}, {3.946110755338848*^9, 
   3.946110762582974*^9}, {3.953378202135497*^9, 
   3.95337820796636*^9}},ExpressionUUID->"eef75579-ae63-4ec4-a33b-\
b226833913f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Init", "Section",
 CellChangeTimes->{{3.919928560443655*^9, 3.91992856291497*^9}, {
  3.933821623541608*^9, 
  3.933821625001503*^9}},ExpressionUUID->"1acf37e7-e1e9-4f65-abab-\
efb2f0611907"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"BeginPackage", "[", "\"\<DiFfRG`\>\"", "]"}], ";"}], "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Unprotect", "[", "\"\<DiFfRG`*\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Unprotect", "[", "\"\<DiFfRG`Private`*\>\"", "]"}], ";"}], "\n", 
   
   RowBox[{
    RowBox[{"ClearAll", "[", "\"\<DiFfRG`*\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ClearAll", "[", "\"\<DiFfRG`Private`*\>\"", "]"}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.917437823899316*^9, 3.917437865877355*^9}, 
   3.918319540359568*^9, {3.918571376709474*^9, 3.918571381993163*^9}, {
   3.918571723423622*^9, 3.918571759564589*^9}, {3.918572083319786*^9, 
   3.918572109042968*^9}, {3.918572153658847*^9, 3.9185721676824493`*^9}, 
   3.918572256965791*^9, {3.921794881128136*^9, 3.921794894868227*^9}, {
   3.921837555545008*^9, 3.921837572726562*^9}, {3.924145135891276*^9, 
   3.924145141069645*^9}, {3.930796106319742*^9, 3.930796154391613*^9}, {
   3.930796383888001*^9, 3.930796443504225*^9}, 3.9307970905042343`*^9, {
   3.930832616160828*^9, 3.930832657016365*^9}, {3.932041387765153*^9, 
   3.932041402023022*^9}, {3.932623442104257*^9, 3.932623471575926*^9}, 
   3.932817954924417*^9, {3.933260811860936*^9, 3.933260818116788*^9}, {
   3.933260872980472*^9, 3.933260874252234*^9}, 3.933260917997336*^9, {
   3.935485231191088*^9, 3.93548523679556*^9}, {3.935485592500398*^9, 
   3.93548563277157*^9}, 3.93555072749044*^9, 3.943459596337636*^9, 
   3.943465950587963*^9},ExpressionUUID->"0ecf2351-416b-4029-aab2-\
5caad4646302"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Head", "[", "$DistributedContexts", "]"}], "=!=", "List"}], ",", 
    RowBox[{"$DistributedContexts", "=", 
     RowBox[{"{", "}"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$DistributedContexts", "=", 
  RowBox[{"$DistributedContexts", "\[Union]", 
   RowBox[{"{", 
    RowBox[{
    "$Context", ",", "\"\<DiFfRG`\>\"", ",", "\"\<FormTracer`\>\"", ",", 
     "\"\<QMeSderivation`\>\"", ",", "\"\<QMeSderivation`Tools`\>\"", ",", 
     "\"\<QMeSderivation`Private`\>\"", ",", "\"\<TensorBases`\>\"", ",", 
     "\"\<TensorBases`Private`\>\""}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.93548563967558*^9, 3.935485646356295*^9}, {
   3.935930341245206*^9, 3.935930374068211*^9}, 3.935930819644388*^9},
 CellLabel->"In[16]:=",ExpressionUUID->"2986308d-feb7-46e4-962b-1f4a31c7cf15"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"DiFfRG`\"\>", ",", "\<\"FormTracer`\"\>", 
   ",", "\<\"FormTracer`Private`\"\>", ",", "\<\"Global`\"\>", 
   ",", "\<\"QMeSderivation`\"\>", ",", "\<\"QMeSderivation`Private`\"\>", 
   ",", "\<\"QMeSderivation`Tools`\"\>", ",", "\<\"TensorBases`\"\>", 
   ",", "\<\"TensorBases`Private`\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.940306439558737*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"b2a116db-9433-486f-8e76-ed979ff3cea4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exports", "Section",
 CellChangeTimes->{{3.919928560443655*^9, 3.91992856291497*^9}, 
   3.933821631058873*^9},ExpressionUUID->"099d12f8-45f0-4498-861c-\
4146c22241e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetDirectory", "::", "usage"}], "=", 
    "\"\<GetDirectory[]\nReturns the directory in which either the package \
file or notebook is located.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AutoExport", "::", "usage"}], "=", 
    "\"\<AutoExport[]\nTurns on automatic export of the current notebook to a \
.m file.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AutoSaveRestore", "::", "usage"}], "=", 
    "\"\<AutoSaveRestore[fileName_String,expr_]\nEvaluates expr if the file \
fileName does not yet exist and saves it to fileName as a .m file. If \
fileName exists, it does not evaluate expr, but simply loads the \
contents.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearTraceCache", "::", "usage"}], "=", 
   "\"\<ClearTraceCache[]\nRemoves the folder TraceBuffer.\n\n\
ClearTraceCache[name_String]\nRemoves the folder TraceBuffer/name/\>\""}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.935485945922835*^9, 3.935486027683341*^9}, {
  3.935486362899207*^9, 3.935486363587503*^9}, {3.9354877229798193`*^9, 
  3.935487860547949*^9}},
 CellLabel->
  "In[728]:=",ExpressionUUID->"f0438960-5e66-4714-ab13-348d02ca9679"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MatsubaraSum", "::", "usage"}], " ", "=", " ", 
   "\"\<MatsubaraSum[expr_,p0_Symbol,T_]\nSums the expression expr over p0, \
with p0 = 2\[Pi]T*n, where n\[Element]\[CapitalZeta].\>\""}], ";"}]], "Input",\

 CellChangeTimes->{{3.93548801132377*^9, 3.9354880677715263`*^9}},
 CellLabel->
  "In[732]:=",ExpressionUUID->"9368b5d6-feeb-454a-8d00-94cd703784f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ResolveChargeConjugation", "::", "usage"}], "=", 
   "\"\<ResolveChargeConjugation[expr_]\nResolves all occurences of \
ChargeConj[i,j] by using the effect of these in Weyl representation.\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9355459120701447`*^9, 3.9355459877501297`*^9}},
 CellLabel->
  "In[733]:=",ExpressionUUID->"b7a9e79b-a6ff-4ce9-a961-d0b7ede31244"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UseSU3GellMannTrace", "::", "usage"}], "=", 
   "\"\<SU3GellMannTrace[value_?BooleanQ,groupName_String:\\\"color\\\"]\n\
Traces the generators of the fundamental representation in the given group as \
SU(3) Gell-Mann matrices explicitly.\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.935485656971459*^9, 3.93548566110763*^9}, {
  3.935485941323501*^9, 3.9354859425166397`*^9}},
 CellLabel->
  "In[734]:=",ExpressionUUID->"e984b499-c21d-4662-82c3-8e51dad58e88"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PreTrace", "::", "usage"}], "=", 
  "\"\<PreTrace[expr_]\nResolve charge conjugation and perform possibly the \
explicit color trace.\>\""}]], "Input",
 CellChangeTimes->{{3.943460274700851*^9, 
  3.9434603076569567`*^9}},ExpressionUUID->"0e042229-5a4f-4fb5-a9d1-\
845b7b27e442"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FormMomentumExpansion", "::", "usage"}], "=", 
  "\"\<FormMomentumExpansion[momenta___]\>\""}], "\[IndentingNewLine]", 
 RowBox[{"FiniteTFormMomentumExpansion", "[", "momenta__", "]"}]}], "Input",
 CellChangeTimes->{{3.9434603228817997`*^9, 
  3.943460340621646*^9}},ExpressionUUID->"af7781f0-142e-49aa-b767-\
d384ba23c0fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MakeP0FormRule", "::", "usage"}], "=", 
  "\"\<MakeP0FormRule[q_,{momenta__},{projections__}]\>\""}], "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetFTSynonym", "::", "usage"}], "=", 
  "\"\<GetFTSynonym[symbol_]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeSPFormRule", "::", "usage"}], "=", 
  "\"\<MakeSPFormRule[q_,p_,momenta__]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeSPFormRule", "::", "usage"}], "=", 
  "\"\<MakeSPFormRule[q_,p_,momenta__]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeSPFiniteTFormRule", "::", "usage"}], "=", 
  "\"\<MakeSPFiniteTFormRule[q_,p_,momenta__]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtendedFormTrace", "::", "usage"}], "=", 
   "\"\<ExtendedFormTrace[expr_,disentangle:_?BooleanQ:True,preRepRules_List:{\
},postRepRules_List:{}]\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SeparateScalarProductsFiniteT", "::", "usage"}], "=", 
  "\"\<SeparateScalarProductsFiniteT[expr_]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandScalarProductsFiniteT", "::", "usage"}], "=", 
  "\"\<ExpandScalarProductsFiniteT[expr_]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandScalarProducts", "::", "usage"}], "=", 
  "\"\<ExpandScalarProducts[expr_]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyAllMomenta", "::", "usage"}], "=", 
  "\"\<SimplifyAllMomenta[q_,expr_]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProjectToSymmetricPoint", "::", "usage"}], "=", 
  "\"\<ProjectToSymmetricPoint[expr_,q_Symbol,p_Symbol,momenta___Symbol]\>\""}\
], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjectToSymmetricPointFiniteT", "::", "usage"}], "=", 
   "\"\<ProjectToSymmetricPointFiniteT[expr_,q_Symbol,p_Symbol,momenta___\
Symbol]\>\""}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QuickSimplify", "::", "usage"}], "=", 
  "\"\<QuickSimplify[expr_]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetStandardQuickSimplify", "::", "usage"}], "=", 
  "\"\<SetStandardQuickSimplify[sim_]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetStandardSimplify", "::", "usage"}], "=", 
   "\"\<SetStandardSimplify[sim_]\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDisentangle", "::", "usage"}], "=", 
  "\"\<SetDisentangle[ex_]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SumDiagrams", "::", "usage"}], "=", 
   "\"\<SumDiagrams[nKernels_Integer,postfix_String,number_Integer:0,\
operation_:$StandardQuickSimplify,saveName_String:\\\"sum\\\"]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TraceDiagrams", "::", "usage"}], "=", 
  "\"\<TraceDiagrams[simpFunc_,nKernels_Integer,postfix_String,ex_,\
preRepRules_List:{},postRepRules_List:{}]\>\""}]}], "Input",
 CellChangeTimes->{{3.943460370321447*^9, 
  3.943460621228345*^9}},ExpressionUUID->"0b416ff5-f4df-4493-8255-\
266f3e2d1fc1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Begin  Private", "Section",
 CellChangeTimes->{{3.933821636751761*^9, 
  3.933821641378183*^9}},ExpressionUUID->"d9e7f4e0-bee1-441c-9357-\
518ec0e70346"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.943460179089211*^9, 3.9434601860273657`*^9}, 
   3.943465955808702*^9},ExpressionUUID->"d3d9ecf5-81b9-41a4-ba9e-\
d222237bb21d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utility", "Chapter",
 CellChangeTimes->{{3.918572239959745*^9, 3.91857224113597*^9}, {
  3.935485845098998*^9, 
  3.93548584801917*^9}},ExpressionUUID->"d2b37a69-1798-45aa-ba74-\
ac366e35523f"],

Cell["Some logic for getting Directories etc also from scripts", "Text",
 CellChangeTimes->{{3.921272563157929*^9, 
  3.9212725782034907`*^9}},ExpressionUUID->"ad5cdf87-2437-494b-bacf-\
1d106e594491"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "GetDirectory", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetDirectory", "[", "]"}], ":=", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{"$Notebooks", ",", 
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      RowBox[{"Directory", "[", "]"}]}], "]"}], "<>", "\"\</\>\""}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9354875664513702`*^9, 3.935487578643756*^9}, 
   3.935487643211999*^9},
 CellLabel->
  "In[735]:=",ExpressionUUID->"bd12fd7b-1c57-476f-b00d-ba3c6dae4d82"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AutoExport", "[", 
    RowBox[{"Switch", ":", 
     RowBox[{"_", "?", "BooleanQ"}], ":", "True"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{"Switch", ",", "\[IndentingNewLine]", 
     RowBox[{"SetOptions", "[", 
      RowBox[{
       RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AutoGeneratedPackage", "->", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"InitializationCellEvaluation", "->", "False"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"InitializationCellWarning", "->", "False"}], ",", 
         RowBox[{"StyleDefinitions", "->", 
          RowBox[{"Notebook", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cell", "[", 
               RowBox[{"StyleData", "[", 
                RowBox[{"StyleDefinitions", "->", "\"\<Default.nb\>\""}], 
                "]"}], "]"}], ",", 
              RowBox[{"Cell", "[", 
               RowBox[{
                RowBox[{"StyleData", "[", "\"\<Input\>\"", "]"}], ",", 
                RowBox[{"InitializationCell", "->", "True"}]}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"Visible", "->", "False"}], ",", 
            RowBox[{
            "StyleDefinitions", "->", 
             "\"\<PrivateStylesheetFormatting.nb\>\""}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"SetOptions", "[", 
      RowBox[{
       RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"AutoGeneratedPackage", "->", "False"}], 
        "\[IndentingNewLine]", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.921272580327087*^9, 3.921272598667559*^9}, 
   3.921272782261088*^9, {3.921273693200805*^9, 3.921273696807189*^9}, {
   3.921278866810248*^9, 3.9212788774136553`*^9}, {3.921627757454508*^9, 
   3.92162776156532*^9}, {3.935486039658905*^9, 3.935486083483676*^9}, {
   3.935486256659657*^9, 3.935486305299963*^9}, {3.935487557444902*^9, 
   3.935487559948284*^9}, 3.935487612756431*^9},
 CellLabel->
  "In[737]:=",ExpressionUUID->"045d2a29-83b2-45f3-9096-804f8428948f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AutoSaveRestore", "[", 
    RowBox[{"fileName_String", ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ret", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", 
         RowBox[{"fileName", "<>", "\"\<.m\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ret", "=", 
          RowBox[{"Import", "[", 
           RowBox[{"fileName", "<>", "\"\<.m\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Imported existing file \\\"\>\"", "<>", "fileName", "<>", 
           "\"\<.m\>\"", "<>", "\"\<\\\"...\>\""}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ret", "=", 
          RowBox[{"ReleaseHold", "[", "expr", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"fileName", "<>", "\"\<.m\>\""}], ",", "ret"}], "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Saved to file \\\"\>\"", "<>", "fileName", "<>", "\"\<.m\>\"", 
           "<>", "\"\<\\\"...\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "ret"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"AutoSaveRestore", ",", "HoldRest"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AutoSaveRestoreQuiet", "[", 
    RowBox[{"fileName_String", ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ret", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", 
         RowBox[{"fileName", "<>", "\"\<.m\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ret", "=", 
          RowBox[{"Import", "[", 
           RowBox[{"fileName", "<>", "\"\<.m\>\""}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ret", "=", 
          RowBox[{"ReleaseHold", "[", "expr", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"fileName", "<>", "\"\<.m\>\""}], ",", "ret"}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "ret"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"AutoSaveRestoreQuiet", ",", "HoldRest"}], "]"}]}], "Input",
 CellChangeTimes->{{3.92161756638931*^9, 3.921617597568625*^9}, {
   3.921617751038447*^9, 3.921617778065596*^9}, {3.921617826311932*^9, 
   3.92161786030626*^9}, {3.921617900090035*^9, 3.921618104085333*^9}, {
   3.921618225845419*^9, 3.921618230541135*^9}, {3.921618266747978*^9, 
   3.921618272085401*^9}, {3.921618319712352*^9, 3.921618415917267*^9}, {
   3.921627184815353*^9, 3.921627201480587*^9}, 3.921627645726943*^9, {
   3.921627710605625*^9, 3.921627712159439*^9}, {3.927114779822678*^9, 
   3.92711480650231*^9}},
 CellLabel->
  "In[738]:=",ExpressionUUID->"2249301c-6588-4290-93cc-6173e59d7027"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ClearTraceCache", "[", 
    RowBox[{"name_String", ":", "\"\<\>\""}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"name", "==", "\"\<\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"DeleteDirectory", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"GetDirectory", "[", "]"}], "~~", 
             "\"\<TraceBuffer/\>\""}], ",", 
            RowBox[{"DeleteContents", "->", "True"}]}], "]"}], "//", 
          "Quiet"}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"DeleteDirectory", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"GetDirectory", "[", "]"}], "~~", "\"\<TraceBuffer/\>\"",
              "~~", "name", "~~", "\"\</\>\""}], ",", 
            RowBox[{"DeleteContents", "->", "True"}]}], "]"}], "//", 
          "Quiet"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.935487887781401*^9, 3.935487977611752*^9}, 
   3.9358587103906384`*^9, {3.9434606746523247`*^9, 
   3.943460678422226*^9}},ExpressionUUID->"49ffa1b8-f5a9-48c3-a7b9-\
85ad969f5610"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matsubara sums", "Chapter",
 CellChangeTimes->{{3.930795711602098*^9, 3.930795716861533*^9}, {
  3.935488110604851*^9, 
  3.935488119875801*^9}},ExpressionUUID->"4db05b9d-0e6c-46c1-8bc4-\
444d96782a81"],

Cell["\<\
Explicit summation of Matsubara sums is possible (but perhaps not recommended \
always.)\
\>", "Text",ExpressionUUID->"f39e01f0-a434-46ca-b8c9-036dc7d8a61d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MatsubaraSum", "[", 
    RowBox[{"expr_", ",", "p0_Symbol", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "denom", ",", "poles", ",", "residues", ",", "n", ",", "r", ",", 
       "SumB"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "expr", "]"}], "==", "Plus"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"Total", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"MatsubaraSum", "[", 
                RowBox[{"#", ",", "p0", ",", "T"}], "]"}], "&"}], ",", 
              RowBox[{"List", "@@", "expr"}]}], "]"}], ",", "1"}], "]"}], 
          "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"denom", " ", "=", " ", 
       RowBox[{
        RowBox[{"Denominator", "[", "expr", "]"}], "//", 
        RowBox[{
         RowBox[{"Collect", "[", 
          RowBox[{"#", ",", "p0"}], "]"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"poles", " ", "=", " ", 
       RowBox[{"p0", "/.", 
        RowBox[{"{", 
         RowBox[{"ToRules", "[", 
          RowBox[{"Reduce", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Reduce", "[", 
              RowBox[{
               RowBox[{"denom", "==", "0"}], ",", "p0"}], "]"}], "//", 
             "FullSimplify"}], ",", "p0"}], "]"}], "]"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"poles", " ", "=", " ", 
       RowBox[{"Assuming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"T", ">", "0"}], "&&", 
          RowBox[{"_Symbol", "\[Element]", "Reals"}]}], ",", 
         RowBox[{"poles", "//", "FullSimplify"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"residues", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"n", "=", "1"}], ",", 
        RowBox[{"n", "<=", 
         RowBox[{"Length", "[", "poles", "]"}]}], ",", 
        RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{"Residue", "[", 
            RowBox[{
             RowBox[{"expr", " ", 
              RowBox[{"Coth", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"I", " ", "p0"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"2", "T"}], ")"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p0", ",", 
               RowBox[{"poles", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"residues", ",", "r"}], "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SumB", "=", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "I"}], ")"}]}], " ", 
        RowBox[{"TrigReduce", "[", "residues", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Total", "[", "SumB", "]"}]}]}], "\n", "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{
  3.916559431731933*^9, {3.933650791190683*^9, 3.9336511744864397`*^9}, {
   3.933651223735318*^9, 3.933651455706583*^9}, {3.933651512418861*^9, 
   3.9336515129980993`*^9}, {3.933651557532131*^9, 3.933651967961319*^9}, {
   3.93365206886823*^9, 3.933652271745182*^9}, {3.935485777724496*^9, 
   3.935485797092594*^9}, {3.935487996565898*^9, 3.935488004247981*^9}, 
   3.9423966083226013`*^9, {3.943356604914905*^9, 3.9433566116260633`*^9}, {
   3.9464495110305023`*^9, 3.946449511353907*^9}, {3.946454519057282*^9, 
   3.946454524769248*^9}, 3.946454575226282*^9, 
   3.946454608194537*^9},ExpressionUUID->"7960f290-05bc-46c9-9e8a-\
e030620c84a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tracing  Algorithms", "Chapter",
 CellChangeTimes->{{3.930795711602098*^9, 
  3.930795716861533*^9}},ExpressionUUID->"f5ab99e5-bf40-4be4-99bc-\
a45c18eb6844"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InsertOutputNaming", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "groups", ",", "\[IndentingNewLine]", "outputRulesLorentzTensors", ",", 
       "outputRulesGroupTensors", ",", "outputRules", ",", 
       "\[IndentingNewLine]", "privateOutputRulesLorentzTensors", ",", 
       "privateOutputRulesGroupTensors", ",", "privateOutputRules", ",", 
       "\[IndentingNewLine]", "otherRules"}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"outputRulesLorentzTensors", "=", 
       RowBox[{
        RowBox[{
        "Normal", "[", 
         "FormTracer`Private`lorentzTensorReplacementRulesOutput", "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a_", "[", "c___", "]"}], ":>", "b_"}], ")"}], ":>", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Symbol", "[", 
              RowBox[{"\"\<TB\>\"", "~~", 
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "a", "]"}], ",", "\"\<FTx\>\""}], 
                 "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "[", "c", "]"}], ":>",
             "b"}], ")"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"outputRulesGroupTensors", "=", 
       RowBox[{
        RowBox[{
        "Normal", "[", "FormTracer`Private`groupTensorReplacementRulesOutput",
          "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a_", "[", "c___", "]"}], ":>", "b_"}], ")"}], ":>", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Symbol", "[", 
              RowBox[{"\"\<TB\>\"", "~~", 
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "a", "]"}], ",", "\"\<FTx\>\""}], 
                 "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "[", "c", "]"}], ":>",
             "b"}], ")"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"outputRules", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"outputRulesLorentzTensors", ",", "outputRulesGroupTensors"}],
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"expr", "//.", "outputRules"}], "]"}], "\[IndentingNewLine]", 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.933833876764284*^9, 3.9338339413967957`*^9}, {
   3.933833972229079*^9, 3.933834167020243*^9}, {3.9338342153726*^9, 
   3.9338342157806687`*^9}, {3.933837489957266*^9, 3.933837550765798*^9}, {
   3.9338382714222393`*^9, 3.9338383352946167`*^9}, {3.933840614470008*^9, 
   3.93384070635058*^9}, {3.933840866422611*^9, 3.933840883375325*^9}, {
   3.933840987407135*^9, 3.933841035854702*^9}, {3.9338411904790173`*^9, 
   3.9338412314069366`*^9}, {3.933841270479463*^9, 3.933841274599712*^9}, {
   3.933841364087409*^9, 3.933841366040209*^9}, {3.933841755976303*^9, 
   3.933841760695524*^9}, {3.933843628016041*^9, 3.933843641392967*^9}, {
   3.933846047264516*^9, 3.933846051232049*^9}, {3.933920097856282*^9, 
   3.933920104627795*^9}, {3.933920161842093*^9, 3.933920165476227*^9}, {
   3.933920682476841*^9, 3.933920691609529*^9}, {3.9339223784964547`*^9, 
   3.933922378860069*^9}, {3.935545326143215*^9, 3.9355453407197037`*^9}, {
   3.935545711143091*^9, 3.9355457149595757`*^9}, 3.935545749159793*^9, {
   3.935546098222186*^9, 3.9355461129366617`*^9}, 3.935546152576734*^9, {
   3.935546209151682*^9, 3.935546227566567*^9}, {3.9355492085184298`*^9, 
   3.935549229786601*^9}, 3.935549634622649*^9, {3.935549719558695*^9, 
   3.935549735077989*^9}, 3.935549780502384*^9, 3.935550538158867*^9, 
   3.935550627935109*^9, 3.9355507823837233`*^9, {3.93555088250336*^9, 
   3.9355508904789352`*^9}, {3.935551019830585*^9, 3.9355510250389423`*^9}},
 CellLabel->
  "In[744]:=",ExpressionUUID->"6f9d9584-8426-4353-ba5b-d7eb6fd0cc66"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InsertInputNaming", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"inputRulesLorentzTensors", ",", "inputRulesGroupTensors"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"inputRulesLorentzTensors", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{
          "Normal", "[", 
           "FormTracer`Private`lorentzTensorReplacementRulesInput", "]"}], 
          ",", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"_", "[", "__", "]"}], ":>", 
            RowBox[{"_", "[", "__", "]"}]}], "]"}]}], "]"}], "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a_", "[", "d__", "]"}], ":>", 
            RowBox[{"b_", "[", "c__", "]"}]}], ")"}], ":>", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", "[", "d", "]"}], "->", 
            RowBox[{
             RowBox[{"Symbol", "[", 
              RowBox[{"\"\<TB\>\"", "~~", 
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "b", "]"}], ",", "\"\<FTx\>\""}], 
                 "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "[", "c", "]"}]}],
            ")"}]}], "\[IndentingNewLine]", "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inputRulesGroupTensors", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{
          "Normal", "[", 
           "FormTracer`Private`groupTensorReplacementRulesInput", "]"}], ",", 
          
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"_", "[", "__", "]"}], ":>", 
            RowBox[{"_", "[", "__", "]"}]}], "]"}]}], "]"}], "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a_", "[", "d__", "]"}], ":>", 
            RowBox[{"b_", "[", "c__", "]"}]}], ")"}], ":>", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", "[", "d", "]"}], "->", 
            RowBox[{
             RowBox[{"Symbol", "[", 
              RowBox[{"\"\<TB\>\"", "~~", 
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "b", "]"}], ",", "\"\<FTx\>\""}], 
                 "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "[", "c", "]"}]}],
            ")"}]}], "\[IndentingNewLine]", "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"expr", "//.", "inputRulesLorentzTensors"}], "//.", 
         "inputRulesGroupTensors"}], "/.", 
        RowBox[{"a_Symbol", ":>", 
         RowBox[{"Symbol", "[", 
          RowBox[{"\"\<Global`\>\"", "~~", 
           RowBox[{"SymbolName", "[", "a", "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.933857165667118*^9, 3.933857182796328*^9}, {
  3.933858230693149*^9, 3.933858266931025*^9}, {3.93391992643932*^9, 
  3.93391994147192*^9}, {3.93392021451739*^9, 3.933920214657308*^9}, {
  3.933924042195753*^9, 3.933924042540813*^9}, {3.935545759415051*^9, 
  3.935545776143876*^9}, {3.9355497630308723`*^9, 3.9355497730460443`*^9}},
 CellLabel->
  "In[745]:=",ExpressionUUID->"55d7a86d-c906-48bd-a3bf-992b994560a1"],

Cell[CellGroupData[{

Cell["Charge  Conjugators", "Subsection",
 CellChangeTimes->{{3.930795742637045*^9, 
  3.9307957460108232`*^9}},ExpressionUUID->"12b52e25-a4c7-4a18-be0b-\
c15de07921b6"],

Cell["\<\
In order to be able to deal with charge conjugation operators, define some \
rules for that, too\
\>", "Text",
 CellChangeTimes->{{3.921794048176723*^9, 
  3.92179406483173*^9}},ExpressionUUID->"3361abb5-df92-442c-b140-\
951784d155e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ImplodeTerms", "[", "expr_", "]"}], ":=", "expr"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImplodeTerms", "[", "expr_List", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ret", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"expr", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "List"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Plus", "@@", 
        RowBox[{"Map", "[", 
         RowBox[{"ImplodeTerms", ",", "expr"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Times", "@@", 
        RowBox[{"Map", "[", 
         RowBox[{"ImplodeTerms", ",", "expr"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CollapseTerms", "[", "expr_", "]"}], ":=", "expr"}], ";"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CollapseTerms", "[", "expr_List", "]"}], ":=", 
    RowBox[{"Total", "[", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"CollapseTerms", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}], ",", "expr"}], 
      "]"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FixChargeConj", "[", "expr_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ret", ",", "restoreIdx", ",", "rule", ",", "chargeRules"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "Print", "}"}], ",", 
         RowBox[{"DisentangleLorentzStructures", "[", "False", "]"}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"ret", "=", "expr"}], ";", "\[IndentingNewLine]", 
       RowBox[{"restoreIdx", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ret", "=", 
        RowBox[{"ret", "//.", 
         RowBox[{
          RowBox[{"ChargeConj", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{
             RowBox[{"restoreIdx", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"restoreIdx", ",", 
                RowBox[{"{", 
                 RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}], ";", 
             RowBox[{"InsertOutputNaming", "[", 
              RowBox[{"TBdeltaDirac", "[", 
               RowBox[{"a", ",", "b"}], "]"}], "]"}]}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rule", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"InsertOutputNaming", "[", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ":>", 
            RowBox[{"ChargeConj", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}], ",", 
          "restoreIdx"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ret", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"FormTracer`ExpandTerms", "[", "ret", "]"}], "//.", 
           "rule"}], "//", "Expand"}], "//", "InsertOutputNaming"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"chargeRules", "=", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"TBgamma", "[", 
              RowBox[{"mu_", ",", "a_", ",", "c_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], ":>", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"ChargeConj", "[", 
               RowBox[{"c", ",", "a"}], "]"}]}], 
             RowBox[{"TBgamma", "[", 
              RowBox[{"mu", ",", "a", ",", "b"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"TBgamma", "[", 
              RowBox[{"mu_", ",", "a_", ",", "b_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"b_", ",", "c_"}], "]"}]}], ":>", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"ChargeConj", "[", 
               RowBox[{"a", ",", "b"}], "]"}]}], 
             RowBox[{"TBgamma", "[", 
              RowBox[{"mu", ",", "c", ",", "b"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"TBgamma5", "[", 
              RowBox[{"a_", ",", "c_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], ":>", 
            RowBox[{
             RowBox[{"ChargeConj", "[", 
              RowBox[{"c", ",", "a"}], "]"}], 
             RowBox[{"TBgamma5", "[", 
              RowBox[{"a", ",", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{
             RowBox[{"TBgamma5", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"b_", ",", "c_"}], "]"}]}], ":>", 
            RowBox[{
             RowBox[{"ChargeConj", "[", 
              RowBox[{"a", ",", "b"}], "]"}], 
             RowBox[{"TBgamma5", "[", 
              RowBox[{"c", ",", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"b_", ",", "c_"}], "]"}]}], ":>", 
            RowBox[{"ChargeConj", "[", 
             RowBox[{"a", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"c_", ",", "b_"}], "]"}]}], ":>", 
            RowBox[{"ChargeConj", "[", 
             RowBox[{"c", ",", "a"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"b_", ",", "a_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"b_", ",", "c_"}], "]"}]}], ":>", 
            RowBox[{"ChargeConj", "[", 
             RowBox[{"a", ",", "c"}], "]"}]}], ",", 
           StyleBox["\[IndentingNewLine]",
            FontSize->12], 
           StyleBox["\[IndentingNewLine]",
            FontSize->12], 
           RowBox[{
            RowBox[{
             RowBox[{"ChargeConj", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"a_", ",", "c_"}], "]"}]}], ":>", 
            RowBox[{"deltaDirac", "[", 
             RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ChargeConj", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"c_", ",", "b_"}], "]"}]}], ":>", 
            RowBox[{"deltaDirac", "[", 
             RowBox[{"a", ",", "c"}], "]"}]}], ",", 
           StyleBox["\[IndentingNewLine]",
            FontSize->12], 
           RowBox[{
            RowBox[{
             RowBox[{"ChargeConj", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"b_", ",", "c_"}], "]"}]}], ":>", 
            RowBox[{"-", 
             RowBox[{"deltaDirac", "[", 
              RowBox[{"a", ",", "c"}], "]"}]}]}]}], "\[IndentingNewLine]", 
          "}"}], "//", "InsertOutputNaming"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ret", "=", 
        RowBox[{"ret", "//.", "chargeRules"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "This", " ", "is", " ", "chiral", " ", "Weyl", " ", 
          "representation"}], "-", 
         RowBox[{"specific", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ret", "=", 
        RowBox[{"ret", "//.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ChargeConj", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", "dint", "}"}], ",", 
             RowBox[{
              RowBox[{"TBgamma", "[", 
               RowBox[{"2", ",", "a", ",", "dint"}], "]"}], 
              RowBox[{"TBgamma", "[", 
               RowBox[{"0", ",", "dint", ",", "b"}], "]"}]}]}], "]"}]}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"ImplodeTerms", "[", "ret", "]"}], "//", 
         "InsertOutputNaming"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResolveChargeConjugation", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"expr", ",", 
         RowBox[{"ChargeConj", "[", "__", "]"}], ",", "Infinity"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"expr", "//", "FixChargeConj"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", "expr"}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.921794071700576*^9, 3.921794078742909*^9}, 
   3.921794748930499*^9, {3.9217953410135736`*^9, 3.921795345199584*^9}, {
   3.921795394064973*^9, 3.921795406322345*^9}, {3.921795474089506*^9, 
   3.9217954892319393`*^9}, {3.921796259545465*^9, 3.9217965340971613`*^9}, {
   3.921809400511046*^9, 3.9218094009374237`*^9}, {3.921809477751204*^9, 
   3.921809521144747*^9}, {3.921819777036787*^9, 3.921819784449296*^9}, {
   3.921821062561872*^9, 3.92182106646638*^9}, {3.92182111216293*^9, 
   3.921821142268581*^9}, {3.92183296636515*^9, 3.921833093800383*^9}, 
   3.921833138589645*^9, {3.921840334232685*^9, 3.921840395978014*^9}, {
   3.921841263336787*^9, 3.92184137957843*^9}, {3.921841417246993*^9, 
   3.921841430346073*^9}, {3.92184152286499*^9, 3.9218415322880793`*^9}, {
   3.92184304761236*^9, 3.921843134797408*^9}, {3.92184346299809*^9, 
   3.921843466579792*^9}, {3.921843513268523*^9, 3.921843650662134*^9}, {
   3.9218763686887407`*^9, 3.921876373095786*^9}, {3.921876779896566*^9, 
   3.921876843672817*^9}, {3.921876892158286*^9, 3.921876895208795*^9}, 
   3.921876999005419*^9, {3.921877422185878*^9, 3.921877423113919*^9}, {
   3.921877504351458*^9, 3.9218775200930777`*^9}, {3.921879408878263*^9, 
   3.921879432364671*^9}, {3.921879519947568*^9, 3.9218795262589903`*^9}, {
   3.921879625224653*^9, 3.921879629204245*^9}, {3.9218797062372713`*^9, 
   3.921879717424675*^9}, {3.921879860274888*^9, 3.921879883560752*^9}, {
   3.921879961988386*^9, 3.921879965595957*^9}, {3.921922289271458*^9, 
   3.921922295550026*^9}, {3.922000589516585*^9, 3.922000605735109*^9}, 
   3.92200115042592*^9, {3.922087759206943*^9, 3.922087770942597*^9}, {
   3.922094591637645*^9, 3.922094626680778*^9}, {3.922098049229426*^9, 
   3.922098130631744*^9}, {3.922133397577361*^9, 3.922133455909011*^9}, {
   3.922134103246302*^9, 3.922134191123559*^9}, {3.922134359824643*^9, 
   3.922134371815893*^9}, {3.92217410261769*^9, 3.9221741082647676`*^9}, {
   3.922174171497924*^9, 3.922174177609129*^9}, {3.922174208189384*^9, 
   3.922174209885378*^9}, {3.922181824781329*^9, 3.9221818252646112`*^9}, {
   3.922181871725789*^9, 3.922181935269558*^9}, {3.922183173695031*^9, 
   3.9221832120547857`*^9}, {3.922186286928891*^9, 3.922186311794375*^9}, 
   3.922188616860355*^9, {3.922188712993352*^9, 3.922188723533478*^9}, 
   3.930798963984124*^9, 3.930799184470267*^9, {3.930799964413578*^9, 
   3.9307999952265863`*^9}, {3.930800067610096*^9, 3.930800071653378*^9}, {
   3.930800167112943*^9, 3.930800211257351*^9}, 3.930800250437738*^9, {
   3.930800407514114*^9, 3.930800412349681*^9}, {3.930800833532151*^9, 
   3.930800854324721*^9}, 3.930800887153798*^9, {3.930824118807762*^9, 
   3.930824120172369*^9}, {3.935488145303643*^9, 3.935488155766289*^9}, {
   3.9354882064340277`*^9, 3.935488258821485*^9}, {3.935488309302096*^9, 
   3.9354883246069183`*^9}, {3.9354883929417267`*^9, 3.935488394909334*^9}, {
   3.935488438285787*^9, 3.9354884579176617`*^9}, {3.935545101639827*^9, 
   3.935545108975294*^9}, {3.9355451462241592`*^9, 3.9355451505756903`*^9}, {
   3.9355453974719667`*^9, 3.9355454302876863`*^9}, {3.935545472728133*^9, 
   3.935545473344078*^9}, {3.935545851775097*^9, 3.935545863599102*^9}, {
   3.9355460139593887`*^9, 3.935546029462945*^9}, {3.935546277343554*^9, 
   3.935546460599592*^9}, {3.935549078101664*^9, 3.935549184669874*^9}, {
   3.935549288799494*^9, 3.935549606023324*^9}, {3.935549807231414*^9, 
   3.935549816527628*^9}, {3.93554988225564*^9, 3.935549925646707*^9}, {
   3.935550010087902*^9, 3.935550014895858*^9}, {3.935550416392407*^9, 
   3.935550421311531*^9}, 3.9355504884395514`*^9, {3.935550755464168*^9, 
   3.9355507556713037`*^9}, {3.935550794144079*^9, 3.935550811543816*^9}, {
   3.935550924167426*^9, 3.9355509555042458`*^9}, {3.935551047760272*^9, 
   3.935551053560011*^9}, {3.935551155063036*^9, 3.935551160990932*^9}, {
   3.9355522549291773`*^9, 3.935552307785432*^9}, 3.935552357727501*^9, {
   3.9412668681749763`*^9, 3.941266906476533*^9}, {3.9412669736573973`*^9, 
   3.9412670558885803`*^9}, {3.941267117430084*^9, 3.941267183473654*^9}, {
   3.941267445601304*^9, 3.941267476560678*^9}, {3.9412675643536377`*^9, 
   3.9412676781191263`*^9}, {3.941267718764599*^9, 3.941267891894619*^9}, {
   3.9412686230367947`*^9, 3.941268653569624*^9}, 3.941269674982795*^9, {
   3.941280972816123*^9, 
   3.941280982734414*^9}},ExpressionUUID->"f4637967-a96d-48f9-b7db-\
410a0759650a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"integrateDeltas", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"list1", ",", "list2", ",", 
       RowBox[{"conv", "=", "InsertOutputNaming"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"list1", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], 
            RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
             RowBox[{"a_", ",", "c_"}], "]"}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaLorentz", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaLorentz", "[", 
              RowBox[{"a_", ",", "c_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaLorentz", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], 
            RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
             RowBox[{"c_", ",", "a_"}], "]"}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaLorentz", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaLorentz", "[", 
              RowBox[{"c_", ",", "a_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaLorentz", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
             RowBox[{"b_", ",", "a_"}], "]"}], 
            RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
             RowBox[{"a_", ",", "c_"}], "]"}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaLorentz", "[", 
              RowBox[{"b_", ",", "a_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaLorentz", "[", 
              RowBox[{"a_", ",", "c_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaLorentz", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
             RowBox[{"b_", ",", "a_"}], "]"}], 
            RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
             RowBox[{"c_", ",", "a_"}], "]"}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaLorentz", "[", 
              RowBox[{"b_", ",", "a_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaLorentz", "[", 
              RowBox[{"c_", ",", "a_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaLorentz", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
           RowBox[{"a_", ",", "a_"}], "]"}], ":>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NumberQ", "[", "a", "]"}], ",", "1", ",", "4"}], "]"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaLorentz", "[", 
            RowBox[{"a_", ",", "a_"}], "]"}]}], ":>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NumberQ", "[", "a", "]"}], ",", "1", ",", "4"}], "]"}]}],
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBvec", "[", 
             RowBox[{"p_", ",", "a_"}], "]"}]}], 
           RowBox[{"conv", "@", 
            RowBox[{"TBdeltaLorentz", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}]}], 
           RowBox[{"conv", "@", 
            RowBox[{"TBvec", "[", 
             RowBox[{"q_", ",", "b_"}], "]"}]}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBsp", "[", 
            RowBox[{"p", ",", "q"}], "]"}]}]}], " ", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBvec", "[", 
             RowBox[{"p_", ",", "a_"}], "]"}]}], 
           RowBox[{"conv", "@", 
            RowBox[{"TBdeltaLorentz", "[", 
             RowBox[{"b_", ",", "a_"}], "]"}]}], 
           RowBox[{"conv", "@", 
            RowBox[{"TBvec", "[", 
             RowBox[{"q_", ",", "b_"}], "]"}]}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBsp", "[", 
            RowBox[{"p", ",", "q"}], "]"}]}]}], " ", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBvecs", "[", 
             RowBox[{"p_", ",", "a_"}], "]"}]}], 
           RowBox[{"conv", "@", 
            RowBox[{"TBdeltaLorentz", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}]}], 
           RowBox[{"conv", "@", 
            RowBox[{"TBvecs", "[", 
             RowBox[{"q_", ",", "b_"}], "]"}]}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBsps", "[", 
            RowBox[{"p", ",", "q"}], "]"}]}]}], " ", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBvecs", "[", 
             RowBox[{"p_", ",", "a_"}], "]"}]}], 
           RowBox[{"conv", "@", 
            RowBox[{"TBdeltaLorentz", "[", 
             RowBox[{"b_", ",", "a_"}], "]"}]}], 
           RowBox[{"conv", "@", 
            RowBox[{"TBvecs", "[", 
             RowBox[{"q_", ",", "b_"}], "]"}]}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBsps", "[", 
            RowBox[{"p", ",", "q"}], "]"}]}]}]}], " ", "\[IndentingNewLine]", 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"list2", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], 
            RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
             RowBox[{"a_", ",", "c_"}], "]"}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "c_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaDirac", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], 
            RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
             RowBox[{"c_", ",", "a_"}], "]"}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"c_", ",", "a_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaDirac", "[", 
            RowBox[{"c", ",", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
             RowBox[{"b_", ",", "a_"}], "]"}], 
            RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
             RowBox[{"a_", ",", "c_"}], "]"}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"b_", ",", "a_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "c_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaDirac", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
             RowBox[{"b_", ",", "a_"}], "]"}], 
            RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
             RowBox[{"c_", ",", "a_"}], "]"}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"b_", ",", "a_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"c_", ",", "a_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaDirac", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
           RowBox[{"a_", ",", "a_"}], "]"}], ":>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NumberQ", "[", "a", "]"}], ",", "1", ",", "4"}], "]"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaDirac", "[", 
            RowBox[{"a_", ",", "a_"}], "]"}]}], ":>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NumberQ", "[", "a", "]"}], ",", "1", ",", "4"}], "]"}]}],
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"b_", ",", "a_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBgamma", "[", 
              RowBox[{"mu_", ",", "c_", ",", "a_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBgamma", "[", 
            RowBox[{"mu", ",", "c", ",", "b"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBgamma", "[", 
              RowBox[{"mu_", ",", "c_", ",", "a_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBgamma", "[", 
            RowBox[{"mu", ",", "c", ",", "b"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"b_", ",", "a_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBgamma", "[", 
              RowBox[{"mu_", ",", "a_", ",", "c_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBgamma", "[", 
            RowBox[{"mu", ",", "b", ",", "c"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBgamma", "[", 
              RowBox[{"mu_", ",", "a_", ",", "c_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBgamma", "[", 
            RowBox[{"mu", ",", "b", ",", "c"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"b_", ",", "a_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBgamma5", "[", 
              RowBox[{"c_", ",", "a_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBgamma5", "[", 
            RowBox[{"c", ",", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBgamma5", "[", 
              RowBox[{"c_", ",", "a_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBgamma5", "[", 
            RowBox[{"c", ",", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"b_", ",", "a_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBgamma5", "[", 
              RowBox[{"a_", ",", "c_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBgamma5", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBgamma5", "[", 
              RowBox[{"a_", ",", "c_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBgamma5", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}]}], "\[IndentingNewLine]", 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"expr", "//.", "list1"}], "//.", "list2"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.930823507745618*^9, 3.930823624730839*^9}, {
   3.930823672166363*^9, 3.930823674401813*^9}, {3.930823716357353*^9, 
   3.930823729578874*^9}, {3.930824067213314*^9, 3.930824107286553*^9}, {
   3.930824138233536*^9, 3.930824258570298*^9}, {3.930824296213938*^9, 
   3.930824367001339*^9}, {3.930830348891626*^9, 3.930830397322238*^9}, {
   3.930830541865621*^9, 3.930830567565189*^9}, {3.930830604148001*^9, 
   3.93083061349525*^9}, {3.930847276020247*^9, 3.930847326733864*^9}, {
   3.930847768349673*^9, 3.930847888349812*^9}, {3.933260233083667*^9, 
   3.933260234397295*^9}, {3.935551197431448*^9, 3.935551496967121*^9}, {
   3.935551582713168*^9, 3.9355515949769497`*^9}, 3.935552238961692*^9, {
   3.94127167494462*^9, 
   3.941271816069439*^9}},ExpressionUUID->"18926360-5b65-4d8a-83d8-\
f07b944f6259"]
}, Closed]],

Cell[CellGroupData[{

Cell["SU3 Gell-Mann Tracing algorithm", "Subsection",ExpressionUUID->"79f165a1-f8a9-4344-985e-d675083ef03a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$SU3GellMannGroupName", "=", "color"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$UseSU3GellMannTrace", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UseSU3GellMannTrace", "[", 
   RowBox[{
    RowBox[{"value_", "?", "BooleanQ"}], ",", 
    RowBox[{"groupName_Symbol", ":", "color"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{"value", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DefineFormTracerGroup", "[", 
         RowBox[{"{", 
          RowBox[{"groupName", ",", "SUNfund", ",", "Nc"}], "}"}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"$SU3GellMannGroupName", "=", "groupName"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"$UseSU3GellMannTrace", "=", "value"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.930796451096579*^9, 3.930796532700296*^9}, 
   3.930796888177408*^9, 3.930797084842741*^9, {3.933260715660624*^9, 
   3.93326077398073*^9}, {3.935551666463029*^9, 3.935551776191193*^9}, {
   3.935552046590918*^9, 3.9355520473906403`*^9}},
 CellLabel->
  "In[753]:=",ExpressionUUID->"99262b5b-bcc4-41d1-a31c-57fe268a0708"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"integrateGroupDeltas", "[", 
     RowBox[{"expr_", ",", "dimAdj_", ",", "dimFund_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tmpFundRule", ",", "tmpAdjRule"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FixedPoint", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "/.", 
            RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"tmpFundRule", "=", 
               RowBox[{"FirstCase", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"FormTracer`Private`FTxdeltaFund", "[", 
                    RowBox[{"$SU3GellMannGroupName", ",", "a_", ",", "b_"}], 
                    "]"}], "/;", 
                   RowBox[{"Not", "[", 
                    RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], 
                  "\[RuleDelayed]", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"tmpAdjRule", "=", 
               RowBox[{"FirstCase", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"FormTracer`Private`FTxdeltaAdj", "[", 
                    RowBox[{"$SU3GellMannGroupName", ",", "a_", ",", "b_"}], 
                    "]"}], "/;", 
                   RowBox[{"Not", "[", 
                    RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], 
                  "\[RuleDelayed]", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"tmpFundRule", "===", 
                   RowBox[{"Missing", "[", "\"\<NotFound\>\"", "]"}]}], ",", 
                  RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"FormTracer`Private`FTxdeltaFund", "[", 
                    RowBox[{"$SU3GellMannGroupName", ",", 
                    RowBox[{"tmpFundRule", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"tmpFundRule", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[RuleDelayed]",
                     "1"}], ",", 
                    RowBox[{
                    RowBox[{"tmpFundRule", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"tmpFundRule", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"tmpAdjRule", "===", 
                   RowBox[{"Missing", "[", "\"\<NotFound\>\"", "]"}]}], ",", 
                  RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"FormTracer`Private`FTxdeltaAdj", "[", 
                    RowBox[{"$SU3GellMannGroupName", ",", 
                    RowBox[{"tmpAdjRule", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"tmpAdjRule", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[RuleDelayed]",
                     "1"}], ",", 
                    RowBox[{
                    RowBox[{"tmpAdjRule", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"tmpAdjRule", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
               "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}],
            "/.", 
           RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"tmpFundRule", "=", 
              RowBox[{"FirstCase", "[", 
               RowBox[{"#", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"FormTracer`Private`FTxdeltaFund", "[", 
                   RowBox[{"$SU3GellMannGroupName", ",", "a_", ",", "b_"}], 
                   "]"}], "/;", 
                  RowBox[{"Not", "[", 
                   RowBox[{"NumberQ", "[", "b", "]"}], "]"}]}], 
                 "\[RuleDelayed]", 
                 RowBox[{"{", 
                  RowBox[{"b", ",", "a"}], "}"}]}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"tmpAdjRule", "=", 
              RowBox[{"FirstCase", "[", 
               RowBox[{"#", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"FormTracer`Private`FTxdeltaAdj", "[", 
                   RowBox[{"$SU3GellMannGroupName", ",", "a_", ",", "b_"}], 
                   "]"}], "/;", 
                  RowBox[{"Not", "[", 
                   RowBox[{"NumberQ", "[", "b", "]"}], "]"}]}], 
                 "\[RuleDelayed]", 
                 RowBox[{"{", 
                  RowBox[{"b", ",", "a"}], "}"}]}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Join", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"tmpFundRule", "===", 
                  RowBox[{"Missing", "[", "\"\<NotFound\>\"", "]"}]}], ",", 
                 RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"FormTracer`Private`FTxdeltaFund", "[", 
                    RowBox[{"$SU3GellMannGroupName", ",", 
                    RowBox[{"tmpFundRule", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"tmpFundRule", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[RuleDelayed]",
                     "1"}], ",", 
                   RowBox[{
                    RowBox[{"tmpFundRule", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"tmpFundRule", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], 
                "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"tmpAdjRule", "===", 
                  RowBox[{"Missing", "[", "\"\<NotFound\>\"", "]"}]}], ",", 
                 RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"FormTracer`Private`FTxdeltaAdj", "[", 
                    RowBox[{"$SU3GellMannGroupName", ",", 
                    RowBox[{"tmpAdjRule", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"tmpAdjRule", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[RuleDelayed]",
                     "1"}], ",", 
                   RowBox[{
                    RowBox[{"tmpAdjRule", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"tmpAdjRule", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], 
                "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
              "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], 
          "/.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"FormTracer`Private`FTxdeltaAdj", "[", 
              RowBox[{"$SU3GellMannGroupName", ",", "a_", ",", "a_"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NumberQ", "[", "a", "]"}], ",", "1", ",", "dimAdj"}], 
              "]"}]}], ",", 
            RowBox[{
             RowBox[{"FormTracer`Private`FTxdeltaFund", "[", 
              RowBox[{"$SU3GellMannGroupName", ",", "a_", ",", "a_"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NumberQ", "[", "a", "]"}], ",", "1", ",", "dimFund"}],
               "]"}]}]}], "\[IndentingNewLine]", "}"}]}], "&"}], ",", 
        "\[IndentingNewLine]", "expr"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SU3GellMannTrace", "[", "expr_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dimAdj", "=", "8"}], ",", 
        RowBox[{"dimFund", "=", "3"}], ",", "fg", ",", "f", ",", "T", ",", 
        "deltasIntegrated", ",", "preFactorSeparated", ",", "replacedTensors",
         ",", "adjIndices", ",", "fundIndices", ",", "InsertTensors"}], "}"}],
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"deltasIntegrated", "=", 
        RowBox[{"integrateGroupDeltas", "[", 
         RowBox[{"expr", ",", "dimAdj", ",", "dimFund"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fg", "[", 
         RowBox[{"{", 
          RowBox[{"x_Integer", ",", "y_Integer", ",", "z_Integer"}], "}"}], 
         "]"}], ":=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fg", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "=", "1"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fg", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "4", ",", "7"}], "}"}], "]"}], "=", 
        RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fg", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "5", ",", "6"}], "}"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fg", "[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "4", ",", "6"}], "}"}], "]"}], "=", 
        RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fg", "[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "5", ",", "7"}], "}"}], "]"}], "=", 
        RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fg", "[", 
         RowBox[{"{", 
          RowBox[{"3", ",", "4", ",", "5"}], "}"}], "]"}], "=", 
        RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fg", "[", 
         RowBox[{"{", 
          RowBox[{"3", ",", "6", ",", "7"}], "}"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fg", "[", 
         RowBox[{"{", 
          RowBox[{"4", ",", "5", ",", "8"}], "}"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fg", "[", 
         RowBox[{"{", 
          RowBox[{"6", ",", "7", ",", "8"}], "}"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"list_List", "/;", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "list", "]"}], "==", "3"}], "&&", 
           RowBox[{"IntegerQ", "[", 
            RowBox[{"list", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
           RowBox[{"IntegerQ", "[", 
            RowBox[{"list", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "&&", 
           RowBox[{"IntegerQ", "[", 
            RowBox[{"list", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Signature", "[", "list", "]"}], "*", 
         RowBox[{"fg", "[", 
          RowBox[{"Sort", "[", "list", "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"a_Integer", ",", "i_Integer", ",", "j_Integer"}], "]"}], ":=",
         "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"0", ",", "_", ",", "_"}], "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<ERROR: U3 is not supported as of now (but could be if \
necessary)!\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "=", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"0", ",", "2", ",", "2"}], "]"}], "=", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"0", ",", "3", ",", "3"}], "]"}], "=", 
            RowBox[{"1", "/", 
             RowBox[{"Sqrt", "[", "6", "]"}]}]}]}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"1", ",", "1", ",", "2"}], "]"}], "=", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"1", ",", "2", ",", "1"}], "]"}], "=", 
         RowBox[{"1", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"2", ",", "1", ",", "2"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", "I"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"2", ",", "2", ",", "1"}], "]"}], "=", 
        RowBox[{"-", 
         RowBox[{"T", "[", 
          RowBox[{"2", ",", "1", ",", "2"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"3", ",", "1", ",", "1"}], "]"}], "=", 
        RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"3", ",", "2", ",", "2"}], "]"}], "=", 
        RowBox[{"-", 
         RowBox[{"T", "[", 
          RowBox[{"3", ",", "1", ",", "1"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"4", ",", "1", ",", "3"}], "]"}], "=", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"4", ",", "3", ",", "1"}], "]"}], "=", 
         RowBox[{"1", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"5", ",", "1", ",", "3"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", "I"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"5", ",", "3", ",", "1"}], "]"}], "=", 
        RowBox[{"-", 
         RowBox[{"T", "[", 
          RowBox[{"5", ",", "1", ",", "3"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"6", ",", "2", ",", "3"}], "]"}], "=", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"6", ",", "3", ",", "2"}], "]"}], "=", 
         RowBox[{"1", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"7", ",", "2", ",", "3"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", "I"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"7", ",", "3", ",", "2"}], "]"}], "=", 
        RowBox[{"-", 
         RowBox[{"T", "[", 
          RowBox[{"7", ",", "2", ",", "3"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"8", ",", "1", ",", "1"}], "]"}], "=", 
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"8", ",", "2", ",", "2"}], "]"}], "=", 
         RowBox[{"1", "/", 
          RowBox[{"Sqrt", "[", "12", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"8", ",", "3", ",", "3"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", "1"}], "/", 
         RowBox[{"Sqrt", "[", "3", "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"InsertTensors", ":=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FormTracer`Private`FTxT", "[", 
            RowBox[{
            "$SU3GellMannGroupName", ",", "a_", ",", "i_", ",", "j_"}], "]"}],
            "\[RuleDelayed]", 
           RowBox[{"T", "[", 
            RowBox[{"a", ",", "i", ",", "j"}], "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"FormTracer`Private`FTxF", "[", 
            RowBox[{
            "$SU3GellMannGroupName", ",", "a_", ",", "b_", ",", "c_"}], "]"}],
            "\[RuleDelayed]", 
           RowBox[{"f", "[", 
            RowBox[{"{", 
             RowBox[{"a", ",", "b", ",", "c"}], "}"}], "]"}]}]}], "}"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"adjIndices", "=", 
        RowBox[{"GetClosedAdjGroupIndices", "[", 
         RowBox[{"deltasIntegrated", ",", "_"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fundIndices", "=", 
        RowBox[{"GetClosedFundGroupIndices", "[", 
         RowBox[{"deltasIntegrated", ",", "_"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"adjIndices", "===", 
           RowBox[{"{", "}"}]}], "&&", 
          RowBox[{"fundIndices", "===", 
           RowBox[{"{", "}"}]}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"deltasIntegrated", "//.", "InsertTensors"}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"preFactorSeparated", "=", 
        RowBox[{"FormTracer`Private`separateFactors", "[", 
         RowBox[{"deltasIntegrated", ",", 
          RowBox[{"Alternatives", "@@", 
           RowBox[{
           "First", "[", "FormTracer`Private`groupTensorsList", "]"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"replacedTensors", "=", 
        RowBox[{
         RowBox[{"Last", "[", "preFactorSeparated", "]"}], "//.", 
         "InsertTensors"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{"preFactorSeparated", "//.", "InsertTensors"}], "]"}], "*", 
          RowBox[{"Sum", "[", 
           RowBox[{"replacedTensors", ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"fundInd", ",", "dimFund"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"fundInd", ",", "fundIndices"}], "}"}]}], "]"}], 
                ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"adjInd", ",", "dimAdj"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"adjInd", ",", "adjIndices"}], "}"}]}], "]"}]}], 
               "]"}]}], "]"}]}], "]"}]}], "//", "integrateDeltas"}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InsertSU3GellManns", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dimAdj", "=", "8"}], ",", 
       RowBox[{"dimFund", "=", "3"}], ",", "fg", ",", "f", ",", "T", ",", 
       "deltasIntegrated", ",", "preFactorSeparated", ",", "replacedTensors", 
       ",", "adjIndices", ",", "fundIndices", ",", "InsertTensors", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"conv", "=", "InsertOutputNaming"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fg", "[", 
        RowBox[{"{", 
         RowBox[{"x_Integer", ",", "y_Integer", ",", "z_Integer"}], "}"}], 
        "]"}], ":=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fg", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "=", "1"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fg", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "4", ",", "7"}], "}"}], "]"}], "=", 
       RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fg", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "5", ",", "6"}], "}"}], "]"}], "=", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fg", "[", 
        RowBox[{"{", 
         RowBox[{"2", ",", "4", ",", "6"}], "}"}], "]"}], "=", 
       RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fg", "[", 
        RowBox[{"{", 
         RowBox[{"2", ",", "5", ",", "7"}], "}"}], "]"}], "=", 
       RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fg", "[", 
        RowBox[{"{", 
         RowBox[{"3", ",", "4", ",", "5"}], "}"}], "]"}], "=", 
       RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fg", "[", 
        RowBox[{"{", 
         RowBox[{"3", ",", "6", ",", "7"}], "}"}], "]"}], "=", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fg", "[", 
        RowBox[{"{", 
         RowBox[{"4", ",", "5", ",", "8"}], "}"}], "]"}], "=", 
       RowBox[{
        RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fg", "[", 
        RowBox[{"{", 
         RowBox[{"6", ",", "7", ",", "8"}], "}"}], "]"}], "=", 
       RowBox[{
        RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"list_List", "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "list", "]"}], "==", "3"}], "&&", 
          RowBox[{"IntegerQ", "[", 
           RowBox[{"list", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
          RowBox[{"IntegerQ", "[", 
           RowBox[{"list", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "&&", 
          RowBox[{"IntegerQ", "[", 
           RowBox[{"list", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Signature", "[", "list", "]"}], "*", 
        RowBox[{"fg", "[", 
         RowBox[{"Sort", "[", "list", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"a_Integer", ",", "i_Integer", ",", "j_Integer"}], "]"}], ":=",
        "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"0", ",", "_", ",", "_"}], "]"}], ":=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<ERROR: U3 is not supported as of now (but could be if \
necessary)!\>\"", "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"T", "[", 
          RowBox[{"0", ",", "1", ",", "1"}], "]"}], "=", 
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"0", ",", "2", ",", "2"}], "]"}], "=", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"0", ",", "3", ",", "3"}], "]"}], "=", 
           RowBox[{"1", "/", 
            RowBox[{"Sqrt", "[", "6", "]"}]}]}]}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"1", ",", "1", ",", "2"}], "]"}], "=", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"1", ",", "2", ",", "1"}], "]"}], "=", 
        RowBox[{"1", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"2", ",", "1", ",", "2"}], "]"}], "=", 
       RowBox[{
        RowBox[{"-", "I"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"2", ",", "2", ",", "1"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"T", "[", 
         RowBox[{"2", ",", "1", ",", "2"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"3", ",", "1", ",", "1"}], "]"}], "=", 
       RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"3", ",", "2", ",", "2"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"T", "[", 
         RowBox[{"3", ",", "1", ",", "1"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"4", ",", "1", ",", "3"}], "]"}], "=", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"4", ",", "3", ",", "1"}], "]"}], "=", 
        RowBox[{"1", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"5", ",", "1", ",", "3"}], "]"}], "=", 
       RowBox[{
        RowBox[{"-", "I"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"5", ",", "3", ",", "1"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"T", "[", 
         RowBox[{"5", ",", "1", ",", "3"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"6", ",", "2", ",", "3"}], "]"}], "=", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"6", ",", "3", ",", "2"}], "]"}], "=", 
        RowBox[{"1", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"7", ",", "2", ",", "3"}], "]"}], "=", 
       RowBox[{
        RowBox[{"-", "I"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"7", ",", "3", ",", "2"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"T", "[", 
         RowBox[{"7", ",", "2", ",", "3"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"8", ",", "1", ",", "1"}], "]"}], "=", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"8", ",", "2", ",", "2"}], "]"}], "=", 
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "[", "12", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"8", ",", "3", ",", "3"}], "]"}], "=", 
       RowBox[{
        RowBox[{"-", "1"}], "/", 
        RowBox[{"Sqrt", "[", "3", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"InsertTensors", ":=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"FormTracer`Private`FTxT", "[", 
           RowBox[{
           "$SU3GellMannGroupName", ",", "a_Integer", ",", "i_Integer", ",", 
            "j_Integer"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"T", "[", 
           RowBox[{"a", ",", "i", ",", "j"}], "]"}]}], ",", 
         "\[IndentingNewLine]", " ", 
         RowBox[{
          RowBox[{"FormTracer`Private`FTxF", "[", 
           RowBox[{
           "$SU3GellMannGroupName", ",", "a_Integer", ",", "b_Integer", ",", 
            "c_Integer"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c"}], "}"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"conv", "@", 
           RowBox[{"TBT", "[", 
            RowBox[{
            "$SU3GellMannGroupName", ",", "a_Integer", ",", "i_Integer", ",", 
             "j_Integer"}], "]"}]}], "\[RuleDelayed]", 
          RowBox[{"T", "[", 
           RowBox[{"a", ",", "i", ",", "j"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"conv", "@", 
           RowBox[{"TBF", "[", 
            RowBox[{
            "$SU3GellMannGroupName", ",", "a_Integer", ",", "b_Integer", ",", 
             "c_Integer"}], "]"}]}], "\[RuleDelayed]", 
          RowBox[{"f", "[", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c"}], "}"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"conv", "@", 
           RowBox[{"deltaFund", "[", 
            RowBox[{
            "$SU3GellMannGroupName", ",", "a_Integer", ",", "a_Integer"}], 
            "]"}]}], "\[RuleDelayed]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"conv", "@", 
           RowBox[{"deltaAdj", "[", 
            RowBox[{
            "$SU3GellMannGroupName", ",", "a_Integer", ",", "a_Integer"}], 
            "]"}]}], "\[RuleDelayed]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"deltaFund", "[", 
             RowBox[{
             "$SU3GellMannGroupName", ",", "a_Integer", ",", "b_Integer"}], 
             "]"}]}], "/;", 
           RowBox[{"a", "!=", "b"}]}], "\[RuleDelayed]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"deltaAdj", "[", 
             RowBox[{
             "$SU3GellMannGroupName", ",", "a_Integer", ",", "b_Integer"}], 
             "]"}]}], "/;", 
           RowBox[{"a", "!=", "b"}]}], "\[RuleDelayed]", "0"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"expr", "//.", "InsertTensors"}], "//", "integrateDeltas"}], 
        "//", "QuickSimplify"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.93079686348295*^9, 3.930796874505297*^9}, {
   3.9308110533689747`*^9, 3.930811055649776*^9}, 3.930812739627295*^9, {
   3.930812977304865*^9, 3.930812994420135*^9}, {3.930813471988103*^9, 
   3.930813476744186*^9}, {3.93081356076534*^9, 3.930813566646738*^9}, {
   3.930813706884029*^9, 3.930813709921287*^9}, {3.930813746693352*^9, 
   3.930813746929301*^9}, 3.930813796198207*^9, {3.9308138794309263`*^9, 
   3.930813933850834*^9}, {3.930814644420912*^9, 3.9308146782730722`*^9}, {
   3.930815193854851*^9, 3.930815238310276*^9}, {3.930846648115995*^9, 
   3.930846676353636*^9}, {3.930846865702057*^9, 3.930846946394299*^9}, {
   3.930847006410428*^9, 3.930847027340771*^9}, {3.930847110819451*^9, 
   3.9308471628198338`*^9}, {3.930847531546378*^9, 3.930847533103378*^9}, {
   3.930848076353752*^9, 3.930848081073291*^9}, 3.930848123560607*^9, {
   3.935551805946697*^9, 3.935551896754431*^9}, {3.935551997378251*^9, 
   3.9355520309142017`*^9}, {3.9355521010111837`*^9, 3.935552228682417*^9}, 
   3.9355534376744413`*^9},
 CellLabel->
  "In[756]:=",ExpressionUUID->"045aca76-872a-4efe-bc44-22388023a3fe"]
}, Closed]],

Cell[CellGroupData[{

Cell["PreTrace helper", "Subsection",
 CellChangeTimes->{{3.940261642646137*^9, 3.9402616685052233`*^9}, {
  3.943460253240127*^9, 
  3.9434602560241737`*^9}},ExpressionUUID->"bf42ef60-7287-492a-9bb1-\
52ea464446f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PreTrace", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "exprExp", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "Print", "}"}], ",", 
        RowBox[{"DisentangleLorentzStructures", "[", "False", "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"exprExp", "=", 
       RowBox[{"ExpandTerms", "[", 
        RowBox[{
         RowBox[{"expr", "//", "integrateDeltas"}], "//", 
         "InsertSU3GellManns"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"exprExp", "[", 
          RowBox[{"[", 
           RowBox[{"iDia", ",", "2", ",", "iFlavor", ",", "1"}], "]"}], "]"}],
          "=", 
         RowBox[{"SU3GellMannTrace", "[", 
          RowBox[{"ConvertInput", "[", 
           RowBox[{"exprExp", "[", 
            RowBox[{"[", 
             RowBox[{"iDia", ",", "2", ",", "iFlavor", ",", "1"}], "]"}], 
            "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"iDia", ",", 
          RowBox[{"Length", "[", "exprExp", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"iFlavor", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"exprExp", "[", 
            RowBox[{"[", 
             RowBox[{"iDia", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ImplodeTerms", "[", "exprExp", "]"}], "//", 
         "integrateDeltas"}], "//", "QuickSimplify"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.930795724527169*^9, {3.9307981439806833`*^9, 3.930798145923999*^9}, {
   3.930800956767713*^9, 3.930800966481353*^9}, {3.930840693208907*^9, 
   3.930840713432819*^9}, {3.930846695486819*^9, 3.930846711440788*^9}, 
   3.93084722277701*^9, {3.930847427654304*^9, 3.930847435355493*^9}, {
   3.930847493933448*^9, 3.930847524768281*^9}, {3.930847914849099*^9, 
   3.930847915253834*^9}, 3.93084809443848*^9, {3.935551951335071*^9, 
   3.935551954606971*^9}, 3.935552388720077*^9, 3.935553438764934*^9},
 CellLabel->
  "In[759]:=",ExpressionUUID->"5393f01d-ccc6-406d-bb8a-c45c60efc560"]
}, Closed]],

Cell[CellGroupData[{

Cell["FormTracer PostReplacement Code", "Subsection",
 CellChangeTimes->{{3.940261642646137*^9, 
  3.9402616685052233`*^9}},ExpressionUUID->"4d56e7e7-161b-4b74-b488-\
65a36ac185e9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "finiteTFormExpansion", "=", 
   "\"\<\nid \
FTxsp(mom1?,mom2?)=(FTxsps(mom1,mom2)+FTxvec(mom1,0)*FTxvec(mom2,0));\n\
argument;\nid \
FTxsp(mom1?,mom2?)=(FTxsps(mom1,mom2)+FTxvec(mom1,0)*FTxvec(mom2,0));\n\
argument;\nid \
FTxsp(mom1?,mom2?)=(FTxsps(mom1,mom2)+FTxvec(mom1,0)*FTxvec(mom2,0));\n\
argument;\nid \
FTxsp(mom1?,mom2?)=(FTxsps(mom1,mom2)+FTxvec(mom1,0)*FTxvec(mom2,0));\n\
endargument;\nendargument;\nendargument;\n.sort\n\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"finiteTFormExpansionDis", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"LorentzFormRule", ",", "finiteTFormExpansion"}], "}"}], ",", 
     "finiteTFormExpansion"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.940250324850752*^9, 3.940250389223341*^9}, {
   3.940254044080488*^9, 3.940254044795555*^9}, {3.940256024749563*^9, 
   3.940256024870142*^9}, {3.9402560618595467`*^9, 3.9402560913613462`*^9}, 
   3.940256174919218*^9, {3.9402567289325447`*^9, 3.940256729144149*^9}, {
   3.940261575298711*^9, 3.940261580013793*^9}, 3.940311355078044*^9, 
   3.940402783399675*^9},ExpressionUUID->"ae36dd1e-7116-4a35-993f-\
4c93111e1145"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RemoveFromExtraVars", "[", "obj_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"extraVars", ",", "postExtraVars"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"extraVars", "=", 
       RowBox[{"GetExtraVars", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"postExtraVars", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"extraVars", ",", "obj"}], "]"}], ",", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"extraVars", ",", "obj"}], "]"}], ",", "extraVars"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"extraVars", "=!=", "postExtraVars"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DefineExtraVars", "[", "postExtraVars", "]"}], ";", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Error: Momentum \\\"\>\"", "<>", 
           RowBox[{"ToString", "[", "obj", "]"}], "<>", 
           "\"\<\\\" had been defined as an extra variable in \
FormTracer!\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.940306382690297*^9, 3.940306412413536*^9}, {
  3.940306446622031*^9, 3.9403066353280783`*^9}, {3.940331030045252*^9, 
  3.940331040513665*^9}, {3.9403311093512173`*^9, 
  3.940331165399531*^9}},ExpressionUUID->"9bed5dbf-0e2f-4a48-80bd-\
60a3554a4cea"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FormMomentumExpansion", "[", "momenta__", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Defs", ",", "code"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RemoveFromExtraVars", "/@", 
       RowBox[{"{", "momenta", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Defs", "=", 
       RowBox[{"\"\<Vector \>\"", "<>", 
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<,\>\""}], 
              "&"}], ",", 
             RowBox[{"{", "momenta", "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "]"}], "<>", "\"\<;\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"code", "=", 
       RowBox[{
       "\"\<*** definitions ***\n\>\"", "<>", "Defs", "<>", 
        "\"\<\n*** rewrite/expand scalar products\nid \
FTxsp(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nargument;\nid \
FTxsp(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nargument;\nid \
FTxsp(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nargument;\nid \
FTxsp(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nendargument;\nendargument;\n\
endargument;\n.sort\n\nid FTxsp(mom1?,mom2?)=mom1.mom2;\nargument;\nid \
FTxsp(mom1?,mom2?)=mom1.mom2;\nargument;\nid FTxsp(mom1?,mom2?)=mom1.mom2;\n\
argument;\nid FTxsp(mom1?,mom2?)=mom1.mom2;\nendargument;\nendargument;\n\
endargument;\n.sort\n\n*** rewrite as FormTracer scalar products again ***\n\
id mom1?.mom2?=FTxsp(mom1,mom2);\nargument;\nid mom1?.mom2?=FTxsp(mom1,mom2);\
\nargument;\nid mom1?.mom2?=FTxsp(mom1,mom2);\nargument;\nid \
mom1?.mom2?=FTxsp(mom1,mom2);\nendargument;\nendargument;\nendargument;\n\
.sort\n\>\""}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"LorentzFormRule", ",", "code"}], "}"}], ",", "code"}], 
        "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.940306150086565*^9, 3.9403063335011*^9}, {
   3.9403066404200077`*^9, 3.940306665128295*^9}, {3.940306742004964*^9, 
   3.940306754000854*^9}, {3.940306807701775*^9, 3.940306813229505*^9}, {
   3.940309843462891*^9, 3.940309864598197*^9}, {3.940311175862117*^9, 
   3.940311182961735*^9}, {3.9403112473383303`*^9, 3.9403112749501266`*^9}, 
   3.94031134564694*^9, {3.9404027892479687`*^9, 
   3.940402806988015*^9}},ExpressionUUID->"57c94276-aa3b-4013-a683-\
5cf5858a14ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FiniteTFormMomentumExpansion", "[", "momenta__", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Defs", ",", "code"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RemoveFromExtraVars", "/@", 
       RowBox[{"{", "momenta", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Defs", "=", 
       RowBox[{"\"\<Vector \>\"", "<>", 
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<,\>\""}], 
              "&"}], ",", 
             RowBox[{"{", "momenta", "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "]"}], "<>", "\"\<;\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"code", "=", 
       RowBox[{
       "finiteTFormExpansion", "<>", "\"\<*** definitions ***\n\>\"", "<>", 
        "Defs", "<>", 
        "\"\<\n*** rewrite/expand scalar products\nid \
FTxsps(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nargument;\nid \
FTxsps(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nargument;\nid \
FTxsps(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nargument;\nid \
FTxsps(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nendargument;\nendargument;\n\
endargument;\n.sort\n\nid FTxsps(mom1?,mom2?)=mom1.mom2;\nid \
FTxvec(mom1?,0)=mom1(0);\nargument;\nid FTxsps(mom1?,mom2?)=mom1.mom2;\nid \
FTxvec(mom1?,0)=mom1(0);\nargument;\nid FTxsps(mom1?,mom2?)=mom1.mom2;\nid \
FTxvec(mom1?,0)=mom1(0);\nargument;\nid FTxsps(mom1?,mom2?)=mom1.mom2;\nid \
FTxvec(mom1?,0)=mom1(0);\nendargument;\nendargument;\nendargument;\n.sort\n\n\
*** rewrite as FormTracer scalar products again ***\nid \
mom1?.mom2?=FTxsps(mom1,mom2);\nid mom1?(0)=FTxvec(mom1,0);\nargument;\nid \
mom1?.mom2?=FTxsps(mom1,mom2);\nid mom1?(0)=FTxvec(mom1,0);\nargument;\nid \
mom1?.mom2?=FTxsps(mom1,mom2);\nid mom1?(0)=FTxvec(mom1,0);\nargument;\nid \
mom1?.mom2?=FTxsps(mom1,mom2);\nid mom1?(0)=FTxvec(mom1,0);\nendargument;\n\
endargument;\nendargument;\n.sort\n\>\""}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"LorentzFormRule", ",", "code"}], "}"}], ",", "code"}], 
        "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.940306853265605*^9, 3.9403068713578157`*^9}, {
   3.9403069598109703`*^9, 3.940306985711577*^9}, {3.940309889366993*^9, 
   3.940309891366482*^9}, {3.940310103544381*^9, 3.940310110880076*^9}, {
   3.94031019629634*^9, 3.940310207859577*^9}, {3.94031031742806*^9, 
   3.940310425443754*^9}, {3.940310593872539*^9, 3.940310640247878*^9}, {
   3.940310798404441*^9, 3.9403108236047297`*^9}, 3.940310900969355*^9, {
   3.9403113040905323`*^9, 3.9403113244069147`*^9}, {3.94040281273267*^9, 
   3.9404028240123787`*^9}},ExpressionUUID->"e8fec9f6-b3ba-43dd-912c-\
5612d7185333"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeP0FormRule", "[", 
    RowBox[{"q_", ",", 
     RowBox[{"{", "momenta__", "}"}], ",", 
     RowBox[{"{", "projections__", "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "momentaList", ",", "projectionsList", ",", "qf", ",", "nPt", ",", 
       "Defs", ",", "repRules", ",", "freqRules", ",", "\[IndentingNewLine]", 
       "externalFreqRule"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RemoveFromExtraVars", "/@", 
       RowBox[{"{", "momenta", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"momentaList", "=", 
       RowBox[{"{", "momenta", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"projectionsList", "=", 
       RowBox[{"{", "projections", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qf", "=", 
       RowBox[{
        RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<f\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "momentaList", "]"}], "!=", 
         RowBox[{"Length", "[", "projectionsList", "]"}]}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Momentum and projection list have differing length!\>\"", 
          "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"nPt", "=", 
       RowBox[{"Length", "[", "momentaList", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Defs", "=", 
       RowBox[{"\"\<Vector \>\"", "<>", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\"\<exMom\>\"", "<>", 
             RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<,\>\""}], "&"}], 
           ",", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "nPt"}], "]"}]}], "]"}], "]"}], "<>", 
        "\"\<intMom,intMomf;\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"repRules", "=", 
       RowBox[{"Thread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<exMom\>\"", "<>", 
               RowBox[{"ToString", "[", "#", "]"}]}], "&"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "nPt"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<intMomf\>\"", ",", "\"\<intMom\>\"", ",", "\"\<FTxI\>\""}], 
            "}"}]}], "]"}], "->", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"ToString", ",", "momentaList"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"qf", ",", 
             RowBox[{"ToString", "[", "q", "]"}], ",", "\"\<i_\>\""}], 
            "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"freqRules", "=", 
       RowBox[{"StringTake", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\"\<id exMom\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<(0)=\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"CForm", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"projectionsList", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "/.", 
                  RowBox[{
                   RowBox[{"Complex", "[", 
                    RowBox[{"re_", ",", "im_"}], "]"}], ":>", 
                   RowBox[{"re", "+", 
                    RowBox[{"FTxI", " ", "im"}]}]}]}], "/.", 
                 RowBox[{"Thread", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"GetExtraVarsSynonyms", "[", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"GetExtraVarsSynonyms", "[", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}]}], "]"}],
                "]"}], "<>", "\"\<;\\n\>\""}], "&"}], ",", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "nPt"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"externalFreqRule", "=", 
       RowBox[{
       "finiteTFormExpansion", "<>", "Defs", "<>", 
        "\"\<\n\nid FTxvec(mom1?,0)=mom1(0);\n\>\"", "<>", "freqRules", "<>", 
        "\"\<\nid intMom(0)=FTxvec(intMom,0);\nid \
intMomf(0)=FTxvec(intMomf,0);\nargument;\nid FTxvec(mom1?,0)=mom1(0);\n\>\"", 
        "<>", "freqRules", "<>", 
        "\"\<\nid intMom(0)=FTxvec(intMom,0);\nid \
intMomf(0)=FTxvec(intMomf,0);\nargument;\nid FTxvec(mom1?,0)=mom1(0);\n\>\"", 
        "<>", "freqRules", "<>", 
        "\"\<\nid intMom(0)=FTxvec(intMom,0);\nid \
intMomf(0)=FTxvec(intMomf,0);\nargument;\nid FTxvec(mom1?,0)=mom1(0);\n\>\"", 
        "<>", "freqRules", "<>", 
        "\"\<\nid intMom(0)=FTxvec(intMom,0);\nid \
intMomf(0)=FTxvec(intMomf,0);\nendargument;\nendargument;\nendargument;\n\
.sort\n\>\""}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"externalFreqRule", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"externalFreqRule", ",", "repRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"LorentzFormRule", ",", "externalFreqRule"}], "}"}], ",", 
         "externalFreqRule"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.940259443063883*^9, 3.940259686725203*^9}, {
  3.940259716801485*^9, 3.94026013537002*^9}, {3.9402601896641893`*^9, 
  3.940260219979501*^9}, {3.940261024301371*^9, 3.9402610382929163`*^9}, {
  3.940261180767482*^9, 3.94026120956774*^9}, {3.940261385247137*^9, 
  3.940261403923253*^9}, {3.940262214280147*^9, 3.940262240620164*^9}, {
  3.940269357533251*^9, 3.9402693634528303`*^9}, {3.940269488813205*^9, 
  3.940269495736648*^9}, {3.940270121266869*^9, 3.94027013138136*^9}, {
  3.940306657585084*^9, 3.9403066715009604`*^9}, {3.940307597207541*^9, 
  3.94030765806384*^9}, {3.9403076925843697`*^9, 3.940307731264367*^9}, {
  3.940307805220706*^9, 3.940307834768777*^9}, {3.940402830215782*^9, 
  3.9404028419046783`*^9}},ExpressionUUID->"54fc9c34-384c-43b0-9dca-\
9c647b4f70da"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeFTCos", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "=", 
       RowBox[{"\"\<cos\>\"", "<>", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"ToString", ",", 
           RowBox[{"Sort", "[", 
            RowBox[{"{", 
             RowBox[{"a", ",", "b"}], "}"}], "]"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"res", ",", 
           RowBox[{"-", "1"}]}], "]"}], "==", "\"\<f\>\""}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"Symbol", "[", 
          RowBox[{"StringTake", "[", 
           RowBox[{"res", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "2"}]}], "}"}]}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"Symbol", "[", "res", "]"}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.940260548461611*^9, 3.940260548653639*^9}},
 CellLabel->
  "In[316]:=",ExpressionUUID->"a68b4dbc-00e0-430f-80c4-8612ecea1dbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetFTSynonym", "[", "symbol_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"symbol", "===", "\[ImaginaryI]"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"FTxI", "//", "ToString"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "symbol", "]"}], "=!=", "Symbol"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<The value \\\"\>\"", "<>", 
          RowBox[{"ToString", "[", "symbol", "]"}], "<>", 
          "\"\<\\\" is not a symbol!\>\""}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"GetExtraVarsSynonyms", "[", "]"}], ",", "symbol", ",", 
          "Infinity"}], "]"}]}], ",", 
       RowBox[{"AddExtraVars", "[", "symbol", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ToString", "@", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"GetExtraVarsSynonyms", "[", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", "symbol"}], "&"}]}], "]"}], 
       "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.940231307341693*^9, 3.940231395962592*^9}, {
  3.94023421814056*^9, 3.940234251522575*^9}, {3.940238659899184*^9, 
  3.94023866058289*^9}, {3.9402458459846582`*^9, 3.940245928580668*^9}, {
  3.940246096408587*^9, 3.9402461459486923`*^9}, {3.940246184213076*^9, 
  3.940246247313895*^9}, {3.9402478038151627`*^9, 3.940247804367098*^9}},
 CellLabel->
  "In[315]:=",ExpressionUUID->"d697c06a-8bae-40cd-9a25-ffa4b79d6879"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeSPFormRule", "[", 
    RowBox[{"q_", ",", "p_", ",", "momenta__"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "momentaList", ",", "qf", ",", "Defs", ",", "nPt", ",", "nPtId", ",", 
       "nPtCrossId", ",", "nPtqId", ",", "symmetricPointFiniteTFormRule4pt", 
       ",", "repRules"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RemoveFromExtraVars", "/@", 
       RowBox[{"{", "momenta", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"momentaList", "=", 
       RowBox[{"{", "momenta", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qf", "=", 
       RowBox[{
        RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<f\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nPt", "=", 
       RowBox[{"Length", "[", "momentaList", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Defs", "=", 
       RowBox[{"\"\<Vector \>\"", "<>", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\"\<exMom\>\"", "<>", 
             RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<,\>\""}], "&"}], 
           ",", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "nPt"}], "]"}]}], "]"}], "]"}], "<>", 
        "\"\<avMom,intMom,intMomf;\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nPtId", "=", 
       RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
        RowBox[{"Map", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<id exMom\>\"", "<>", 
            RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.exMom\>\"", "<>", 
            RowBox[{"ToString", "[", "#", "]"}], "<>", 
            "\"\<=avMom.avMom;\\n\>\""}], "&"}], "\[IndentingNewLine]", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "nPt"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nPtCrossId", "=", 
       RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
        RowBox[{"Map", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<id exMom\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<.exMom\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", 
            "\"\<=-avMom.avMom/\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"nPt", "-", "1"}], "]"}], "<>", "\"\<;\\n\>\""}], "&"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"Subsets", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "nPt"}], "]"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nPtqId", "=", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Map", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\"\<id exMom\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", 
              "\"\<.intMom=sqrt(avMom.avMom)*sqrt(intMom.intMom)*Cosq\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<;\\n\>\""}], 
             "&"}], "\[IndentingNewLine]", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "nPt"}], "]"}]}], "\[IndentingNewLine]", "]"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"Map", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\"\<id exMom\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", 
              "\"\<.intMomf=sqrt(avMom.avMom)*sqrt(intMom.intMom)*Cosq\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<;\\n\>\""}], 
             "&"}], "\[IndentingNewLine]", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "nPt"}], "]"}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"symmetricPointFiniteTFormRule4pt", "=", 
       RowBox[{
       "\"\<\n*** definitions ***\n\>\"", "<>", "Defs", "<>", 
        "\"\<\n*** rewrite/expand scalar products\nid \
FTxsp(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nargument;\nid \
FTxsp(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nargument;\nid \
FTxsp(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nargument;\nid \
FTxsp(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nendargument;\nendargument;\n\
endargument;\n.sort\n\nid FTxsp(mom1?,mom2?)=mom1.mom2;\nargument;\nid \
FTxsp(mom1?,mom2?)=mom1.mom2;\nargument;\nid FTxsp(mom1?,mom2?)=mom1.mom2;\n\
argument;\nid FTxsp(mom1?,mom2?)=mom1.mom2;\nendargument;\nendargument;\n\
endargument;\n.sort\n\n*** simplification ***\n\>\"", "<>", "nPtId", "<>", 
        "nPtCrossId", "<>", "nPtqId", "<>", "\"\<\nargument;\n\>\"", "<>", 
        "nPtId", "<>", "nPtCrossId", "<>", "nPtqId", "<>", 
        "\"\<\nargument;\n\>\"", "<>", "nPtId", "<>", "nPtCrossId", "<>", 
        "nPtqId", "<>", "\"\<\nargument;\n\>\"", "<>", "nPtId", "<>", 
        "nPtCrossId", "<>", "nPtqId", "<>", 
        "\"\<\nendargument;\nendargument;\nendargument;\n.sort\n\n*** rewrite \
as FormTracer scalar products again ***\nid mom1?.mom2?=FTxsp(mom1,mom2);\n\
argument;\nid mom1?.mom2?=FTxsp(mom1,mom2);\nargument;\nid \
mom1?.mom2?=FTxsp(mom1,mom2);\nargument;\nid mom1?.mom2?=FTxsp(mom1,mom2);\n\
endargument;\nendargument;\nendargument;\n.sort\n\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"repRules", "=", 
       RowBox[{"Thread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<exMom\>\"", "<>", 
               RowBox[{"ToString", "[", "#", "]"}]}], "&"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "nPt"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<Cosq\>\"", "<>", 
               RowBox[{"ToString", "[", "#", "]"}]}], "&"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "nPt"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<intMomf\>\"", ",", "\"\<intMom\>\"", ",", "\"\<avMom\>\""}], 
            "}"}]}], "\[IndentingNewLine]", "]"}], "->", 
         "\[IndentingNewLine]", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"ToString", ",", "momentaList"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"GetFTSynonym", "[", 
               RowBox[{"MakeFTCos", "[", 
                RowBox[{
                 RowBox[{"momentaList", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], ",", "q"}], "]"}], "]"}], 
              "&"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "nPt"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"qf", ",", 
             RowBox[{"ToString", "[", "q", "]"}], ",", 
             RowBox[{"ToString", "[", "p", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"symmetricPointFiniteTFormRule4pt", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"symmetricPointFiniteTFormRule4pt", ",", "repRules"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "LorentzFormRule", ",", "symmetricPointFiniteTFormRule4pt"}], "}"}],
          ",", "symmetricPointFiniteTFormRule4pt"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.94025922069668*^9, 3.940259241423806*^9}, 
   3.940259538540867*^9, {3.94026014847406*^9, 3.940260183074399*^9}, {
   3.940260234102923*^9, 3.94026025312399*^9}, {3.940260288427993*^9, 
   3.940260302184114*^9}, {3.9402604157454233`*^9, 3.94026048463772*^9}, {
   3.94026052148274*^9, 3.9402605230010138`*^9}, {3.940260561503128*^9, 
   3.940260623010228*^9}, {3.9402606558799963`*^9, 3.940260682016859*^9}, {
   3.940260790919655*^9, 3.9402608076466312`*^9}, {3.940262256256085*^9, 
   3.9402622599434566`*^9}, {3.940306681869225*^9, 3.940306682152795*^9}, 
   3.940309918175585*^9, {3.940311386675083*^9, 3.9403114216356993`*^9}, {
   3.940388240681851*^9, 3.940388255081813*^9}, {3.9404028500767527`*^9, 
   3.94040286050882*^9}},ExpressionUUID->"0adf48c2-98f0-45f1-bc63-\
339fa08dafa4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeSPFormRule", "[", 
    RowBox[{"q_", ",", "p_", ",", "momenta__"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "momentaList", ",", "qf", ",", "Defs", ",", "nPt", ",", "nPtId", ",", 
       "nPtCrossId", ",", "nPtqId", ",", "symmetricPointFormRule4pt", ",", 
       "repRules"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RemoveFromExtraVars", "/@", 
       RowBox[{"{", "momenta", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"momentaList", "=", 
       RowBox[{"{", "momenta", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qf", "=", 
       RowBox[{
        RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<f\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nPt", "=", 
       RowBox[{"Length", "[", "momentaList", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Defs", "=", 
       RowBox[{"\"\<Vector \>\"", "<>", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\"\<exMom\>\"", "<>", 
             RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<,\>\""}], "&"}], 
           ",", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "nPt"}], "]"}]}], "]"}], "]"}], "<>", 
        "\"\<avMom,intMom,intMomf;\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nPtId", "=", 
       RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
        RowBox[{"Map", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<id exMom\>\"", "<>", 
            RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.exMom\>\"", "<>", 
            RowBox[{"ToString", "[", "#", "]"}], "<>", 
            "\"\<=avMom.avMom;\\n\>\""}], "&"}], "\[IndentingNewLine]", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "nPt"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nPtCrossId", "=", 
       RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
        RowBox[{"Map", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<id exMom\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<.exMom\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", 
            "\"\<=-avMom.avMom/\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"nPt", "-", "1"}], "]"}], "<>", "\"\<;\\n\>\""}], "&"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"Subsets", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "nPt"}], "]"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nPtqId", "=", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Map", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\"\<id exMom\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", 
              "\"\<.intMom=sqrt(avMom.avMom)*sqrt(intMom.intMom)*Cosq\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<;\\n\>\""}], 
             "&"}], "\[IndentingNewLine]", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "nPt"}], "]"}]}], "\[IndentingNewLine]", "]"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"Map", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\"\<id exMom\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", 
              "\"\<.intMomf=sqrt(avMom.avMom)*sqrt(intMom.intMom)*Cosq\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<;\\n\>\""}], 
             "&"}], "\[IndentingNewLine]", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "nPt"}], "]"}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"symmetricPointFormRule4pt", "=", 
       RowBox[{
       "\"\<\n*** definitions ***\n\>\"", "<>", "Defs", "<>", 
        "\"\<\n*** rewrite/expand scalar products\nid \
FTxsp(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nargument;\nid \
FTxsp(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nargument;\nid \
FTxsp(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nargument;\nid \
FTxsp(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nendargument;\nendargument;\n\
endargument;\n.sort\n\nid FTxsp(mom1?,mom2?)=mom1.mom2;\nargument;\nid \
FTxsp(mom1?,mom2?)=mom1.mom2;\nargument;\nid FTxsp(mom1?,mom2?)=mom1.mom2;\n\
argument;\nid FTxsp(mom1?,mom2?)=mom1.mom2;\nendargument;\nendargument;\n\
endargument;\n.sort\n\n*** simplification ***\n\>\"", "<>", "nPtId", "<>", 
        "nPtCrossId", "<>", "nPtqId", "<>", "\"\<\nargument;\n\>\"", "<>", 
        "nPtId", "<>", "nPtCrossId", "<>", "nPtqId", "<>", 
        "\"\<\nargument;\n\>\"", "<>", "nPtId", "<>", "nPtCrossId", "<>", 
        "nPtqId", "<>", "\"\<\nargument;\n\>\"", "<>", "nPtId", "<>", 
        "nPtCrossId", "<>", "nPtqId", "<>", 
        "\"\<\nendargument;\nendargument;\nendargument;\n.sort\n\n*** rewrite \
as FormTracer scalar products again ***\nid mom1?.mom2?=FTxsp(mom1,mom2);\n\
argument;\nid mom1?.mom2?=FTxsp(mom1,mom2);\nargument;\nid \
mom1?.mom2?=FTxsp(mom1,mom2);\nargument;\nid mom1?.mom2?=FTxsp(mom1,mom2);\n\
endargument;\nendargument;\nendargument;\n.sort\n\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"repRules", "=", 
       RowBox[{"Thread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<exMom\>\"", "<>", 
               RowBox[{"ToString", "[", "#", "]"}]}], "&"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "nPt"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<Cosq\>\"", "<>", 
               RowBox[{"ToString", "[", "#", "]"}]}], "&"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "nPt"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<intMomf\>\"", ",", "\"\<intMom\>\"", ",", "\"\<avMom\>\""}], 
            "}"}]}], "\[IndentingNewLine]", "]"}], "->", 
         "\[IndentingNewLine]", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"ToString", ",", "momentaList"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"GetFTSynonym", "[", 
               RowBox[{"MakeFTCos", "[", 
                RowBox[{
                 RowBox[{"momentaList", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], ",", "q"}], "]"}], "]"}], 
              "&"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "nPt"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"qf", ",", 
             RowBox[{"ToString", "[", "q", "]"}], ",", 
             RowBox[{"ToString", "[", "p", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"symmetricPointFormRule4pt", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"symmetricPointFormRule4pt", ",", "repRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"LorentzFormRule", ",", "symmetricPointFormRule4pt"}], 
          "}"}], ",", "symmetricPointFormRule4pt"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.941111911825918*^9, 
  3.941111970929914*^9}},ExpressionUUID->"8e653815-4541-440b-bd72-\
011c19ad9c13"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeSPFiniteTFormRule", "[", 
    RowBox[{"q_", ",", "p_", ",", "momenta__"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "momentaList", ",", "qf", ",", "Defs", ",", "nPt", ",", "nPtId", ",", 
       "nPtCrossId", ",", "nPtqId", ",", "symmetricPointFiniteTFormRule4pt", 
       ",", "repRules"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RemoveFromExtraVars", "/@", 
       RowBox[{"{", "momenta", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"momentaList", "=", 
       RowBox[{"{", "momenta", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qf", "=", 
       RowBox[{
        RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<f\>\""}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nPt", "=", 
       RowBox[{"Length", "[", "momentaList", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Defs", "=", 
       RowBox[{"\"\<Vector \>\"", "<>", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\"\<exMom\>\"", "<>", 
             RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<,\>\""}], "&"}], 
           ",", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "nPt"}], "]"}]}], "]"}], "]"}], "<>", 
        "\"\<avMom,intMom,intMomf;\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nPtId", "=", 
       RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
        RowBox[{"Map", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<id exMom\>\"", "<>", 
            RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.exMom\>\"", "<>", 
            RowBox[{"ToString", "[", "#", "]"}], "<>", 
            "\"\<=avMom.avMom;\\n\>\""}], "&"}], "\[IndentingNewLine]", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "nPt"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nPtCrossId", "=", 
       RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
        RowBox[{"Map", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<id exMom\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<.exMom\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", 
            "\"\<=-avMom.avMom/\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"nPt", "-", "1"}], "]"}], "<>", "\"\<;\\n\>\""}], "&"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"Subsets", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "nPt"}], "]"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nPtqId", "=", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Map", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\"\<id exMom\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", 
              "\"\<.intMom=sqrt(avMom.avMom)*sqrt(intMom.intMom)*Cosq\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<;\\n\>\""}], 
             "&"}], "\[IndentingNewLine]", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "nPt"}], "]"}]}], "\[IndentingNewLine]", "]"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"Map", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\"\<id exMom\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", 
              "\"\<.intMomf=sqrt(avMom.avMom)*sqrt(intMom.intMom)*Cosq\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<;\\n\>\""}], 
             "&"}], "\[IndentingNewLine]", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "nPt"}], "]"}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"symmetricPointFiniteTFormRule4pt", "=", 
       RowBox[{
       "finiteTFormExpansion", "<>", "\"\<\n\n*** definitions ***\n\>\"", "<>",
         "Defs", "<>", 
        "\"\<\n*** rewrite/expand scalar products\nid \
FTxsps(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nargument;\nid \
FTxsps(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nargument;\nid \
FTxsps(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nargument;\nid \
FTxsps(mom1?,mom2?)^-1=pow(mom1.mom2,-1);\nendargument;\nendargument;\n\
endargument;\n.sort\n\nid FTxsps(mom1?,mom2?)=mom1.mom2;\nargument;\nid \
FTxsps(mom1?,mom2?)=mom1.mom2;\nargument;\nid FTxsps(mom1?,mom2?)=mom1.mom2;\n\
argument;\nid FTxsps(mom1?,mom2?)=mom1.mom2;\nendargument;\nendargument;\n\
endargument;\n.sort\n\n*** simplification ***\n\>\"", "<>", "nPtId", "<>", 
        "nPtCrossId", "<>", "nPtqId", "<>", "\"\<\nargument;\n\>\"", "<>", 
        "nPtId", "<>", "nPtCrossId", "<>", "nPtqId", "<>", 
        "\"\<\nargument;\n\>\"", "<>", "nPtId", "<>", "nPtCrossId", "<>", 
        "nPtqId", "<>", "\"\<\nargument;\n\>\"", "<>", "nPtId", "<>", 
        "nPtCrossId", "<>", "nPtqId", "<>", 
        "\"\<\nendargument;\nendargument;\nendargument;\n.sort\n\n*** rewrite \
as FormTracer scalar products again ***\nid mom1?.mom2?=FTxsps(mom1,mom2);\n\
argument;\nid mom1?.mom2?=FTxsps(mom1,mom2);\nargument;\nid \
mom1?.mom2?=FTxsps(mom1,mom2);\nargument;\nid mom1?.mom2?=FTxsps(mom1,mom2);\n\
endargument;\nendargument;\nendargument;\n.sort\n\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"repRules", "=", 
       RowBox[{"Thread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<exMom\>\"", "<>", 
               RowBox[{"ToString", "[", "#", "]"}]}], "&"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "nPt"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<Cosq\>\"", "<>", 
               RowBox[{"ToString", "[", "#", "]"}]}], "&"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "nPt"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<intMomf\>\"", ",", "\"\<intMom\>\"", ",", "\"\<avMom\>\""}], 
            "}"}]}], "\[IndentingNewLine]", "]"}], "->", 
         "\[IndentingNewLine]", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"ToString", ",", "momentaList"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"GetFTSynonym", "[", 
               RowBox[{"MakeFTCos", "[", 
                RowBox[{
                 RowBox[{"momentaList", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], ",", "q"}], "]"}], "]"}], 
              "&"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "nPt"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"qf", ",", 
             RowBox[{"ToString", "[", "q", "]"}], ",", 
             RowBox[{"ToString", "[", "p", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"symmetricPointFiniteTFormRule4pt", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"symmetricPointFiniteTFormRule4pt", ",", "repRules"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "LorentzFormRule", ",", "symmetricPointFiniteTFormRule4pt"}], "}"}],
          ",", "symmetricPointFiniteTFormRule4pt"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.940256286647832*^9, 3.940256286648704*^9}, {
   3.940256743988523*^9, 3.940256861947338*^9}, 3.94025689716122*^9, {
   3.940256929925074*^9, 3.940257026109458*^9}, {3.940258089222287*^9, 
   3.940258275923791*^9}, {3.940258440719378*^9, 3.9402585094047422`*^9}, {
   3.940258539581511*^9, 3.9402585468416023`*^9}, {3.9402585911146917`*^9, 
   3.940259169129279*^9}, {3.9402592007851763`*^9, 3.94025920147283*^9}, {
   3.9402593544969883`*^9, 3.940259360164019*^9}, {3.940260721391748*^9, 
   3.940260745993063*^9}, {3.940260820619116*^9, 3.9402608297264833`*^9}, 
   3.940262265383086*^9, {3.940269796607534*^9, 3.940269799143097*^9}, {
   3.9403066867333937`*^9, 3.9403066868408403`*^9}, {3.940309925407662*^9, 
   3.940310039215837*^9}, {3.9403114267150583`*^9, 3.94031146447596*^9}, {
   3.9403882725866327`*^9, 3.940388284674335*^9}, {3.9404028662928553`*^9, 
   3.940402875645014*^9}},ExpressionUUID->"0f6c81a8-ac09-48ec-a471-\
88fe663c0f3d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Form Tracer alternative import", "Subsection",
 CellChangeTimes->{{3.940394871577717*^9, 
  3.94039488336053*^9}},ExpressionUUID->"c38e477d-dd37-4bc9-8fb7-\
bdda27f3872d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReplaceFormBraces", "[", "result_String", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newRes", ",", "regEx", ",", "bracePositions", ",", "repTruth", ",", 
       "repList", ",", "ob"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"regEx", "=", 
       RowBox[{
       "RegularExpression", "@", 
        "\"\<(?P<a>\\\\(([^\\\\(\\\\)]|(?P>a))*\\\\))\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bracePositions", "=", 
       RowBox[{"StringPosition", "[", 
        RowBox[{"result", ",", "regEx"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"repTruth", "=", 
       RowBox[{"Map", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ob", "=", 
              RowBox[{"StringTake", "[", 
               RowBox[{"result", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "}"}]}], 
               "]"}]}], ";", 
             RowBox[{
              RowBox[{"ob", "==", "\"\<*\>\""}], "||", 
              RowBox[{"ob", "==", "\"\</\>\""}]}]}], ",", 
            "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
            "True"}], "]"}], "&"}], ",", "bracePositions"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"repList", "=", 
       RowBox[{"Select", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"repTruth", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"bracePositions", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "bracePositions", "]"}]}], "}"}]}], "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "=!=", 
           RowBox[{"{", "}"}]}], "&"}]}], "\[IndentingNewLine]", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"newRes", "=", 
       RowBox[{"StringReplacePart", "[", 
        RowBox[{"result", ",", "\"\<[\>\"", ",", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"repList", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"repList", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"newRes", "=", 
       RowBox[{"StringReplacePart", "[", 
        RowBox[{"newRes", ",", "\"\<]\>\"", ",", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"repList", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"repList", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "newRes", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.940393360300741*^9, 3.940393418599626*^9}, {
  3.9403934487273827`*^9, 3.9403939100168858`*^9}, {3.940393949892054*^9, 
  3.940393950380721*^9}, {3.940393986949669*^9, 3.9403940399126377`*^9}, {
  3.940394112423336*^9, 3.940394160425941*^9}, {3.940394293035836*^9, 
  3.940394312204976*^9}},
 CellLabel->
  "In[605]:=",ExpressionUUID->"e6a75dcc-0035-46b2-8932-4a0990024083"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OptimizedFormTrace", "::", "usage"}], "=", 
   "\"\<OptimizedFormTrace[expr_,filename_String,preRepRules_:{},postRepRules_\
:{}]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OptimizedFormTrace", "[", 
    RowBox[{"expr_", ",", "filename_String", ",", 
     RowBox[{"preRepRules_", ":", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"postRepRules_", ":", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "synonyms", ",", "backReplacements", ",", "result", ",", "FTxVAR", ",", 
       "FTxTMP"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FormTrace", "[", 
       RowBox[{"expr", ",", "preRepRules", ",", "postRepRules", ",", 
        RowBox[{"{", 
         RowBox[{"filename", ",", "\"\<O4\>\"", ",", "\"\<nospaces\>\""}], 
         "}"}], ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"ToString", "@", "FTxVAR"}], ",", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"ToString", "@", "FTxTMP"}], ",", 
          RowBox[{"\"\<$\>\"", "->", "\"\<\>\""}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"synonyms", "=", 
       RowBox[{"GetExtraVarsSynonyms", "[", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"backReplacements", "=", 
       RowBox[{"Dispatch", "@", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"synonyms", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "->", 
            RowBox[{"synonyms", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FTxsps", "->", "sps"}], ",", 
            RowBox[{"FTxsp", "->", "sp"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"StringReplace", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ReplaceFormBraces", "@", 
          RowBox[{"Import", "[", 
           RowBox[{"filename", ",", "\"\<Text\>\""}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<pow\>\"", "->", "\"\<Power\>\""}], ",", 
           RowBox[{"\"\<sqrt\>\"", "->", "\"\<Sqrt\>\""}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"result", ",", 
         RowBox[{"\"\<\\n\>\"", "->", "\"\<\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"result", "//", "ToExpression"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"FTxVAR", "//.", "backReplacements"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.940390295245966*^9, 3.9403904229224453`*^9}, {
  3.9403906016866217`*^9, 3.940390734504616*^9}, {3.9403911369578037`*^9, 
  3.940391208657271*^9}, {3.940391239317225*^9, 3.9403913044859*^9}, {
  3.940391356809285*^9, 3.940391381079207*^9}, {3.940391428617811*^9, 
  3.9403914860843363`*^9}, {3.940391525456829*^9, 3.940391613641354*^9}, {
  3.940391645280851*^9, 3.940391685616645*^9}, {3.940391720553588*^9, 
  3.940391732452861*^9}, {3.940391971918522*^9, 3.9403920031998367`*^9}, {
  3.9403921636066847`*^9, 3.9403924821209707`*^9}, {3.940392638160808*^9, 
  3.9403926506225147`*^9}, {3.940394177666754*^9, 3.940394184218596*^9}, {
  3.9403942182229433`*^9, 3.940394219794662*^9}, {3.940394327796234*^9, 
  3.940394365115533*^9}, {3.940394512260954*^9, 3.9403945247610292`*^9}, {
  3.940394716854638*^9, 3.940394728822772*^9}},
 CellLabel->
  "In[644]:=",ExpressionUUID->"72c596f7-a080-4fde-86c1-d8a9fffc29be"]
}, Closed]],

Cell[CellGroupData[{

Cell["Easy Operators", "Subsection",
 CellChangeTimes->{{3.930795742637045*^9, 
  3.9307957705089006`*^9}},ExpressionUUID->"1e32e353-e76a-4e26-ae6c-\
7769579113e4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ExtendedFormTrace", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"disentangle", ":", 
     RowBox[{"_", "?", "BooleanQ"}], ":", "True"}], ",", 
    RowBox[{"preRepRules_List", ":", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"postRepRules_List", ":", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "preExpr", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"preExpr", "=", 
      RowBox[{
       RowBox[{"ResolveChargeConjugation", "[", 
        RowBox[{"integrateDeltas", "[", "expr", "]"}], "]"}], "//", 
       "integrateDeltas"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"$UseSU3GellMannTrace", ",", "\[IndentingNewLine]", 
       RowBox[{"preExpr", "=", 
        RowBox[{"PreTrace", "[", "preExpr", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "Print", "}"}], ",", 
       RowBox[{"DisentangleLorentzStructures", "[", "disentangle", "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"FormTrace", "[", 
      RowBox[{
       RowBox[{"preExpr", "//", "integrateDeltas"}], ",", "preRepRules", ",", 
       "postRepRules"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExtendedFormTrace", "[", 
   RowBox[{"expr_List", ",", 
    RowBox[{"disentangle", ":", 
     RowBox[{"_", "?", "BooleanQ"}], ":", "True"}], ",", 
    RowBox[{"preRepRules_List", ":", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"postRepRules_List", ":", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "preExpr", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Total", "[", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ExtendedFormTrace", "[", 
          RowBox[{
          "#", ",", "disentangle", ",", "preRepRules", ",", "postRepRules"}], 
          "]"}], "&"}], ",", "expr"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.921794788381821*^9, 3.921794803052486*^9}, {
   3.921794837494983*^9, 3.921794895036118*^9}, {3.9217966910081377`*^9, 
   3.921796749351973*^9}, {3.9218094038813133`*^9, 3.921809422046129*^9}, {
   3.921821070528665*^9, 3.9218210706947517`*^9}, {3.921833103253256*^9, 
   3.9218331040606728`*^9}, {3.921841383000539*^9, 3.921841386417122*^9}, {
   3.9218770067947197`*^9, 3.921877087892559*^9}, {3.921877129501644*^9, 
   3.921877140735587*^9}, {3.921877222401827*^9, 3.921877224275999*^9}, {
   3.921877286095982*^9, 3.921877319517308*^9}, {3.921877356597204*^9, 
   3.921877366890123*^9}, {3.921877532694219*^9, 3.921877561772856*^9}, {
   3.9218782761172543`*^9, 3.921878280014306*^9}, {3.921878311453514*^9, 
   3.921878378518128*^9}, {3.921878607925205*^9, 3.9218786406919813`*^9}, {
   3.921879796857099*^9, 3.921879823800154*^9}, {3.921879950967419*^9, 
   3.921879954111263*^9}, 3.921880145061811*^9, {3.924146114795412*^9, 
   3.924146119347769*^9}, {3.924146358175108*^9, 3.924146365198695*^9}, {
   3.930796064153479*^9, 3.930796068408101*^9}, {3.930796541372204*^9, 
   3.93079655546843*^9}, {3.930797211318458*^9, 3.93079721656548*^9}, {
   3.930797260174489*^9, 3.93079726505873*^9}, {3.930797313496756*^9, 
   3.930797314818914*^9}, {3.930801003745408*^9, 3.930801028564755*^9}, {
   3.9308303005901747`*^9, 3.930830316575995*^9}, 3.930847906421358*^9, {
   3.930848101361465*^9, 3.930848107061784*^9}, {3.93281804453062*^9, 
   3.93281804737658*^9}, {3.932818098757291*^9, 3.932818109697544*^9}, 
   3.933228313060055*^9, {3.9332283810208273`*^9, 3.933228395850295*^9}, {
   3.933228479075479*^9, 3.933228484054834*^9}, 3.9355458868797407`*^9, {
   3.9402618616938257`*^9, 3.940261892674519*^9}, 3.94335670497941*^9},
 CellLabel->
  "In[557]:=",ExpressionUUID->"f3cb2154-af8e-461b-aaff-4717fb59d45b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simplification algorithms", "Chapter",
 CellChangeTimes->{{3.930795806151032*^9, 
  3.930795812293353*^9}},ExpressionUUID->"a8ec222a-06c2-4128-8ebf-\
16259da48732"],

Cell[CellGroupData[{

Cell["Momentum  simplifications", "Subsection",
 CellChangeTimes->{{3.93079588507541*^9, 
  3.930795889987945*^9}},ExpressionUUID->"0326ce6d-42d3-484e-afb8-\
ce1d4f618c7b"],

Cell["Some helpers for dealing with the momentum notation.", "Text",ExpressionUUID->"9b5d02cd-e32a-4fa5-a4a5-a6651ddbd837"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SeparateScalarProductsFiniteT", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"UseLorentzLinearity", "[", "expr", "]"}], "//.", 
      RowBox[{"InsertOutputNaming", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"TBsp", "[", 
           RowBox[{"q_", ",", "p_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"TBsps", "[", 
            RowBox[{"q", ",", "p"}], "]"}], "+", 
           RowBox[{
            RowBox[{"TBvec", "[", 
             RowBox[{"q", ",", "0"}], "]"}], 
            RowBox[{"TBvec", "[", 
             RowBox[{"p", ",", "0"}], "]"}]}]}]}], ",", 
         RowBox[{
          RowBox[{"TBvec", "[", 
           RowBox[{"p_", ",", 
            RowBox[{"mu_", "/;", 
             RowBox[{"mu", "=!=", "0"}]}]}], "]"}], ":>", 
          RowBox[{
           RowBox[{"TBvecs", "[", 
            RowBox[{"p", ",", "mu"}], "]"}], "+", 
           RowBox[{
            RowBox[{"TBdeltaLorentz", "[", 
             RowBox[{"mu", ",", "0"}], "]"}], 
            RowBox[{"TBvec", "[", 
             RowBox[{"p", ",", "0"}], "]"}]}]}]}]}], "}"}]}]}]}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExpandScalarProductsFiniteT", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", ",", "p"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"UseLorentzLinearity", "[", "expr", "]"}], "//.", 
       RowBox[{"InsertOutputNaming", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"TBsp", "[", 
           RowBox[{"q_", ",", "p_"}], "]"}], "->", 
          RowBox[{
           RowBox[{"TBsps", "[", 
            RowBox[{"q", ",", "p"}], "]"}], "+", 
           RowBox[{
            RowBox[{"TBvec", "[", 
             RowBox[{"q", ",", "0"}], "]"}], 
            RowBox[{"TBvec", "[", 
             RowBox[{"p", ",", "0"}], "]"}]}]}]}], "}"}]}]}], "//.", 
      RowBox[{"InsertOutputNaming", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"TBsps", "[", 
           RowBox[{"q_", ",", "p_"}], "]"}], "->", 
          RowBox[{"q", " ", "p", " ", 
           RowBox[{"cos", "[", 
            RowBox[{"q", ",", "p"}], "]"}]}]}], ",", " ", 
         RowBox[{
          RowBox[{"cos", "[", 
           RowBox[{"p_", ",", "p_"}], "]"}], "->", "1"}]}], "}"}]}]}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExpandScalarProducts", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", ",", "p"}], "}"}], ",", 
     RowBox[{
      RowBox[{"UseLorentzLinearity", "[", "expr", "]"}], "//.", 
      RowBox[{"InsertOutputNaming", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"TBsp", "[", 
           RowBox[{"q_", ",", "p_"}], "]"}], "->", 
          RowBox[{"q", " ", "p", " ", 
           RowBox[{"cos", "[", 
            RowBox[{"q", ",", "p"}], "]"}]}]}], ",", " ", 
         RowBox[{
          RowBox[{"cos", "[", 
           RowBox[{"p_", ",", "p_"}], "]"}], "->", "1"}]}], "}"}]}]}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"cos", ",", " ", "Orderless"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Derivative", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "[", "cos", "]"}], "[", 
    RowBox[{"p_", ",", "q_"}], "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Derivative", "[", 
      RowBox[{"1", ",", "0"}], "]"}], "[", "cos", "]"}], "[", 
    RowBox[{"p_", ",", "q_"}], "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cos", "[", 
     RowBox[{"p_", ",", "p_"}], "]"}], "=", "1"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyAllMomenta", "[", 
   RowBox[{"q_", ",", "expr_", ",", 
    RowBox[{"qffac_", ":", 
     RowBox[{"\[Pi]", " ", "T"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"UseLorentzLinearity", "[", "expr", "]"}], "//.", 
    RowBox[{"InsertOutputNaming", "@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"cos", "[", 
         RowBox[{"p_", ",", 
          RowBox[{"Symbol", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<f\>\""}], "]"}]}],
          "]"}], ":>", 
        RowBox[{"Symbol", "[", 
         RowBox[{"\"\<cos\>\"", "<>", 
          RowBox[{"ToString", "[", "p", "]"}], "<>", 
          RowBox[{"ToString", "[", "q", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TBvec", "[", 
         RowBox[{"q", ",", "0"}], "]"}], ":>", 
        RowBox[{"Symbol", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<0\>\""}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TBvec", "[", 
         RowBox[{
          RowBox[{"Symbol", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<f\>\""}], "]"}], 
          ",", "0"}], "]"}], ":>", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ClearAll", "[", "T", "]"}], ";", 
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{
             RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<0\>\""}], "]"}], 
           "+", "qffac"}]}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}], "//.", 
   RowBox[{"InsertOutputNaming", "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"cos", "[", 
        RowBox[{"p_", ",", "r_"}], "]"}], ":>", 
       RowBox[{"Symbol", "[", 
        RowBox[{"\"\<cos\>\"", "<>", 
         RowBox[{"ToString", "[", "p", "]"}], "<>", 
         RowBox[{"ToString", "[", "r", "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TBvec", "[", 
        RowBox[{"p_", ",", "0"}], "]"}], ":>", 
       RowBox[{"Symbol", "[", 
        RowBox[{
         RowBox[{"ToString", "[", "p", "]"}], "<>", "\"\<0\>\""}], "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Symbol", "[", 
        RowBox[{
         RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<f\>\""}], "]"}], "->",
        "q"}]}], "\[IndentingNewLine]", "}"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.916559394147103*^9, 3.916559416106717*^9}, {
   3.916559511431814*^9, 3.916559529940345*^9}, {3.9199275266237507`*^9, 
   3.919927527880868*^9}, {3.924141918276387*^9, 3.924142140603898*^9}, {
   3.924151621346219*^9, 3.924151642977441*^9}, {3.9255519751400433`*^9, 
   3.925552044640147*^9}, {3.925552089510874*^9, 3.925552184947348*^9}, 
   3.925552283124244*^9, 3.92555370733145*^9, {3.925554006437672*^9, 
   3.925554033712428*^9}, {3.925556356021154*^9, 3.925556370447487*^9}, {
   3.926515029657043*^9, 3.926515080879002*^9}, {3.9265167541491756`*^9, 
   3.92651675425388*^9}, {3.927004026231244*^9, 3.927004035631996*^9}, {
   3.927422419512899*^9, 3.927422516321888*^9}, {3.927422669980939*^9, 
   3.9274226734406776`*^9}, 3.927422827782792*^9, {3.93330194977221*^9, 
   3.933301952037055*^9}, {3.933301983235136*^9, 3.933301987561928*^9}, {
   3.933302070034832*^9, 3.933302131780591*^9}, {3.9333023143948107`*^9, 
   3.933302323538166*^9}, {3.933302397666047*^9, 3.933302399898086*^9}, {
   3.933302509058119*^9, 3.933302512074614*^9}, {3.933397283585495*^9, 
   3.933397285800907*^9}, {3.935552669272241*^9, 3.935552810457835*^9}, {
   3.9355528637854967`*^9, 3.935552955905051*^9}, {3.935552997619392*^9, 
   3.935553100064673*^9}, {3.93555324117111*^9, 3.9355533128610487`*^9}, {
   3.935558113635854*^9, 3.935558118203428*^9}, {3.935558232523546*^9, 
   3.935558248259296*^9}, {3.937476274405942*^9, 3.937476289995173*^9}, {
   3.943457910978219*^9, 3.943457919145273*^9}, {3.948799335876896*^9, 
   3.948799365721939*^9}},ExpressionUUID->"ce5f50b1-0d9e-4a19-a5f6-\
e20a8fd2e425"],

Cell["We should be also able to access symmetric points.", "Text",ExpressionUUID->"e1b9857b-c39a-48fc-9309-f4d8cc71db28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProjectToSymmetricPoint", "[", 
   RowBox[{
   "expr_", ",", "q_Symbol", ",", "p_Symbol", ",", "momenta___Symbol"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "momentaList", ",", "nMomenta", ",", "rules", ",", "qf", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"conv", "=", "InsertOutputNaming"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"momentaList", "=", 
      RowBox[{"{", "momenta", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nMomenta", "=", 
      RowBox[{"Length", "[", "momentaList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"qf", "=", 
      RowBox[{"Symbol", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<f\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"rules", "=", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBsp", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "->", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"nMomenta", "-", "1"}], ")"}]}], ")"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBsp", "[", 
              RowBox[{"p", ",", "p"}], "]"}]}]}]}], "&"}], ",", 
         RowBox[{"Subsets", "[", 
          RowBox[{"momentaList", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
       "\[Union]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBsp", "[", 
             RowBox[{"#", ",", "#"}], "]"}]}], "->", 
           RowBox[{"conv", "@", 
            RowBox[{"TBsp", "[", 
             RowBox[{"p", ",", "p"}], "]"}]}]}], "&"}], ",", "momentaList"}], 
        "]"}], "\[IndentingNewLine]", "\[Union]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBsp", "[", 
             RowBox[{"#", ",", "q"}], "]"}]}], "->", 
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<cos\>\"", "~~", 
              RowBox[{"ToString", "[", "#", "]"}], "~~", "\"\<q\>\""}], "]"}],
             " ", "p", " ", "q"}]}], "&"}], ",", "momentaList"}], "]"}], 
       "\[IndentingNewLine]", "\[Union]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBsp", "[", 
             RowBox[{"#", ",", "qf"}], "]"}]}], "->", 
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<cos\>\"", "~~", 
              RowBox[{"ToString", "[", "#", "]"}], "~~", "\"\<q\>\""}], "]"}],
             " ", "p", " ", "qf"}]}], "&"}], ",", "momentaList"}], "]"}]}]}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"\[Union]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"momentaList", "[", 
          RowBox[{"[", "nMomenta", "]"}], "]"}], "->", 
         RowBox[{"-", 
          RowBox[{"Total", "[", 
           RowBox[{"momentaList", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", 
              RowBox[{"nMomenta", "-", "1"}]}], "]"}], "]"}], "]"}]}]}], 
        "}"}]}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"UseLorentzLinearity", "[", "expr", "]"}], "//.", "rules"}], 
        "//", "UseLorentzLinearity"}], ")"}], "//.", "rules"}]}]}], "\n", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.916559442541823*^9, 3.9165594451789*^9}, {
   3.926573415046593*^9, 3.926573470871396*^9}, {3.933302352394223*^9, 
   3.933302352562035*^9}, {3.935553339208991*^9, 3.93555335908197*^9}, 
   3.93555832561948*^9, {3.9370533210882273`*^9, 3.937053347292214*^9}, 
   3.937297065189488*^9, 3.937297166581965*^9, 3.9374747029784184`*^9, {
   3.937476323451026*^9, 3.937476340967692*^9}, {3.937482020696939*^9, 
   3.93748202354045*^9}},ExpressionUUID->"810ce3c8-5285-4d8e-a1b5-\
62745856f101"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProjectToSymmetricPointFiniteT", "[", 
   RowBox[{
   "expr_", ",", "q_Symbol", ",", "p_Symbol", ",", "momenta___Symbol"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "momentaList", ",", "nMomenta", ",", "rules", ",", "qf", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"conv", "=", "InsertOutputNaming"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"momentaList", "=", 
      RowBox[{"{", "momenta", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nMomenta", "=", 
      RowBox[{"Length", "[", "momentaList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"qf", "=", 
      RowBox[{"Symbol", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<f\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"rules", "=", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBsps", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "->", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"nMomenta", "-", "1"}], ")"}]}], ")"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBsps", "[", 
              RowBox[{"p", ",", "p"}], "]"}]}]}]}], "&"}], ",", 
         RowBox[{"Subsets", "[", 
          RowBox[{"momentaList", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
       "\[Union]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBsps", "[", 
             RowBox[{"#", ",", "#"}], "]"}]}], "->", 
           RowBox[{"conv", "@", 
            RowBox[{"TBsps", "[", 
             RowBox[{"p", ",", "p"}], "]"}]}]}], "&"}], ",", "momentaList"}], 
        "]"}], "\[IndentingNewLine]", "\[Union]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBsps", "[", 
             RowBox[{"#", ",", "q"}], "]"}]}], "->", 
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<cos\>\"", "~~", 
              RowBox[{"ToString", "[", "#", "]"}], "~~", "\"\<q\>\""}], "]"}],
             " ", "p", " ", "q"}]}], "&"}], ",", "momentaList"}], "]"}], 
       "\[IndentingNewLine]", "\[Union]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBsps", "[", 
             RowBox[{"#", ",", "qf"}], "]"}]}], "->", 
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<cos\>\"", "~~", 
              RowBox[{"ToString", "[", "#", "]"}], "~~", "\"\<q\>\""}], "]"}],
             " ", "p", " ", "qf"}]}], "&"}], ",", "momentaList"}], "]"}]}]}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"\[Union]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"momentaList", "[", 
          RowBox[{"[", "nMomenta", "]"}], "]"}], "->", 
         RowBox[{"-", 
          RowBox[{"Total", "[", 
           RowBox[{"momentaList", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", 
              RowBox[{"nMomenta", "-", "1"}]}], "]"}], "]"}], "]"}]}]}], 
        "}"}]}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"SeparateScalarProductsFiniteT", "[", 
          RowBox[{"UseLorentzLinearity", "[", "expr", "]"}], "]"}], "//.", 
         "rules"}], "//", "UseLorentzLinearity"}], ")"}], "//.", 
      "rules"}]}]}], "\n", "]"}]}]], "Input",
 CellChangeTimes->{{3.916559442541823*^9, 3.9165594778406363`*^9}, {
   3.916559555130072*^9, 3.916559557510188*^9}, {3.926573482381485*^9, 
   3.926573503924843*^9}, {3.9333023556343207`*^9, 3.933302371892617*^9}, {
   3.933302412575669*^9, 3.933302414491004*^9}, 3.935553341344554*^9, {
   3.935553383736532*^9, 3.935553389248622*^9}, 3.935558331258843*^9, {
   3.937053358133326*^9, 3.937053362349022*^9}, {3.9374746889491253`*^9, 
   3.937474697238819*^9}, {3.937476344137278*^9, 3.937476345103366*^9}, {
   3.937482031247211*^9, 3.937482033241588*^9}, {3.938505361281211*^9, 
   3.9385053639049387`*^9}, 
   3.943524213088963*^9},ExpressionUUID->"c4d7fbfa-7df7-4fba-b5ff-\
867a707f779c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simplification helpers", "Subsection",ExpressionUUID->"d835e7bb-e6b5-43e4-9aa1-5568243fcd2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"QuickSimplify", "[", "expr_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"expr", ",", 
      RowBox[{"TimeConstraint", " ", "->", " ", "0.1"}]}], "]"}], " ", "//", 
    " ", "Quiet"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.916035383261191*^9, 3.91603540755576*^9}, {
   3.91839699982629*^9, 3.918397016114456*^9}, {3.918807002886379*^9, 
   3.918807032755312*^9}, {3.921834312192461*^9, 3.9218343263911943`*^9}, {
   3.92200926321909*^9, 3.922009287348166*^9}, 3.923518807356018*^9, {
   3.93555340442406*^9, 3.935553414887597*^9}, {3.943356652910881*^9, 
   3.943356662143195*^9}},ExpressionUUID->"0ec10e2c-8bd4-4f6a-b38c-\
4b355ca1e641"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$StandardSimplify", "=", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetStandardSimplify", "[", "sim_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$StandardSimplify", "=", "sim"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$StandardQuickSimplify", "=", "QuickSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetStandardQuickSimplify", "[", "sim_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$StandardQuickSimplify", "=", "sim"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.923518745330213*^9, 3.923518796941533*^9}, {
  3.938507500164983*^9, 
  3.938507511856111*^9}},ExpressionUUID->"36a20289-4b57-4a63-bfe2-\
e6dd1069aed2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AdjustToNKernels", "[", "nKernels_Integer", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nKernels", "!=", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CloseKernels", "[", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"LaunchKernels", "[", "nKernels", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "DistributeDefinitions", "[", "\"\<TensorBases`Private`\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"DistributeDefinitions", "[", "\"\<FormTracer`\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"DistributeDefinitions", "[", 
         RowBox[{"ExtendedFormTrace", ",", "InsertChargeConjRules"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RestoreKernels", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CloseKernels", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"LaunchKernels", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "DistributeDefinitions", "[", "\"\<TensorBases`Private`\>\"", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"DistributeDefinitions", "[", "\"\<FormTracer`\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DistributeDefinitions", "[", 
      RowBox[{"ExtendedFormTrace", ",", "InsertChargeConjRules"}], "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DiFfRGMap", "[", "nKernels_Integer", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nKernels", "<=", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"ResourceFunction", "[", "\"\<DynamicMap\>\"", "]"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ResourceFunction", "[", "\"\<DynamicMap\>\"", "]"}], "[", 
           
           RowBox[{"#1", ",", "#2", ",", 
            RowBox[{"Parallel", "->", "nKernels"}]}], "]"}], "&"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.9220094809922523`*^9, {3.92209530643522*^9, 3.9220953073003807`*^9}, {
   3.92209570934629*^9, 3.9220957111308537`*^9}, 3.922095747060678*^9, {
   3.922096796328022*^9, 3.9220967997722263`*^9}, {3.9220968463757*^9, 
   3.922096877107787*^9}, {3.924145268445999*^9, 3.9241452971583853`*^9}, {
   3.924145429074662*^9, 3.924145438620611*^9}, {3.924145879496249*^9, 
   3.924145889617326*^9}, {3.924145933514007*^9, 3.924145933895958*^9}, {
   3.924146380579197*^9, 3.924146385560205*^9}, {3.924146428128695*^9, 
   3.924146443674434*^9}, {3.93281804908258*^9, 3.932818049942231*^9}, {
   3.941103147238089*^9, 
   3.941103152829924*^9}},ExpressionUUID->"49ae4092-f819-416e-bb7a-\
6589b3b78079"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tracing helpers", "Chapter",ExpressionUUID->"f366ed7d-b33b-48ee-ae86-40302a443225"],

Cell[CellGroupData[{

Cell["Tools ", "Subsubsection",
 CellChangeTimes->{{3.930795843089557*^9, 
  3.930795851219595*^9}},ExpressionUUID->"84062e2b-98a0-425f-910a-\
f459d7ecbf52"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "IterativelySum", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IterativelySum", "[", 
   RowBox[{"expr_List", ",", "nKernels_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "returnValue", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"returnValue", "=", "expr"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "returnValue", "]"}], "==", "1"}], ",", 
       RowBox[{"Return", "[", "returnValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "returnValue", "]"}], ">", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"returnValue", "=", 
        RowBox[{
         RowBox[{"DiFfRGMap", "[", "nKernels", "]"}], "[", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"$StandardQuickSimplify", "[", 
            RowBox[{"Total", "[", "#", "]"}], "]"}], "&"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"Partition", "[", 
           RowBox[{"returnValue", ",", 
            RowBox[{"UpTo", "[", "4", "]"}]}], "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"$StandardQuickSimplify", "[", "returnValue", "]"}], "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.921924050819014*^9, 3.92192415863973*^9}, {
   3.921926430050807*^9, 3.92192646171254*^9}, {3.921926499130945*^9, 
   3.92192653326075*^9}, {3.921926572753281*^9, 3.921926595462676*^9}, {
   3.922009299162072*^9, 3.92200931387902*^9}, {3.922009613992872*^9, 
   3.922009615324411*^9}, 3.93125024952717*^9, 3.931251136633842*^9, {
   3.931251306788539*^9, 3.931251346208775*^9}, 3.935553431110558*^9, 
   3.9385075523309317`*^9, {3.940743212754188*^9, 3.9407432142098227`*^9}, {
   3.940746164806233*^9, 3.940746177041751*^9}, {3.953380931498941*^9, 
   3.953380963427444*^9}, {3.953381073135551*^9, 3.953381088978877*^9}, 
   3.953381151019799*^9},
 CellLabel->
  "In[108]:=",ExpressionUUID->"aa6096f7-637d-4ada-ae53-9192b1848786"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IterativelySum", "[", 
    RowBox[{"expr_List", ",", "nKernels_Integer", ",", 
     RowBox[{"finalSize_Integer", "/;", 
      RowBox[{"finalSize", ">=", "0"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"processLists", ",", "returnValue", ",", "i"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"finalSize", "==", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"IterativelySum", "[", 
            RowBox[{"expr", ",", "nKernels"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"processLists", "=", "expr"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "processLists", "]"}], "==", "finalSize"}], 
        ",", 
        RowBox[{"Return", "[", "processLists", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"processLists", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"processLists", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ByteCount", "[", "#1", "]"}], ">", 
            RowBox[{"ByteCount", "[", "#2", "]"}]}], ")"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"processLists", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Downsample", "[", 
          RowBox[{"processLists", ",", "finalSize", ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "finalSize"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"returnValue", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"IterativelySum", "[", 
           RowBox[{"#", ",", "nKernels"}], "]"}], "&"}], ",", 
         "processLists"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Flatten", "[", "returnValue", "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.940693968227335*^9, 3.940694016238875*^9}, {
   3.940741813579823*^9, 3.940741863359786*^9}, {3.940741908013085*^9, 
   3.940741977744729*^9}, {3.9407420162078753`*^9, 3.9407420635752583`*^9}, {
   3.940742545079473*^9, 3.940742686190948*^9}, {3.940742720591029*^9, 
   3.9407428391903048`*^9}, {3.940742873794961*^9, 3.940742878827291*^9}, 
   3.9407432108902607`*^9, {3.9407446889659*^9, 3.940744708613903*^9}, {
   3.940744750698908*^9, 3.940744750990058*^9}, {3.953380978927194*^9, 
   3.953380979171949*^9}, {3.953381024295409*^9, 3.953381030383181*^9}, {
   3.953381145639667*^9, 3.953381147327465*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"ffcbf966-6cff-4e3a-be14-cba878ae9ba7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDisentangle", "[", "ex_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"$Disentangle", "=", "ex"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Disentangle", "=", "True"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9387763585748568`*^9, 3.938776397810219*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"99149744-a73a-4f55-8a15-b0ec0cfbb921"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SumDiagrams", "[", 
    RowBox[{"nKernels_Integer", ",", "postfix_String", ",", 
     RowBox[{"number_Integer", ":", "0"}], ",", 
     RowBox[{"operation_", ":", "$StandardQuickSimplify"}], ",", 
     RowBox[{"saveName_String", ":", "\"\<sum\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tempDir", ",", "files", ",", "data", ",", "mAssume", ",", 
       "returnValue"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tempDir", "=", 
       RowBox[{
        RowBox[{"GetDirectory", "[", "]"}], "<>", "\"\<TraceBuffer/\>\""}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", 
         RowBox[{
         "tempDir", "<>", "postfix", "<>", "\"\</\>\"", "<>", "saveName", 
          "<>", "\"\<.m\>\""}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Using result \\\"\>\"", "<>", "tempDir", "<>", "postfix", 
           "<>", "\"\</\>\"", "<>", "saveName", "<>", "\"\<.m\>\"", "<>", 
           "\"\<\\\" from buffer...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"Import", "[", 
           RowBox[{
           "tempDir", "<>", "postfix", "<>", "\"\</\>\"", "<>", "saveName", 
            "<>", "\"\<.m\>\""}], "]"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"number", "<", "0"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Cannot sum to negative size.\>\"", "]"}], 
         ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"FileNames", "[", 
        RowBox[{"tempDir", "<>", "postfix", "<>", "\"\</Diagram*\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AdjustToNKernels", "[", "nKernels", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"mAssume", "=", "$Assumptions"}], ";", "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"DiFfRGMap", "[", "nKernels", "]"}], "[", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Assuming", "[", 
           RowBox[{"mAssume", ",", 
            RowBox[{"operation", "[", 
             RowBox[{"Import", "[", "#", "]"}], "]"}]}], "]"}], "&"}], 
         "\[IndentingNewLine]", ",", "files"}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"returnValue", "=", 
       RowBox[{"IterativelySum", "[", 
        RowBox[{"data", ",", "nKernels", ",", "number"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"RestoreKernels", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "tempDir", "<>", "postfix", "<>", "\"\</\>\"", "<>", "saveName", 
         "<>", "\"\<.m\>\""}], ",", "returnValue"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "returnValue", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.940692782459366*^9, 3.940692887180187*^9}, {
   3.94069376688025*^9, 3.940693949252195*^9}, {3.9407428561429377`*^9, 
   3.940742912062372*^9}, {3.940743843226198*^9, 3.940743870037964*^9}, {
   3.9407439853470993`*^9, 3.9407439886700907`*^9}, {3.940744169263419*^9, 
   3.9407442444957047`*^9}, {3.940744294944529*^9, 3.940744303228161*^9}, {
   3.94074446388962*^9, 3.9407444787496147`*^9}, {3.9407445320060167`*^9, 
   3.940744550865909*^9}, {3.940744602974043*^9, 3.940744626512288*^9}, {
   3.940744861713441*^9, 3.940744866311741*^9}, {3.9407449316950397`*^9, 
   3.940744940827093*^9}, {3.9407449883239727`*^9, 3.940745004647348*^9}, {
   3.953380857747699*^9, 3.953380871351219*^9}, 
   3.95338172247266*^9},ExpressionUUID->"526d85dc-c426-46eb-a112-\
a85a94c03ed3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["T = 0", "Subsubsection",
 CellChangeTimes->{{3.918369475614151*^9, 
  3.918369478178457*^9}},ExpressionUUID->"1c14a38e-316b-47aa-895d-\
3c8119fb448b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TraceDiagrams", "[", 
    RowBox[{"nKernels_Integer", ",", "postfix_String", ",", "ex_", ",", 
     RowBox[{"preRepRules_List", ":", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"postRepRules_List", ":", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", 
   RowBox[{"TraceDiagrams", "[", 
    RowBox[{
    "$StandardSimplify", ",", "nKernels", ",", "postfix", ",", "ex", ",", 
     "preRepRules", ",", "postRepRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceDiagrams", "[", 
    RowBox[{
    "simpFunc_", ",", "nKernels_Integer", ",", "postfix_String", ",", "ex_", 
     ",", 
     RowBox[{"preRepRules_List", ":", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"postRepRules_List", ":", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"returnValue", ",", "files", ",", "tempDir"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tempDir", "=", 
       RowBox[{
        RowBox[{"GetDirectory", "[", "]"}], "<>", "\"\<TraceBuffer/\>\""}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Tracing...\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AdjustToNKernels", "[", "nKernels", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "@", 
         RowBox[{"DirectoryQ", "[", 
          RowBox[{"tempDir", "<>", "postfix"}], "]"}]}], ",", 
        RowBox[{"CreateDirectory", "[", 
         RowBox[{"tempDir", "<>", "postfix"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"DisentangleLorentzStructures", "[", "$Disentangle", "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DiFfRGMap", "[", "nKernels", "]"}], "[", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FileExistsQ", "[", 
             RowBox[{"tempDir", "<>", "postfix", "<>", "\"\</Diagram\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.m\>\""}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"tempDir", "<>", "postfix", "<>", "\"\</Diagram\>\"", "<>", 
             RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.m\>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Export", "[", 
             RowBox[{
              RowBox[{"tempDir", "<>", "postfix", "<>", "\"\</Diagram\>\"", "<>", 
               RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.m\>\""}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"simpFunc", "[", "\[IndentingNewLine]", 
               RowBox[{"ExtendedFormTrace", "[", 
                RowBox[{
                 RowBox[{"ex", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], ",", "$Disentangle", ",", 
                 "preRepRules", ",", "postRepRules"}], "]"}], 
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}],
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ")"}], "&"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "ex", "]"}]}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<...done.\>\"", "]"}], ";"}]}], "\n", "]"}]}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.916035467915573*^9, 3.916035628050825*^9}, {
   3.916035760181413*^9, 3.916035860011612*^9}, {3.916035903825281*^9, 
   3.916035978957209*^9}, {3.9160360563768387`*^9, 3.9160360775739107`*^9}, {
   3.916043161073368*^9, 3.916043180620496*^9}, {3.916044497493359*^9, 
   3.9160445003868*^9}, {3.9160445523247557`*^9, 3.9160445655449*^9}, 
   3.916044598654509*^9, {3.916049125226288*^9, 3.916049127570181*^9}, {
   3.91604919471919*^9, 3.916049234508441*^9}, 3.916053961177088*^9, {
   3.916068514630723*^9, 3.916068515535771*^9}, {3.916557217588565*^9, 
   3.916557258599119*^9}, {3.916559239778974*^9, 3.916559252006316*^9}, {
   3.917168922009775*^9, 3.917169094472813*^9}, 3.917169254596053*^9, {
   3.918401029632093*^9, 3.918401065738359*^9}, {3.919163479524779*^9, 
   3.919163480847885*^9}, {3.919748460453006*^9, 3.919748511133582*^9}, {
   3.919748561611866*^9, 3.919748563784668*^9}, 3.919748711506392*^9, 
   3.919756022263293*^9, 3.921274050276956*^9, {3.9212779376460543`*^9, 
   3.921277972481299*^9}, {3.921627211230574*^9, 3.921627232152989*^9}, {
   3.921627776347285*^9, 3.921627793531624*^9}, 3.921637815461226*^9, 
   3.921639739328759*^9, {3.921639897469016*^9, 3.921639923248357*^9}, {
   3.921639966602276*^9, 3.921640000666855*^9}, {3.921794881132115*^9, 
   3.92179489205466*^9}, 3.921796758061676*^9, {3.921877622531914*^9, 
   3.921877624208668*^9}, {3.921924018560704*^9, 3.921924045691427*^9}, {
   3.921924179178529*^9, 3.9219241804810247`*^9}, {3.92200772099935*^9, 
   3.922007724118718*^9}, {3.922008155109124*^9, 3.922008165075481*^9}, {
   3.922008238789178*^9, 3.922008241958295*^9}, 3.922008313105666*^9, {
   3.9220090948805027`*^9, 3.922009176528744*^9}, {3.922009346379897*^9, 
   3.922009348918109*^9}, {3.922009616197913*^9, 3.922009622231333*^9}, {
   3.922010418598946*^9, 3.922010421030621*^9}, {3.9220854519341784`*^9, 
   3.9220854737333927`*^9}, {3.922099858232027*^9, 3.922099860717196*^9}, {
   3.922099896937889*^9, 3.922099897247322*^9}, 3.923455211698472*^9, 
   3.923518847771082*^9, 3.9241459415142593`*^9, 3.924145981242131*^9, {
   3.927101465396864*^9, 3.927101499132047*^9}, {3.927101595045299*^9, 
   3.927101605042012*^9}, 3.927114743224869*^9, 3.927114822269679*^9, {
   3.927217923278203*^9, 3.927217927058666*^9}, {3.927257874951838*^9, 
   3.927257905411917*^9}, {3.927257976391212*^9, 3.927257982580759*^9}, {
   3.92738574220205*^9, 3.927385766298183*^9}, {3.9273857972339*^9, 
   3.92738580323571*^9}, {3.9274223719051447`*^9, 3.927422397909115*^9}, {
   3.927422527159059*^9, 3.9274225611637497`*^9}, 3.9328180525469503`*^9, {
   3.933302443780013*^9, 3.933302450859674*^9}, {3.9359102385371323`*^9, 
   3.935910240936757*^9}, {3.93749074435009*^9, 3.9374907514460287`*^9}, 
   3.9387763485016327`*^9, 3.938776793452112*^9, {3.940261763578583*^9, 
   3.940261822487343*^9}, {3.9406927542831984`*^9, 3.940692758423099*^9}, 
   3.940692842063571*^9, {3.940743159138884*^9, 3.940743173286648*^9}, 
   3.940743833666937*^9},ExpressionUUID->"c102c626-0fc1-4c95-ad17-\
bb2713c2d956"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TraceToSP", "[", 
    RowBox[{
    "nKernels_Integer", ",", "postfix_String", ",", "ex_", ",", "q_Symbol", 
     ",", "p_Symbol", ",", "momenta___Symbol"}], "]"}], ":=", 
   RowBox[{"TraceToSP", "[", 
    RowBox[{
    "$StandardSimplify", ",", "nKernels", ",", "postfix", ",", "ex", ",", "q",
      ",", "p", ",", "momenta"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TraceToSP", "[", 
   RowBox[{
   "simpFunc_", ",", "nKernels_Integer", ",", "postfix_String", ",", "ex_", 
    ",", "q_Symbol", ",", "p_Symbol", ",", "momenta___Symbol"}], "]"}], ":=", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"returnValue", ",", "files", ",", "tempDir"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tempDir", "=", 
      RowBox[{
       RowBox[{"GetDirectory", "[", "]"}], "<>", "\"\<TraceBuffer/\>\""}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Tracing...\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AdjustToNKernels", "[", "nKernels", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"DirectoryQ", "[", 
         RowBox[{"tempDir", "<>", "postfix"}], "]"}]}], ",", 
       RowBox[{"CreateDirectory", "[", 
        RowBox[{"tempDir", "<>", "postfix"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"DisentangleLorentzStructures", "[", "$Disentangle", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DiFfRGMap", "[", "nKernels", "]"}], "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "[", 
            RowBox[{"tempDir", "<>", "postfix", "<>", "\"\</Diagram\>\"", "<>", 
             RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.m\>\""}], "]"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"tempDir", "<>", "postfix", "<>", "\"\</Diagram\>\"", "<>", 
            RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.m\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{"tempDir", "<>", "postfix", "<>", "\"\</Diagram\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.m\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"simpFunc", "[", "\[IndentingNewLine]", 
              RowBox[{"ExtendedFormTrace", "[", 
               RowBox[{
                RowBox[{"ex", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], ",", "$Disentangle", ",", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"MakeSPFormRule", "[", 
                 RowBox[{"q", ",", "p", ",", "momenta"}], "]"}]}], "]"}], 
              "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ")"}], "&"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ex", "]"}]}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<...done.\>\"", "]"}], ";"}]}], "\n", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.916035467915573*^9, 3.916035628050825*^9}, {
   3.916035760181413*^9, 3.916035860011612*^9}, {3.916035903825281*^9, 
   3.916035978957209*^9}, {3.9160360563768387`*^9, 3.9160360775739107`*^9}, {
   3.916043161073368*^9, 3.916043180620496*^9}, {3.916044497493359*^9, 
   3.9160445003868*^9}, {3.9160445523247557`*^9, 3.9160445655449*^9}, 
   3.916044598654509*^9, {3.916049125226288*^9, 3.916049127570181*^9}, {
   3.91604919471919*^9, 3.916049234508441*^9}, 3.916053961177088*^9, {
   3.916068514630723*^9, 3.916068515535771*^9}, {3.916557217588565*^9, 
   3.916557258599119*^9}, {3.916559239778974*^9, 3.916559252006316*^9}, {
   3.917168922009775*^9, 3.917169094472813*^9}, 3.917169254596053*^9, {
   3.918401029632093*^9, 3.918401065738359*^9}, {3.919163479524779*^9, 
   3.919163480847885*^9}, {3.919748460453006*^9, 3.919748511133582*^9}, {
   3.919748561611866*^9, 3.919748563784668*^9}, 3.919748711506392*^9, 
   3.919756022263293*^9, 3.921274050276956*^9, {3.9212779376460543`*^9, 
   3.921277972481299*^9}, {3.921627211230574*^9, 3.921627232152989*^9}, {
   3.921627776347285*^9, 3.921627793531624*^9}, 3.921637815461226*^9, 
   3.921639739328759*^9, {3.921639897469016*^9, 3.921639923248357*^9}, {
   3.921639966602276*^9, 3.921640000666855*^9}, {3.921794881132115*^9, 
   3.92179489205466*^9}, 3.921796758061676*^9, {3.921877622531914*^9, 
   3.921877624208668*^9}, {3.921924018560704*^9, 3.921924045691427*^9}, {
   3.921924179178529*^9, 3.9219241804810247`*^9}, {3.92200772099935*^9, 
   3.922007724118718*^9}, {3.922008155109124*^9, 3.922008165075481*^9}, {
   3.922008238789178*^9, 3.922008241958295*^9}, 3.922008313105666*^9, {
   3.9220090948805027`*^9, 3.922009176528744*^9}, {3.922009346379897*^9, 
   3.922009348918109*^9}, {3.922009616197913*^9, 3.922009622231333*^9}, {
   3.922010418598946*^9, 3.922010421030621*^9}, {3.9220854519341784`*^9, 
   3.9220854737333927`*^9}, {3.922099858232027*^9, 3.922099860717196*^9}, {
   3.922099896937889*^9, 3.922099897247322*^9}, 3.923455211698472*^9, 
   3.923518847771082*^9, 3.9241459415142593`*^9, 3.924145981242131*^9, {
   3.927101465396864*^9, 3.927101499132047*^9}, {3.927101595045299*^9, 
   3.927101605042012*^9}, 3.927114743224869*^9, 3.927114822269679*^9, {
   3.927217923278203*^9, 3.927217927058666*^9}, {3.927257874951838*^9, 
   3.927257905411917*^9}, {3.927257976391212*^9, 3.927257982580759*^9}, 
   3.932818053531947*^9, {3.933302148011207*^9, 3.9333021595217543`*^9}, {
   3.933302451686635*^9, 3.933302457703142*^9}, {3.9333213120237722`*^9, 
   3.933321312086502*^9}, {3.937490689846678*^9, 3.937490693781928*^9}, {
   3.938776333287282*^9, 3.938776335754171*^9}, 3.938776797184793*^9, {
   3.9403074399668493`*^9, 3.940307462180048*^9}, {3.940692764163908*^9, 
   3.9406927681993217`*^9}, {3.940743185523212*^9, 3.940743187871241*^9}, 
   3.94074382969163*^9},ExpressionUUID->"758e23b8-5dea-4615-a3f6-\
7fc76e510a1c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["finite T", "Subsubsection",
 CellChangeTimes->{{3.918369475614151*^9, 
  3.9183694883283453`*^9}},ExpressionUUID->"a1c038e6-bf24-4038-873c-\
c16217fed8c7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TraceToSPFiniteT", "[", 
    RowBox[{
    "nKernels_Integer", ",", "postfix_String", ",", "ex_", ",", "q_Symbol", 
     ",", "p_Symbol", ",", "momenta___Symbol"}], "]"}], ":=", 
   RowBox[{"TraceToSPFiniteT", "[", 
    RowBox[{
    "$StandardSimplify", ",", "nKernels", ",", "postfix", ",", "ex", ",", "q",
      ",", "p", ",", "momenta"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TraceToSPFiniteT", "[", 
   RowBox[{
   "simpFunc_", ",", "nKernels_Integer", ",", "postfix_String", ",", "ex_", 
    ",", "q_Symbol", ",", "p_Symbol", ",", "momenta___Symbol"}], "]"}], ":=", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"returnValue", ",", "files", ",", "tempDir"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tempDir", "=", 
      RowBox[{
       RowBox[{"GetDirectory", "[", "]"}], "<>", "\"\<TraceBuffer/\>\""}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Tracing...\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AdjustToNKernels", "[", "nKernels", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", 
        RowBox[{"DirectoryQ", "[", 
         RowBox[{"tempDir", "<>", "postfix"}], "]"}]}], ",", 
       RowBox[{"CreateDirectory", "[", 
        RowBox[{"tempDir", "<>", "postfix"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"DisentangleLorentzStructures", "[", "$Disentangle", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DiFfRGMap", "[", "nKernels", "]"}], "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "[", 
            RowBox[{"tempDir", "<>", "postfix", "<>", "\"\</Diagram\>\"", "<>", 
             RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.m\>\""}], "]"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"tempDir", "<>", "postfix", "<>", "\"\</Diagram\>\"", "<>", 
            RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.m\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{"tempDir", "<>", "postfix", "<>", "\"\</Diagram\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.m\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"simpFunc", "[", "\[IndentingNewLine]", 
              RowBox[{"ExtendedFormTrace", "[", 
               RowBox[{
                RowBox[{"ex", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], ",", "$Disentangle", ",", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"MakeSPFiniteTFormRule", "[", 
                 RowBox[{"q", ",", "p", ",", "momenta"}], "]"}]}], "]"}], 
              "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ")"}], "&"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ex", "]"}]}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"\"\<Parallel\>\"", "->", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nKernels", ">", "0"}], ",", "nKernels", ",", "False"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<...done.\>\"", "]"}], ";"}]}], "\n", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.916035467915573*^9, 3.916035628050825*^9}, {
   3.916035760181413*^9, 3.916035860011612*^9}, {3.916035903825281*^9, 
   3.916035978957209*^9}, {3.9160360563768387`*^9, 3.9160360775739107`*^9}, {
   3.916043161073368*^9, 3.916043180620496*^9}, {3.916044497493359*^9, 
   3.9160445003868*^9}, {3.9160445523247557`*^9, 3.9160445655449*^9}, 
   3.916044598654509*^9, {3.916049125226288*^9, 3.916049127570181*^9}, {
   3.91604919471919*^9, 3.916049234508441*^9}, 3.916053961177088*^9, {
   3.916068514630723*^9, 3.916068515535771*^9}, {3.916557217588565*^9, 
   3.916557258599119*^9}, {3.916559239778974*^9, 3.916559252006316*^9}, {
   3.917168922009775*^9, 3.917169094472813*^9}, 3.917169254596053*^9, {
   3.918369369704671*^9, 3.918369400692473*^9}, {3.918392028670742*^9, 
   3.918392052435354*^9}, {3.918392328566368*^9, 3.918392357135689*^9}, {
   3.918401075571446*^9, 3.918401103369722*^9}, 3.919163494758042*^9, {
   3.91974861008669*^9, 3.91974862565926*^9}, 3.91974872765724*^9, 
   3.919756032661118*^9, 3.921274052256857*^9, 3.9212780165120773`*^9, {
   3.9216272375290203`*^9, 3.9216272398472157`*^9}, {3.921627819136607*^9, 
   3.921627824436708*^9}, 3.92163780685797*^9, 3.921639748443096*^9, {
   3.9216399082638063`*^9, 3.9216399380667353`*^9}, {3.921640048784588*^9, 
   3.921640069039784*^9}, {3.921640099042543*^9, 3.921640099588398*^9}, {
   3.92179488113841*^9, 3.921794893771109*^9}, 3.921796762552607*^9, {
   3.921877683736177*^9, 3.921877686422332*^9}, 3.921924200520065*^9, 
   3.922009196458015*^9, 3.9220093584946136`*^9, 3.922009608622031*^9, {
   3.9220998733576193`*^9, 3.922099880765551*^9}, 3.923455202775309*^9, 
   3.923518856632621*^9, 3.924145951615562*^9, 3.924145988953198*^9, {
   3.927101529940792*^9, 3.927101564253919*^9}, 3.927114716081911*^9, 
   3.9271148304101686`*^9, {3.927217946300239*^9, 3.92721794872947*^9}, 
   3.9272579898080063`*^9, 3.932818056190709*^9, 3.9333021821387987`*^9, {
   3.933302422992924*^9, 3.933302428144772*^9}, {3.933302464035854*^9, 
   3.9333024664219847`*^9}, 3.933321322502698*^9, {3.937490769354686*^9, 
   3.937490772854149*^9}, 3.938776343555194*^9, 3.9387768015960827`*^9, {
   3.940261712110738*^9, 3.9402617271715603`*^9}, {3.94030732324214*^9, 
   3.940307377830078*^9}, {3.9403074224788437`*^9, 3.940307428126367*^9}, {
   3.940692771831829*^9, 3.940692774175827*^9}, {3.940743192214918*^9, 
   3.940743194566855*^9}, 
   3.9407438241159477`*^9},ExpressionUUID->"d868be6e-4012-4b42-83aa-\
981c63f64ce0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finishing package", "Chapter",
 CellChangeTimes->{{3.919139867121632*^9, 
  3.919139874722487*^9}},ExpressionUUID->"eb83e232-65a2-4d0f-bb6d-\
f0945c3adc5b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"End", "[", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.943460195403545*^9, 3.943460198755838*^9}, 
   3.9434659664261913`*^9},ExpressionUUID->"509cad0d-91ac-465f-84aa-\
0c407dd8447e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Protect", "[", "\"\<DiFfRG`*\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.932041570050847*^9, 3.932041572308077*^9}, {
   3.9338200005526*^9, 3.933820001984568*^9}, 3.935485891940338*^9},
 CellLabel->
  "In[795]:=",ExpressionUUID->"11168ab6-9d39-4066-ac78-95e82059e15d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"EndPackage", "[", "]"}], ";"}], "*)"}]], "Code",
 CellChangeTimes->{3.935550736988943*^9, 3.9434596065541353`*^9, 
  3.943465963956756*^9},ExpressionUUID->"0b9eddaf-13f2-4674-aa20-\
9e441963e625"],

Cell[BoxData[
 RowBox[{"AddCodeOptimizeFunctions", "[", 
  RowBox[{
   RowBox[{"RBdot", "[", "__", "]"}], ",", 
   RowBox[{"RFdot", "[", "__", "]"}], ",", 
   RowBox[{"RB", "[", "__", "]"}], ",", 
   RowBox[{"RF", "[", "__", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.94343444900884*^9, 
  3.943434449009397*^9}},ExpressionUUID->"974290d3-5ff2-48a6-9456-\
2302cc4ecb17"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
InitializationCellEvaluation->False,
InitializationCellWarning->False,
WindowSize->{1185, 711},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.7 Inherited,
FrontEndVersion->"14.1 for Linux x86 (64-bit) (July 16, 2024)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Input"], InitializationCell -> True]}, Visible -> False, 
  FrontEndVersion -> "14.1 for Linux x86 (64-bit) (July 16, 2024)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"f773db9b-bac4-428f-be6f-dd7aa2b60e55"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 163, 3, 67, "Title",ExpressionUUID->"6248d5fa-c573-4525-a670-9e386e01b70a"],
Cell[CellGroupData[{
Cell[768, 29, 158, 3, 47, "Chapter",ExpressionUUID->"2e9a49bb-c5b9-4ce9-8785-5639cec0c785"],
Cell[CellGroupData[{
Cell[951, 36, 161, 3, 46, "Section",ExpressionUUID->"da5a7dc4-ae9d-446f-93ac-ea9cd52b1279"],
Cell[CellGroupData[{
Cell[1137, 43, 973, 16, 91, "Input",ExpressionUUID->"94c25270-d3c0-4203-b83e-cd7c70b60a77"],
Cell[2113, 61, 4610, 68, 67, "Print",ExpressionUUID->"412ae56e-d50c-4fb0-97f4-ff95f2c10346"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6772, 135, 170, 3, 46, "Section",ExpressionUUID->"4dc5bed6-6c6a-4d50-aeab-1ddf7e9466bf"],
Cell[6945, 140, 4266, 98, 392, "Input",ExpressionUUID->"ee90b9ab-0619-46b5-a41f-8d6e747c207f"],
Cell[11214, 240, 4369, 101, 392, "Input",ExpressionUUID->"b6c058c7-8472-4d64-af22-d443900c6253"],
Cell[15586, 343, 2168, 48, 159, "Input",ExpressionUUID->"eef75579-ae63-4ec4-a33b-b226833913f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17791, 396, 197, 4, 46, "Section",ExpressionUUID->"1acf37e7-e1e9-4f65-abab-efb2f0611907"],
Cell[17991, 402, 1628, 33, 95, "Input",ExpressionUUID->"0ecf2351-416b-4029-aab2-5caad4646302",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[19644, 439, 878, 18, 48, "Input",ExpressionUUID->"2986308d-feb7-46e4-962b-1f4a31c7cf15"],
Cell[20525, 459, 478, 8, 24, "Output",ExpressionUUID->"b2a116db-9433-486f-8e76-ed979ff3cea4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21052, 473, 174, 3, 46, "Section",ExpressionUUID->"099d12f8-45f0-4498-861c-4146c22241e3"],
Cell[21229, 478, 1367, 32, 215, "Input",ExpressionUUID->"f0438960-5e66-4714-ab13-348d02ca9679"],
Cell[22599, 512, 403, 9, 45, "Input",ExpressionUUID->"9368b5d6-feeb-454a-8d00-94cd703784f6"],
Cell[23005, 523, 416, 9, 45, "Input",ExpressionUUID->"b7a9e79b-a6ff-4ce9-a961-d0b7ede31244"],
Cell[23424, 534, 508, 10, 45, "Input",ExpressionUUID->"e984b499-c21d-4662-82c3-8e51dad58e88"],
Cell[23935, 546, 314, 7, 45, "Input",ExpressionUUID->"0e042229-5a4f-4fb5-a9d1-845b7b27e442"],
Cell[24252, 555, 360, 7, 47, "Input",ExpressionUUID->"af7781f0-142e-49aa-b767-d384ba23c0fe"],
Cell[24615, 564, 3021, 70, 314, "Input",ExpressionUUID->"0b416ff5-f4df-4493-8255-266f3e2d1fc1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27673, 639, 159, 3, 46, "Section",ExpressionUUID->"d9e7f4e0-bee1-441c-9357-518ec0e70346"],
Cell[27835, 644, 250, 5, 32, "Input",ExpressionUUID->"d3d9ecf5-81b9-41a4-ba9e-d222237bb21d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28134, 655, 199, 4, 47, "Chapter",ExpressionUUID->"d2b37a69-1798-45aa-ba74-ac366e35523f"],
Cell[28336, 661, 200, 3, 23, "Text",ExpressionUUID->"ad5cdf87-2437-494b-bacf-1d106e594491"],
Cell[28539, 666, 567, 16, 48, "Input",ExpressionUUID->"bd12fd7b-1c57-476f-b00d-ba3c6dae4d82"],
Cell[29109, 684, 2359, 53, 185, "Input",ExpressionUUID->"045d2a29-83b2-45f3-9096-804f8428948f",
 InitializationCell->True],
Cell[31471, 739, 3367, 79, 357, "Input",ExpressionUUID->"2249301c-6588-4290-93cc-6173e59d7027"],
Cell[34841, 820, 1349, 34, 111, "Input",ExpressionUUID->"49ffa1b8-f5a9-48c3-a7b9-85ad969f5610"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36227, 859, 208, 4, 47, "Chapter",ExpressionUUID->"4db05b9d-0e6c-46c1-8bc4-444d96782a81"],
Cell[36438, 865, 167, 3, 23, "Text",ExpressionUUID->"f39e01f0-a434-46ca-b8c9-036dc7d8a61d"],
Cell[36608, 870, 3953, 101, 188, "Input",ExpressionUUID->"7960f290-05bc-46c9-9e8a-e030620c84a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40598, 976, 164, 3, 47, "Chapter",ExpressionUUID->"f5ab99e5-bf40-4be4-99bc-a45c18eb6844"],
Cell[40765, 981, 4397, 90, 259, "Input",ExpressionUUID->"6f9d9584-8426-4353-ba5b-d7eb6fd0cc66"],
Cell[45165, 1073, 3794, 94, 264, "Input",ExpressionUUID->"55d7a86d-c906-48bd-a3bf-992b994560a1"],
Cell[CellGroupData[{
Cell[48984, 1171, 169, 3, 37, "Subsection",ExpressionUUID->"12b52e25-a4c7-4a18-be0b-c15de07921b6"],
Cell[49156, 1176, 245, 6, 23, "Text",ExpressionUUID->"3361abb5-df92-442c-b140-951784d155e0"],
Cell[49404, 1184, 14653, 323, 766, "Input",ExpressionUUID->"f4637967-a96d-48f9-b7db-410a0759650a"],
Cell[64060, 1509, 18691, 448, 787, "Input",ExpressionUUID->"18926360-5b65-4d8a-83d8-f07b944f6259"]
}, Closed]],
Cell[CellGroupData[{
Cell[82788, 1962, 108, 0, 27, "Subsection",ExpressionUUID->"79f165a1-f8a9-4344-985e-d675083ef03a"],
Cell[82899, 1964, 1343, 32, 152, "Input",ExpressionUUID->"99262b5b-bcc4-41d1-a31c-57fe268a0708"],
Cell[84245, 1998, 31435, 766, 1987, "Input",ExpressionUUID->"045aca76-872a-4efe-bc44-22388023a3fe",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[115717, 2769, 216, 4, 27, "Subsection",ExpressionUUID->"bf42ef60-7287-492a-9bb1-52ea464446f9"],
Cell[115936, 2775, 2367, 57, 111, "Input",ExpressionUUID->"5393f01d-ccc6-406d-bb8a-c45c60efc560",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[118340, 2837, 181, 3, 27, "Subsection",ExpressionUUID->"4d56e7e7-161b-4b74-b488-65a36ac185e9"],
Cell[118524, 2842, 1176, 26, 217, "Input",ExpressionUUID->"ae36dd1e-7116-4a35-993f-4c93111e1145"],
Cell[119703, 2870, 1626, 37, 154, "Input",ExpressionUUID->"9bed5dbf-0e2f-4a48-80bd-60a3554a4cea"],
Cell[121332, 2909, 2745, 58, 704, "Input",ExpressionUUID->"57c94276-aa3b-4013-a683-5cf5858a14ac"],
Cell[124080, 2969, 3148, 64, 817, "Input",ExpressionUUID->"e8fec9f6-b3ba-43dd-912c-5612d7185333"],
Cell[127231, 3035, 6817, 153, 769, "Input",ExpressionUUID->"54fc9c34-384c-43b0-9dca-9c647b4f70da"],
Cell[134051, 3190, 1317, 36, 80, "Input",ExpressionUUID->"a68b4dbc-00e0-430f-80c4-8612ecea1dbd"],
Cell[135371, 3228, 2079, 52, 140, "Input",ExpressionUUID->"d697c06a-8bae-40cd-9a25-ffa4b79d6879"],
Cell[137453, 3282, 9237, 193, 1510, "Input",ExpressionUUID->"0adf48c2-98f0-45f1-bc63-339fa08dafa4"],
Cell[146693, 3477, 8496, 183, 1510, "Input",ExpressionUUID->"8e653815-4541-440b-bd72-011c19ad9c13"],
Cell[155192, 3662, 9454, 196, 1524, "Input",ExpressionUUID->"0f6c81a8-ac09-48ec-a471-88fe663c0f3d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164683, 3863, 177, 3, 37, "Subsection",ExpressionUUID->"c38e477d-dd37-4bc9-8fb7-bdda27f3872d"],
Cell[164863, 3868, 3782, 94, 248, "Input",ExpressionUUID->"e6a75dcc-0035-46b2-8932-4a0990024083"],
Cell[168648, 3964, 4031, 89, 289, "Input",ExpressionUUID->"72c596f7-a080-4fde-86c1-d8a9fffc29be"]
}, Closed]],
Cell[CellGroupData[{
Cell[172716, 4058, 164, 3, 27, "Subsection",ExpressionUUID->"1e32e353-e76a-4e26-ae6c-7769579113e4"],
Cell[172883, 4063, 3964, 81, 190, "Input",ExpressionUUID->"f3cb2154-af8e-461b-aaff-4717fb59d45b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[176896, 4150, 170, 3, 47, "Chapter",ExpressionUUID->"a8ec222a-06c2-4128-8ebf-16259da48732"],
Cell[CellGroupData[{
Cell[177091, 4157, 172, 3, 37, "Subsection",ExpressionUUID->"0326ce6d-42d3-484e-afb8-ce1d4f618c7b"],
Cell[177266, 4162, 123, 0, 23, "Text",ExpressionUUID->"9b5d02cd-e32a-4fa5-a4a5-a6651ddbd837"],
Cell[177392, 4164, 8068, 209, 1134, "Input",ExpressionUUID->"ce5f50b1-0d9e-4a19-a5f6-e20a8fd2e425"],
Cell[185463, 4375, 121, 0, 39, "Text",ExpressionUUID->"e1b9857b-c39a-48fc-9309-f4d8cc71db28"],
Cell[185587, 4377, 4354, 115, 694, "Input",ExpressionUUID->"810ce3c8-5285-4d8e-a1b5-62745856f101"],
Cell[189944, 4494, 4618, 119, 208, "Input",ExpressionUUID->"c4d7fbfa-7df7-4fba-b5ff-867a707f779c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[194599, 4618, 99, 0, 37, "Subsection",ExpressionUUID->"d835e7bb-e6b5-43e4-9aa1-5568243fcd2d"],
Cell[194701, 4620, 752, 16, 32, "Input",ExpressionUUID->"0ec10e2c-8bd4-4f6a-b38c-4b355ca1e641",
 InitializationCell->True],
Cell[195456, 4638, 966, 26, 136, "Input",ExpressionUUID->"36a20289-4b57-4a63-bfe2-e6dd1069aed2"],
Cell[196425, 4666, 3243, 72, 359, "Input",ExpressionUUID->"49ae4092-f819-416e-bb7a-6589b3b78079"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[199717, 4744, 89, 0, 47, "Chapter",ExpressionUUID->"f366ed7d-b33b-48ee-ae86-40302a443225"],
Cell[CellGroupData[{
Cell[199831, 4748, 157, 3, 30, "Subsubsection",ExpressionUUID->"84062e2b-98a0-425f-910a-f459d7ecbf52"],
Cell[199991, 4753, 2357, 52, 247, "Input",ExpressionUUID->"aa6096f7-637d-4ada-ae53-9192b1848786"],
Cell[202351, 4807, 3081, 70, 275, "Input",ExpressionUUID->"ffcbf966-6cff-4e3a-be14-cba878ae9ba7"],
Cell[205435, 4879, 538, 14, 77, "Input",ExpressionUUID->"99149744-a73a-4f55-8a15-b0ec0cfbb921"],
Cell[205976, 4895, 4204, 90, 424, "Input",ExpressionUUID->"526d85dc-c426-46eb-a112-a85a94c03ed3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210217, 4990, 156, 3, 30, "Subsubsection",ExpressionUUID->"1c14a38e-316b-47aa-895d-3c8119fb448b"],
Cell[210376, 4995, 6763, 129, 417, "Input",ExpressionUUID->"c102c626-0fc1-4c95-ad17-bb2713c2d956",
 InitializationCell->True],
Cell[217142, 5126, 6425, 121, 401, "Input",ExpressionUUID->"758e23b8-5dea-4615-a3f6-7fc76e510a1c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[223604, 5252, 161, 3, 30, "Subsubsection",ExpressionUUID->"a1c038e6-bf24-4038-873c-c16217fed8c7"],
Cell[223768, 5257, 6251, 121, 417, "Input",ExpressionUUID->"d868be6e-4012-4b42-83aa-981c63f64ce0",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[230068, 5384, 162, 3, 47, "Chapter",ExpressionUUID->"eb83e232-65a2-4d0f-bb6d-f0945c3adc5b"],
Cell[230233, 5389, 227, 5, 32, "Input",ExpressionUUID->"509cad0d-91ac-465f-84aa-0c407dd8447e"],
Cell[230463, 5396, 312, 6, 32, "Input",ExpressionUUID->"11168ab6-9d39-4066-ac78-95e82059e15d"],
Cell[230778, 5404, 249, 6, 37, "Code",ExpressionUUID->"0b9eddaf-13f2-4674-aa20-9e441963e625"],
Cell[231030, 5412, 375, 9, 32, "Input",ExpressionUUID->"974290d3-5ff2-48a6-9456-2302cc4ecb17"]
}, Open  ]]
}, Open  ]]
}
]
*)

