(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    106064,       2556]
NotebookOptionsPosition[     99761,       2443]
NotebookOutlinePosition[    100549,       2469]
CellTagsIndexPosition[    100506,       2466]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["DiFfRG Master package", "Title",
 CellChangeTimes->{{3.93548538697089*^9, 
  3.935485390763062*^9}},ExpressionUUID->"6248d5fa-c573-4525-a670-\
9e386e01b70a"],

Cell[CellGroupData[{

Cell["Package Setup", "Chapter",
 CellChangeTimes->{{3.935485401139076*^9, 
  3.935485439328948*^9}},ExpressionUUID->"2e9a49bb-c5b9-4ce9-8785-\
5639cec0c785"],

Cell[CellGroupData[{

Cell["Welcome  Message", "Section",
 CellChangeTimes->{{3.933860697506505*^9, 
  3.933860701282316*^9}},ExpressionUUID->"da5a7dc4-ae9d-446f-93ac-\
ea9cd52b1279"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Print", "[", 
  "\"\<Mathematica package \
\!\(\*StyleBox[\"DiFfRG\",FontWeight->\"Bold\"]\)\!\(\*StyleBox[\" \
\",FontWeight->\"Bold\"]\)loaded\n\
\!\(\*StyleBox[\"Authors\",FontWeight->\"Bold\"]\): Franz Richard Sattler\n\!\
\(\*StyleBox[\"Version\",FontWeight->\"Bold\"]\): 2.0\n\
\!\(\*StyleBox[\"Year\",FontWeight->\"Bold\"]\): 2025\n\>\"", "]"}]], "Input",\

 CellChangeTimes->{{3.93382135272999*^9, 3.933821544369678*^9}, {
   3.933852102960898*^9, 3.93385215369654*^9}, {3.9338533716572638`*^9, 
   3.933853391208394*^9}, 3.933853820321669*^9, {3.9338561865614557`*^9, 
   3.9338561884407663`*^9}, {3.933856230552123*^9, 3.933856361417264*^9}, {
   3.93385647006616*^9, 3.933856531233593*^9}, {3.9338604605457373`*^9, 
   3.933860560578547*^9}, 3.933918356157299*^9, {3.933996906999851*^9, 
   3.933996927267945*^9}, {3.935485443963874*^9, 3.935485454241703*^9}, {
   3.957454685049446*^9, 
   3.9574546876207314`*^9}},ExpressionUUID->"94c25270-d3c0-4203-b83e-\
cd7c70b60a77"],

Cell[BoxData["\<\"Mathematica package \
\\!\\(\\*StyleBox[\\\"DiFfRG\\\",FontWeight->\\\"Bold\\\"]\\)\\!\\(\\*\
StyleBox[\\\" \
\\\",FontWeight->\\\"Bold\\\"]\\)loaded\\n\\!\\(\\*StyleBox[\\\"Authors\\\",\
FontWeight->\\\"Bold\\\"]\\): Franz Richard \
Sattler\\n\\!\\(\\*StyleBox[\\\"Version\\\",FontWeight->\\\"Bold\\\"]\\): 1.0\
\\n\\!\\(\\*StyleBox[\\\"Year\\\",FontWeight->\\\"Bold\\\"]\\): \
2024\\n\"\>"], "Print",
 CellChangeTimes->{
  3.933860706886597*^9, 3.933864540851795*^9, 3.933904794757718*^9, 
   3.933914006318946*^9, 3.933917960176111*^9, 3.933919663865212*^9, 
   3.933919699568782*^9, {3.933919781117552*^9, 3.9339198102042923`*^9}, 
   3.933919882713066*^9, {3.933919943833292*^9, 3.933919951572888*^9}, 
   3.933920004188856*^9, 3.933920107416561*^9, {3.933920201830823*^9, 
   3.93392022537457*^9}, 3.933920258100485*^9, 3.933920343864513*^9, 
   3.933920421528428*^9, 3.933920473229265*^9, 3.933920578955982*^9, {
   3.933920647660254*^9, 3.933920657380004*^9}, 3.9339206952689247`*^9, 
   3.93392079028916*^9, 3.933921177442209*^9, 3.933921214570123*^9, 
   3.9339212458662176`*^9, {3.933921276573933*^9, 3.93392129481119*^9}, 
   3.93392134875428*^9, {3.9339214368741083`*^9, 3.933921455203621*^9}, {
   3.933921878274128*^9, 3.933921903297876*^9}, 3.933921954254926*^9, 
   3.9339220537696037`*^9, 3.933922087351147*^9, 3.933922147861457*^9, 
   3.933922268200555*^9, {3.933922327282453*^9, 3.933922344399807*^9}, {
   3.933922395531685*^9, 3.9339224405799913`*^9}, {3.933922685785295*^9, 
   3.933922704800593*^9}, 3.9339227626011486`*^9, 3.933922828596006*^9, 
   3.933922865770799*^9, 3.933922932078459*^9, 3.933923042865692*^9, 
   3.933923244320567*^9, 3.93392329106692*^9, 3.933923334446946*^9, 
   3.933923402636452*^9, {3.933923576205758*^9, 3.933923597894836*^9}, 
   3.933923781989824*^9, {3.9339238342502117`*^9, 3.933923850142005*^9}, 
   3.933923881712904*^9, 3.933923946260261*^9, 3.933923994048168*^9, {
   3.933924047243856*^9, 3.933924098824136*^9}, {3.933924169137102*^9, 
   3.933924177372635*^9}, 3.933936124831513*^9, 3.933942762661152*^9, {
   3.93394279568764*^9, 3.9339428003176603`*^9}, 3.933943030163054*^9, 
   3.933943076315659*^9, {3.933943155744521*^9, 3.9339431844059668`*^9}, 
   3.9339432393250637`*^9, {3.933943290831739*^9, 3.9339433553221273`*^9}, 
   3.933943460297895*^9, 3.933943495172192*^9, {3.933959099311705*^9, 
   3.933959114695131*^9}, 3.9339591819910307`*^9, 3.933959219955804*^9, 
   3.933959318606521*^9, 3.933959364982352*^9, {3.933959430319045*^9, 
   3.933959491316974*^9}, {3.933996482765983*^9, 3.933996508225358*^9}, {
   3.933996542317891*^9, 3.933996556448373*^9}, 3.933996704785754*^9, 
   3.933996741489249*^9, 3.93399682173739*^9, 3.93548546088989*^9, 
   3.9354863139505*^9, 3.9354863779396567`*^9, 3.935487513210314*^9, 
   3.935487587220757*^9, {3.935487621799477*^9, 3.935487633277811*^9}, 
   3.935488335053338*^9, 3.935488398235867*^9, 3.935488444267528*^9, 
   3.93554502615327*^9, 3.935545129168933*^9, 3.935545373580345*^9, 
   3.935545447041874*^9, 3.935545520837718*^9, {3.935545724142696*^9, 
   3.935545779693371*^9}, 3.9355459851988783`*^9, 3.935546031949313*^9, 
   3.935546073306765*^9, 3.93554612071553*^9, 3.935546154595777*^9, {
   3.9355462312085648`*^9, 3.935546244963451*^9}, 3.93554628344197*^9, {
   3.9355463256710157`*^9, 3.9355464763862667`*^9}, {3.935549087020557*^9, 
   3.935549232551683*^9}, {3.9355492980045433`*^9, 3.935549339253636*^9}, {
   3.935549371586961*^9, 3.935549396359469*^9}, {3.935549428544395*^9, 
   3.935549453764368*^9}, {3.935549490655353*^9, 3.9355495382103233`*^9}, {
   3.935549582294598*^9, 3.935549607624114*^9}, 3.935549637921973*^9, {
   3.935549737299839*^9, 3.935549782550447*^9}, 3.93554982122682*^9, 
   3.935549929458479*^9, 3.935550016916847*^9, {3.935550094144041*^9, 
   3.935550130044713*^9}, 3.935550162647263*^9, {3.935550223916675*^9, 
   3.935550253043428*^9}, 3.9355502917832108`*^9, {3.935550334786324*^9, 
   3.935550355558663*^9}, 3.935550423978838*^9, {3.9355504903796997`*^9, 
   3.935550496911358*^9}, 3.9355505404226418`*^9, 3.935550651063843*^9, {
   3.93555068430879*^9, 3.935550695109069*^9}, 3.935550740544815*^9, {
   3.935550784244273*^9, 3.9355508139549828`*^9}, 3.9355508925622396`*^9, {
   3.9355509328453283`*^9, 3.935550957256585*^9}, {3.935551055366331*^9, 
   3.9355510750436983`*^9}, 3.9355511632634373`*^9, 3.935551310896968*^9, 
   3.935551358172439*^9, 3.935553461911615*^9, 3.937488758957712*^9, 
   3.940306437350896*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"412ae56e-d50c-4fb0-97f4-ff95f2c10346"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load FunKit", "Section",
 CellChangeTimes->{{3.93548548465976*^9, 3.935485499970652*^9}, {
  3.957453666554181*^9, 
  3.9574536704723263`*^9}},ExpressionUUID->"4dc5bed6-6c6a-4d50-aeab-\
1ddf7e9466bf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DiFfRG", "::", "FunKitRequired"}], "=", 
    "\"\<\!\(\*StyleBox[\"DiFfRG\",FontWeight->\"Bold\"]\) requires \
\!\(\*StyleBox[\"FunKit\",FontWeight->\"Bold\"]\) to run.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "@", 
     RowBox[{"PacletFind", "[", "\"\<FunKit\>\"", "]"}]}], "===", "0"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ChoiceDialog", "[", 
       RowBox[{
       "\"\<FunKit does not seem to be installed. Do you want to install \
it?\>\"", ",", 
        RowBox[{"WindowTitle", "->", "\"\<Install TensorBases\>\""}], ",", 
        RowBox[{"WindowSize", "->", 
         RowBox[{"{", 
          RowBox[{"Medium", ",", "All"}], "}"}]}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
      "Import", "[", 
       "\"\<https://raw.githubusercontent.com/satfra/TensorBases/main/\
TensorBasesInstaller.m\>\"", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{"DiFfRG", "::", "FunKitRequired"}], "]"}], ";", 
       RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<FunKit`\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.957453555304262*^9, 3.957453588676355*^9}, {
  3.957453672289105*^9, 
  3.95745376687265*^9}},ExpressionUUID->"b248f05d-2dbc-4846-aac9-\
694723e61de3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", "\"\<DiFfRG`CodeTools`\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.935485596659787*^9, {3.941266610456051*^9, 3.941266613472143*^9}, {
   3.9461106876753387`*^9, 3.946110705945713*^9}, {3.946110755338848*^9, 
   3.946110762582974*^9}, {3.953378202135497*^9, 3.95337820796636*^9}, {
   3.957454703269669*^9, 
   3.9574547063173447`*^9}},ExpressionUUID->"eef75579-ae63-4ec4-a33b-\
b226833913f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Init", "Section",
 CellChangeTimes->{{3.919928560443655*^9, 3.91992856291497*^9}, {
  3.933821623541608*^9, 
  3.933821625001503*^9}},ExpressionUUID->"1acf37e7-e1e9-4f65-abab-\
efb2f0611907"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"BeginPackage", "[", "\"\<DiFfRG`\>\"", "]"}], ";"}], "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Unprotect", "[", "\"\<DiFfRG`*\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Unprotect", "[", "\"\<DiFfRG`Private`*\>\"", "]"}], ";"}], "\n", 
   
   RowBox[{
    RowBox[{"ClearAll", "[", "\"\<DiFfRG`*\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ClearAll", "[", "\"\<DiFfRG`Private`*\>\"", "]"}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.917437823899316*^9, 3.917437865877355*^9}, 
   3.918319540359568*^9, {3.918571376709474*^9, 3.918571381993163*^9}, {
   3.918571723423622*^9, 3.918571759564589*^9}, {3.918572083319786*^9, 
   3.918572109042968*^9}, {3.918572153658847*^9, 3.9185721676824493`*^9}, 
   3.918572256965791*^9, {3.921794881128136*^9, 3.921794894868227*^9}, {
   3.921837555545008*^9, 3.921837572726562*^9}, {3.924145135891276*^9, 
   3.924145141069645*^9}, {3.930796106319742*^9, 3.930796154391613*^9}, {
   3.930796383888001*^9, 3.930796443504225*^9}, 3.9307970905042343`*^9, {
   3.930832616160828*^9, 3.930832657016365*^9}, {3.932041387765153*^9, 
   3.932041402023022*^9}, {3.932623442104257*^9, 3.932623471575926*^9}, 
   3.932817954924417*^9, {3.933260811860936*^9, 3.933260818116788*^9}, {
   3.933260872980472*^9, 3.933260874252234*^9}, 3.933260917997336*^9, {
   3.935485231191088*^9, 3.93548523679556*^9}, {3.935485592500398*^9, 
   3.93548563277157*^9}, 3.93555072749044*^9, 3.943459596337636*^9, 
   3.943465950587963*^9},ExpressionUUID->"0ecf2351-416b-4029-aab2-\
5caad4646302"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exports", "Section",
 CellChangeTimes->{{3.919928560443655*^9, 3.91992856291497*^9}, 
   3.933821631058873*^9},ExpressionUUID->"099d12f8-45f0-4498-861c-\
4146c22241e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetDirectory", "::", "usage"}], "=", 
    "\"\<GetDirectory[]\nReturns the directory in which either the package \
file or notebook is located.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AutoExport", "::", "usage"}], "=", 
    "\"\<AutoExport[]\nTurns on automatic export of the current notebook to a \
.m file.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AutoSaveRestore", "::", "usage"}], "=", 
   "\"\<AutoSaveRestore[fileName_String,expr_]\nEvaluates expr if the file \
fileName does not yet exist and saves it to fileName as a .m file. If \
fileName exists, it does not evaluate expr, but simply loads the \
contents.\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.935485945922835*^9, 3.935486027683341*^9}, {
   3.935486362899207*^9, 3.935486363587503*^9}, {3.9354877229798193`*^9, 
   3.935487860547949*^9}, 
   3.9574548913378057`*^9},ExpressionUUID->"f0438960-5e66-4714-ab13-\
348d02ca9679"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MatsubaraSum", "::", "usage"}], " ", "=", " ", 
   "\"\<MatsubaraSum[expr_,p0_Symbol,T_]\nSums the expression expr over p0, \
with p0 = 2\[Pi]T*n, where n\[Element]\[CapitalZeta].\>\""}], ";"}]], "Input",\

 CellChangeTimes->{{3.93548801132377*^9, 3.9354880677715263`*^9}},
 CellLabel->
  "In[732]:=",ExpressionUUID->"9368b5d6-feeb-454a-8d00-94cd703784f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ResolveChargeConjugation", "::", "usage"}], "=", 
   "\"\<ResolveChargeConjugation[expr_]\nResolves all occurences of \
ChargeConj[i,j] by using the effect of these in Weyl representation.\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9355459120701447`*^9, 3.9355459877501297`*^9}},
 CellLabel->
  "In[733]:=",ExpressionUUID->"b7a9e79b-a6ff-4ce9-a961-d0b7ede31244"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UseSU3GellMannTrace", "::", "usage"}], "=", 
   "\"\<SU3GellMannTrace[value_?BooleanQ,groupName_String:\\\"color\\\"]\n\
Traces the generators of the fundamental representation in the given group as \
SU(3) Gell-Mann matrices explicitly.\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.935485656971459*^9, 3.93548566110763*^9}, {
  3.935485941323501*^9, 3.9354859425166397`*^9}},
 CellLabel->
  "In[734]:=",ExpressionUUID->"e984b499-c21d-4662-82c3-8e51dad58e88"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PreTrace", "::", "usage"}], "=", 
  "\"\<PreTrace[expr_]\nResolve charge conjugation and perform possibly the \
explicit color trace.\>\""}]], "Input",
 CellChangeTimes->{{3.943460274700851*^9, 
  3.9434603076569567`*^9}},ExpressionUUID->"0e042229-5a4f-4fb5-a9d1-\
845b7b27e442"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FormMomentumExpansion", "::", "usage"}], "=", 
  "\"\<FormMomentumExpansion[momenta___]\>\""}], "\[IndentingNewLine]", 
 RowBox[{"FiniteTFormMomentumExpansion", "[", "momenta__", "]"}]}], "Input",
 CellChangeTimes->{{3.9434603228817997`*^9, 
  3.943460340621646*^9}},ExpressionUUID->"af7781f0-142e-49aa-b767-\
d384ba23c0fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MakeP0FormRule", "::", "usage"}], "=", 
  "\"\<MakeP0FormRule[q_,{momenta__},{projections__}]\>\""}], "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetFTSynonym", "::", "usage"}], "=", 
  "\"\<GetFTSynonym[symbol_]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeSPFormRule", "::", "usage"}], "=", 
  "\"\<MakeSPFormRule[q_,p_,momenta__]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeSPFormRule", "::", "usage"}], "=", 
  "\"\<MakeSPFormRule[q_,p_,momenta__]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeSPFiniteTFormRule", "::", "usage"}], "=", 
  "\"\<MakeSPFiniteTFormRule[q_,p_,momenta__]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtendedFormTrace", "::", "usage"}], "=", 
   "\"\<ExtendedFormTrace[expr_,disentangle:_?BooleanQ:True,preRepRules_List:{\
},postRepRules_List:{}]\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SeparateScalarProductsFiniteT", "::", "usage"}], "=", 
  "\"\<SeparateScalarProductsFiniteT[expr_]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandScalarProductsFiniteT", "::", "usage"}], "=", 
  "\"\<ExpandScalarProductsFiniteT[expr_]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandScalarProducts", "::", "usage"}], "=", 
  "\"\<ExpandScalarProducts[expr_]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyAllMomenta", "::", "usage"}], "=", 
  "\"\<SimplifyAllMomenta[q_,expr_]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProjectToSymmetricPoint", "::", "usage"}], "=", 
  "\"\<ProjectToSymmetricPoint[expr_,q_Symbol,p_Symbol,momenta___Symbol]\>\""}\
], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjectToSymmetricPointFiniteT", "::", "usage"}], "=", 
   "\"\<ProjectToSymmetricPointFiniteT[expr_,q_Symbol,p_Symbol,momenta___\
Symbol]\>\""}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QuickSimplify", "::", "usage"}], "=", 
  "\"\<QuickSimplify[expr_]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetStandardQuickSimplify", "::", "usage"}], "=", 
  "\"\<SetStandardQuickSimplify[sim_]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetStandardSimplify", "::", "usage"}], "=", 
   "\"\<SetStandardSimplify[sim_]\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDisentangle", "::", "usage"}], "=", 
  "\"\<SetDisentangle[ex_]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SumDiagrams", "::", "usage"}], "=", 
   "\"\<SumDiagrams[nKernels_Integer,postfix_String,number_Integer:0,\
operation_:$StandardQuickSimplify,saveName_String:\\\"sum\\\"]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TraceDiagrams", "::", "usage"}], "=", 
  "\"\<TraceDiagrams[simpFunc_,nKernels_Integer,postfix_String,ex_,\
preRepRules_List:{},postRepRules_List:{}]\>\""}]}], "Input",
 CellChangeTimes->{{3.943460370321447*^9, 
  3.943460621228345*^9}},ExpressionUUID->"0b416ff5-f4df-4493-8255-\
266f3e2d1fc1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Begin  Private", "Section",
 CellChangeTimes->{{3.933821636751761*^9, 
  3.933821641378183*^9}},ExpressionUUID->"d9e7f4e0-bee1-441c-9357-\
518ec0e70346"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.943460179089211*^9, 3.9434601860273657`*^9}, 
   3.943465955808702*^9},ExpressionUUID->"d3d9ecf5-81b9-41a4-ba9e-\
d222237bb21d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utility", "Chapter",
 CellChangeTimes->{{3.918572239959745*^9, 3.91857224113597*^9}, {
  3.935485845098998*^9, 
  3.93548584801917*^9}},ExpressionUUID->"d2b37a69-1798-45aa-ba74-\
ac366e35523f"],

Cell["Some logic for getting Directories etc also from scripts", "Text",
 CellChangeTimes->{{3.921272563157929*^9, 
  3.9212725782034907`*^9}},ExpressionUUID->"ad5cdf87-2437-494b-bacf-\
1d106e594491"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "GetDirectory", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetDirectory", "[", "]"}], ":=", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{"$Notebooks", ",", 
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      RowBox[{"Directory", "[", "]"}]}], "]"}], "<>", "\"\</\>\""}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9354875664513702`*^9, 3.935487578643756*^9}, 
   3.935487643211999*^9},
 CellLabel->
  "In[735]:=",ExpressionUUID->"bd12fd7b-1c57-476f-b00d-ba3c6dae4d82"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AutoExport", "[", 
    RowBox[{"Switch", ":", 
     RowBox[{"_", "?", "BooleanQ"}], ":", "True"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{"Switch", ",", "\[IndentingNewLine]", 
     RowBox[{"SetOptions", "[", 
      RowBox[{
       RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AutoGeneratedPackage", "->", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"InitializationCellEvaluation", "->", "False"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"InitializationCellWarning", "->", "False"}], ",", 
         RowBox[{"StyleDefinitions", "->", 
          RowBox[{"Notebook", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cell", "[", 
               RowBox[{"StyleData", "[", 
                RowBox[{"StyleDefinitions", "->", "\"\<Default.nb\>\""}], 
                "]"}], "]"}], ",", 
              RowBox[{"Cell", "[", 
               RowBox[{
                RowBox[{"StyleData", "[", "\"\<Input\>\"", "]"}], ",", 
                RowBox[{"InitializationCell", "->", "True"}]}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"Visible", "->", "False"}], ",", 
            RowBox[{
            "StyleDefinitions", "->", 
             "\"\<PrivateStylesheetFormatting.nb\>\""}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"SetOptions", "[", 
      RowBox[{
       RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"AutoGeneratedPackage", "->", "False"}], 
        "\[IndentingNewLine]", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.921272580327087*^9, 3.921272598667559*^9}, 
   3.921272782261088*^9, {3.921273693200805*^9, 3.921273696807189*^9}, {
   3.921278866810248*^9, 3.9212788774136553`*^9}, {3.921627757454508*^9, 
   3.92162776156532*^9}, {3.935486039658905*^9, 3.935486083483676*^9}, {
   3.935486256659657*^9, 3.935486305299963*^9}, {3.935487557444902*^9, 
   3.935487559948284*^9}, 3.935487612756431*^9},
 CellLabel->
  "In[737]:=",ExpressionUUID->"045d2a29-83b2-45f3-9096-804f8428948f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AutoSaveRestore", "[", 
    RowBox[{"fileName_String", ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ret", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", 
         RowBox[{"fileName", "<>", "\"\<.m\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ret", "=", 
          RowBox[{"Import", "[", 
           RowBox[{"fileName", "<>", "\"\<.m\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Imported existing file \\\"\>\"", "<>", "fileName", "<>", 
           "\"\<.m\>\"", "<>", "\"\<\\\"...\>\""}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ret", "=", 
          RowBox[{"ReleaseHold", "[", "expr", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"fileName", "<>", "\"\<.m\>\""}], ",", "ret"}], "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Saved to file \\\"\>\"", "<>", "fileName", "<>", "\"\<.m\>\"", 
           "<>", "\"\<\\\"...\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "ret"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"AutoSaveRestore", ",", "HoldRest"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.92161756638931*^9, 3.921617597568625*^9}, {
   3.921617751038447*^9, 3.921617778065596*^9}, {3.921617826311932*^9, 
   3.92161786030626*^9}, {3.921617900090035*^9, 3.921618104085333*^9}, {
   3.921618225845419*^9, 3.921618230541135*^9}, {3.921618266747978*^9, 
   3.921618272085401*^9}, {3.921618319712352*^9, 3.921618415917267*^9}, {
   3.921627184815353*^9, 3.921627201480587*^9}, 3.921627645726943*^9, {
   3.921627710605625*^9, 3.921627712159439*^9}, {3.927114779822678*^9, 
   3.92711480650231*^9}, {3.957455176693125*^9, 
   3.957455177688694*^9}},ExpressionUUID->"2249301c-6588-4290-93cc-\
6173e59d7027"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matsubara sums", "Chapter",
 CellChangeTimes->{{3.930795711602098*^9, 3.930795716861533*^9}, {
  3.935488110604851*^9, 
  3.935488119875801*^9}},ExpressionUUID->"4db05b9d-0e6c-46c1-8bc4-\
444d96782a81"],

Cell["\<\
Explicit summation of Matsubara sums is possible (but perhaps not recommended \
always.)\
\>", "Text",ExpressionUUID->"f39e01f0-a434-46ca-b8c9-036dc7d8a61d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MatsubaraSum", "[", 
    RowBox[{"expr_", ",", "p0_Symbol", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "denom", ",", "poles", ",", "residues", ",", "n", ",", "r", ",", 
       "SumB"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "expr", "]"}], "==", "Plus"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"Total", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"MatsubaraSum", "[", 
                RowBox[{"#", ",", "p0", ",", "T"}], "]"}], "&"}], ",", 
              RowBox[{"List", "@@", "expr"}]}], "]"}], ",", "1"}], "]"}], 
          "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"denom", " ", "=", " ", 
       RowBox[{
        RowBox[{"Denominator", "[", "expr", "]"}], "//", 
        RowBox[{
         RowBox[{"Collect", "[", 
          RowBox[{"#", ",", "p0"}], "]"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"poles", " ", "=", " ", 
       RowBox[{"p0", "/.", 
        RowBox[{"{", 
         RowBox[{"ToRules", "[", 
          RowBox[{"Reduce", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Reduce", "[", 
              RowBox[{
               RowBox[{"denom", "==", "0"}], ",", "p0"}], "]"}], "//", 
             "FullSimplify"}], ",", "p0"}], "]"}], "]"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"poles", " ", "=", " ", 
       RowBox[{"Assuming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"T", ">", "0"}], "&&", 
          RowBox[{"_Symbol", "\[Element]", "Reals"}]}], ",", 
         RowBox[{"poles", "//", "FullSimplify"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"residues", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"n", "=", "1"}], ",", 
        RowBox[{"n", "<=", 
         RowBox[{"Length", "[", "poles", "]"}]}], ",", 
        RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{"Residue", "[", 
            RowBox[{
             RowBox[{"expr", " ", 
              RowBox[{"Coth", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"I", " ", "p0"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"2", "T"}], ")"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p0", ",", 
               RowBox[{"poles", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"residues", ",", "r"}], "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SumB", "=", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "I"}], ")"}]}], " ", "residues"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Total", "[", "SumB", "]"}]}]}], "\n", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FermionMatsubaraSum", "[", 
    RowBox[{"expr_", ",", "p0_Symbol", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "denom", ",", "poles", ",", "residues", ",", "n", ",", "r", ",", 
       "SumB"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "expr", "]"}], "==", "Plus"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"Total", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"MatsubaraSum", "[", 
                RowBox[{"#", ",", "p0", ",", "T"}], "]"}], "&"}], ",", 
              RowBox[{"List", "@@", "expr"}]}], "]"}], ",", "1"}], "]"}], 
          "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"denom", " ", "=", " ", 
       RowBox[{
        RowBox[{"Denominator", "[", "expr", "]"}], "//", 
        RowBox[{
         RowBox[{"Collect", "[", 
          RowBox[{"#", ",", "p0"}], "]"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"poles", " ", "=", " ", 
       RowBox[{"p0", "/.", 
        RowBox[{"{", 
         RowBox[{"ToRules", "[", 
          RowBox[{"Reduce", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Reduce", "[", 
              RowBox[{
               RowBox[{"denom", "==", "0"}], ",", "p0"}], "]"}], "//", 
             "FullSimplify"}], ",", "p0"}], "]"}], "]"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"poles", " ", "=", " ", 
       RowBox[{"Assuming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"T", ">", "0"}], "&&", 
          RowBox[{"_Symbol", "\[Element]", "Reals"}]}], ",", 
         RowBox[{"poles", "//", "FullSimplify"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"residues", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"n", "=", "1"}], ",", 
        RowBox[{"n", "<=", 
         RowBox[{"Length", "[", "poles", "]"}]}], ",", 
        RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{"Residue", "[", 
            RowBox[{
             RowBox[{"expr", " ", 
              RowBox[{"Tanh", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"I", " ", "p0"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"2", "T"}], ")"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p0", ",", 
               RowBox[{"poles", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"residues", ",", "r"}], "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SumB", "=", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "I"}], ")"}]}], " ", "residues"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Total", "[", "SumB", "]"}]}]}], "\n", "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{
  3.916559431731933*^9, {3.933650791190683*^9, 3.9336511744864397`*^9}, {
   3.933651223735318*^9, 3.933651455706583*^9}, {3.933651512418861*^9, 
   3.9336515129980993`*^9}, {3.933651557532131*^9, 3.933651967961319*^9}, {
   3.93365206886823*^9, 3.933652271745182*^9}, {3.935485777724496*^9, 
   3.935485797092594*^9}, {3.935487996565898*^9, 3.935488004247981*^9}, 
   3.9423966083226013`*^9, {3.943356604914905*^9, 3.9433566116260633`*^9}, {
   3.9464495110305023`*^9, 3.946449511353907*^9}, {3.946454519057282*^9, 
   3.946454524769248*^9}, 3.946454575226282*^9, 3.946454608194537*^9, {
   3.9606214778156357`*^9, 3.960621554650626*^9}, {3.960621591720636*^9, 
   3.960621618083025*^9}, {3.960621659628271*^9, 3.9606216628466587`*^9}, {
   3.960621943163912*^9, 
   3.9606219547268887`*^9}},ExpressionUUID->"7960f290-05bc-46c9-9e8a-\
e030620c84a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tracing  Algorithms", "Chapter",
 CellChangeTimes->{{3.930795711602098*^9, 
  3.930795716861533*^9}},ExpressionUUID->"f5ab99e5-bf40-4be4-99bc-\
a45c18eb6844"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InsertOutputNaming", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "groups", ",", "\[IndentingNewLine]", "outputRulesLorentzTensors", ",", 
       "outputRulesGroupTensors", ",", "outputRules", ",", 
       "\[IndentingNewLine]", "privateOutputRulesLorentzTensors", ",", 
       "privateOutputRulesGroupTensors", ",", "privateOutputRules", ",", 
       "\[IndentingNewLine]", "otherRules"}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"outputRulesLorentzTensors", "=", 
       RowBox[{
        RowBox[{
        "Normal", "[", 
         "FormTracer`Private`lorentzTensorReplacementRulesOutput", "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a_", "[", "c___", "]"}], ":>", "b_"}], ")"}], ":>", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Symbol", "[", 
              RowBox[{"\"\<TB\>\"", "~~", 
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "a", "]"}], ",", "\"\<FTx\>\""}], 
                 "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "[", "c", "]"}], ":>",
             "b"}], ")"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"outputRulesGroupTensors", "=", 
       RowBox[{
        RowBox[{
        "Normal", "[", "FormTracer`Private`groupTensorReplacementRulesOutput",
          "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a_", "[", "c___", "]"}], ":>", "b_"}], ")"}], ":>", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Symbol", "[", 
              RowBox[{"\"\<TB\>\"", "~~", 
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "a", "]"}], ",", "\"\<FTx\>\""}], 
                 "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "[", "c", "]"}], ":>",
             "b"}], ")"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"outputRules", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"outputRulesLorentzTensors", ",", "outputRulesGroupTensors"}],
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"expr", "//.", "outputRules"}], "]"}], "\[IndentingNewLine]", 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.933833876764284*^9, 3.9338339413967957`*^9}, {
   3.933833972229079*^9, 3.933834167020243*^9}, {3.9338342153726*^9, 
   3.9338342157806687`*^9}, {3.933837489957266*^9, 3.933837550765798*^9}, {
   3.9338382714222393`*^9, 3.9338383352946167`*^9}, {3.933840614470008*^9, 
   3.93384070635058*^9}, {3.933840866422611*^9, 3.933840883375325*^9}, {
   3.933840987407135*^9, 3.933841035854702*^9}, {3.9338411904790173`*^9, 
   3.9338412314069366`*^9}, {3.933841270479463*^9, 3.933841274599712*^9}, {
   3.933841364087409*^9, 3.933841366040209*^9}, {3.933841755976303*^9, 
   3.933841760695524*^9}, {3.933843628016041*^9, 3.933843641392967*^9}, {
   3.933846047264516*^9, 3.933846051232049*^9}, {3.933920097856282*^9, 
   3.933920104627795*^9}, {3.933920161842093*^9, 3.933920165476227*^9}, {
   3.933920682476841*^9, 3.933920691609529*^9}, {3.9339223784964547`*^9, 
   3.933922378860069*^9}, {3.935545326143215*^9, 3.9355453407197037`*^9}, {
   3.935545711143091*^9, 3.9355457149595757`*^9}, 3.935545749159793*^9, {
   3.935546098222186*^9, 3.9355461129366617`*^9}, 3.935546152576734*^9, {
   3.935546209151682*^9, 3.935546227566567*^9}, {3.9355492085184298`*^9, 
   3.935549229786601*^9}, 3.935549634622649*^9, {3.935549719558695*^9, 
   3.935549735077989*^9}, 3.935549780502384*^9, 3.935550538158867*^9, 
   3.935550627935109*^9, 3.9355507823837233`*^9, {3.93555088250336*^9, 
   3.9355508904789352`*^9}, {3.935551019830585*^9, 3.9355510250389423`*^9}},
 CellLabel->
  "In[744]:=",ExpressionUUID->"6f9d9584-8426-4353-ba5b-d7eb6fd0cc66"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InsertInputNaming", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"inputRulesLorentzTensors", ",", "inputRulesGroupTensors"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"inputRulesLorentzTensors", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{
          "Normal", "[", 
           "FormTracer`Private`lorentzTensorReplacementRulesInput", "]"}], 
          ",", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"_", "[", "__", "]"}], ":>", 
            RowBox[{"_", "[", "__", "]"}]}], "]"}]}], "]"}], "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a_", "[", "d__", "]"}], ":>", 
            RowBox[{"b_", "[", "c__", "]"}]}], ")"}], ":>", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", "[", "d", "]"}], "->", 
            RowBox[{
             RowBox[{"Symbol", "[", 
              RowBox[{"\"\<TB\>\"", "~~", 
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "b", "]"}], ",", "\"\<FTx\>\""}], 
                 "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "[", "c", "]"}]}],
            ")"}]}], "\[IndentingNewLine]", "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inputRulesGroupTensors", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{
          "Normal", "[", 
           "FormTracer`Private`groupTensorReplacementRulesInput", "]"}], ",", 
          
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"_", "[", "__", "]"}], ":>", 
            RowBox[{"_", "[", "__", "]"}]}], "]"}]}], "]"}], "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a_", "[", "d__", "]"}], ":>", 
            RowBox[{"b_", "[", "c__", "]"}]}], ")"}], ":>", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", "[", "d", "]"}], "->", 
            RowBox[{
             RowBox[{"Symbol", "[", 
              RowBox[{"\"\<TB\>\"", "~~", 
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "b", "]"}], ",", "\"\<FTx\>\""}], 
                 "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "[", "c", "]"}]}],
            ")"}]}], "\[IndentingNewLine]", "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"expr", "//.", "inputRulesLorentzTensors"}], "//.", 
         "inputRulesGroupTensors"}], "/.", 
        RowBox[{"a_Symbol", ":>", 
         RowBox[{"Symbol", "[", 
          RowBox[{"\"\<Global`\>\"", "~~", 
           RowBox[{"SymbolName", "[", "a", "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.933857165667118*^9, 3.933857182796328*^9}, {
  3.933858230693149*^9, 3.933858266931025*^9}, {3.93391992643932*^9, 
  3.93391994147192*^9}, {3.93392021451739*^9, 3.933920214657308*^9}, {
  3.933924042195753*^9, 3.933924042540813*^9}, {3.935545759415051*^9, 
  3.935545776143876*^9}, {3.9355497630308723`*^9, 3.9355497730460443`*^9}},
 CellLabel->
  "In[745]:=",ExpressionUUID->"55d7a86d-c906-48bd-a3bf-992b994560a1"],

Cell[CellGroupData[{

Cell["Charge  Conjugators", "Subsection",
 CellChangeTimes->{{3.930795742637045*^9, 
  3.9307957460108232`*^9}},ExpressionUUID->"12b52e25-a4c7-4a18-be0b-\
c15de07921b6"],

Cell["\<\
In order to be able to deal with charge conjugation operators, define some \
rules for that, too\
\>", "Text",
 CellChangeTimes->{{3.921794048176723*^9, 
  3.92179406483173*^9}},ExpressionUUID->"3361abb5-df92-442c-b140-\
951784d155e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ImplodeTerms", "[", "expr_", "]"}], ":=", "expr"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImplodeTerms", "[", "expr_List", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ret", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"expr", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "List"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Plus", "@@", 
        RowBox[{"Map", "[", 
         RowBox[{"ImplodeTerms", ",", "expr"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Times", "@@", 
        RowBox[{"Map", "[", 
         RowBox[{"ImplodeTerms", ",", "expr"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CollapseTerms", "[", "expr_", "]"}], ":=", "expr"}], ";"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CollapseTerms", "[", "expr_List", "]"}], ":=", 
    RowBox[{"Total", "[", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"CollapseTerms", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}], ",", "expr"}], 
      "]"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FixChargeConj", "[", "expr_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ret", ",", "restoreIdx", ",", "rule", ",", "chargeRules"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "Print", "}"}], ",", 
         RowBox[{"DisentangleLorentzStructures", "[", "False", "]"}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"ret", "=", "expr"}], ";", "\[IndentingNewLine]", 
       RowBox[{"restoreIdx", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ret", "=", 
        RowBox[{"ret", "//.", 
         RowBox[{
          RowBox[{"ChargeConj", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{
             RowBox[{"restoreIdx", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"restoreIdx", ",", 
                RowBox[{"{", 
                 RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}], ";", 
             RowBox[{"InsertOutputNaming", "[", 
              RowBox[{"TBdeltaDirac", "[", 
               RowBox[{"a", ",", "b"}], "]"}], "]"}]}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rule", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"InsertOutputNaming", "[", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ":>", 
            RowBox[{"ChargeConj", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}], ",", 
          "restoreIdx"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ret", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"FormTracer`ExpandTerms", "[", "ret", "]"}], "//.", 
           "rule"}], "//", "Expand"}], "//", "InsertOutputNaming"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"chargeRules", "=", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"TBgamma", "[", 
              RowBox[{"mu_", ",", "a_", ",", "c_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], ":>", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"ChargeConj", "[", 
               RowBox[{"c", ",", "a"}], "]"}]}], 
             RowBox[{"TBgamma", "[", 
              RowBox[{"mu", ",", "a", ",", "b"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"TBgamma", "[", 
              RowBox[{"mu_", ",", "a_", ",", "b_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"b_", ",", "c_"}], "]"}]}], ":>", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"ChargeConj", "[", 
               RowBox[{"a", ",", "b"}], "]"}]}], 
             RowBox[{"TBgamma", "[", 
              RowBox[{"mu", ",", "c", ",", "b"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"TBgamma5", "[", 
              RowBox[{"a_", ",", "c_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], ":>", 
            RowBox[{
             RowBox[{"ChargeConj", "[", 
              RowBox[{"c", ",", "a"}], "]"}], 
             RowBox[{"TBgamma5", "[", 
              RowBox[{"a", ",", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{
             RowBox[{"TBgamma5", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"b_", ",", "c_"}], "]"}]}], ":>", 
            RowBox[{
             RowBox[{"ChargeConj", "[", 
              RowBox[{"a", ",", "b"}], "]"}], 
             RowBox[{"TBgamma5", "[", 
              RowBox[{"c", ",", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"b_", ",", "c_"}], "]"}]}], ":>", 
            RowBox[{"ChargeConj", "[", 
             RowBox[{"a", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"c_", ",", "b_"}], "]"}]}], ":>", 
            RowBox[{"ChargeConj", "[", 
             RowBox[{"c", ",", "a"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"b_", ",", "a_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"b_", ",", "c_"}], "]"}]}], ":>", 
            RowBox[{"ChargeConj", "[", 
             RowBox[{"a", ",", "c"}], "]"}]}], ",", 
           StyleBox["\[IndentingNewLine]",
            FontSize->12], 
           StyleBox["\[IndentingNewLine]",
            FontSize->12], 
           RowBox[{
            RowBox[{
             RowBox[{"ChargeConj", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"a_", ",", "c_"}], "]"}]}], ":>", 
            RowBox[{"deltaDirac", "[", 
             RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ChargeConj", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"c_", ",", "b_"}], "]"}]}], ":>", 
            RowBox[{"deltaDirac", "[", 
             RowBox[{"a", ",", "c"}], "]"}]}], ",", 
           StyleBox["\[IndentingNewLine]",
            FontSize->12], 
           RowBox[{
            RowBox[{
             RowBox[{"ChargeConj", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}], 
             RowBox[{"ChargeConj", "[", 
              RowBox[{"b_", ",", "c_"}], "]"}]}], ":>", 
            RowBox[{"-", 
             RowBox[{"deltaDirac", "[", 
              RowBox[{"a", ",", "c"}], "]"}]}]}]}], "\[IndentingNewLine]", 
          "}"}], "//", "InsertOutputNaming"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ret", "=", 
        RowBox[{"ret", "//.", "chargeRules"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "This", " ", "is", " ", "chiral", " ", "Weyl", " ", 
          "representation"}], "-", 
         RowBox[{"specific", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ret", "=", 
        RowBox[{"ret", "//.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ChargeConj", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", "dint", "}"}], ",", 
             RowBox[{
              RowBox[{"TBgamma", "[", 
               RowBox[{"2", ",", "a", ",", "dint"}], "]"}], 
              RowBox[{"TBgamma", "[", 
               RowBox[{"0", ",", "dint", ",", "b"}], "]"}]}]}], "]"}]}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"ImplodeTerms", "[", "ret", "]"}], "//", 
         "InsertOutputNaming"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResolveChargeConjugation", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"expr", ",", 
         RowBox[{"ChargeConj", "[", "__", "]"}], ",", "Infinity"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"expr", "//", "FixChargeConj"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", "expr"}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.921794071700576*^9, 3.921794078742909*^9}, 
   3.921794748930499*^9, {3.9217953410135736`*^9, 3.921795345199584*^9}, {
   3.921795394064973*^9, 3.921795406322345*^9}, {3.921795474089506*^9, 
   3.9217954892319393`*^9}, {3.921796259545465*^9, 3.9217965340971613`*^9}, {
   3.921809400511046*^9, 3.9218094009374237`*^9}, {3.921809477751204*^9, 
   3.921809521144747*^9}, {3.921819777036787*^9, 3.921819784449296*^9}, {
   3.921821062561872*^9, 3.92182106646638*^9}, {3.92182111216293*^9, 
   3.921821142268581*^9}, {3.92183296636515*^9, 3.921833093800383*^9}, 
   3.921833138589645*^9, {3.921840334232685*^9, 3.921840395978014*^9}, {
   3.921841263336787*^9, 3.92184137957843*^9}, {3.921841417246993*^9, 
   3.921841430346073*^9}, {3.92184152286499*^9, 3.9218415322880793`*^9}, {
   3.92184304761236*^9, 3.921843134797408*^9}, {3.92184346299809*^9, 
   3.921843466579792*^9}, {3.921843513268523*^9, 3.921843650662134*^9}, {
   3.9218763686887407`*^9, 3.921876373095786*^9}, {3.921876779896566*^9, 
   3.921876843672817*^9}, {3.921876892158286*^9, 3.921876895208795*^9}, 
   3.921876999005419*^9, {3.921877422185878*^9, 3.921877423113919*^9}, {
   3.921877504351458*^9, 3.9218775200930777`*^9}, {3.921879408878263*^9, 
   3.921879432364671*^9}, {3.921879519947568*^9, 3.9218795262589903`*^9}, {
   3.921879625224653*^9, 3.921879629204245*^9}, {3.9218797062372713`*^9, 
   3.921879717424675*^9}, {3.921879860274888*^9, 3.921879883560752*^9}, {
   3.921879961988386*^9, 3.921879965595957*^9}, {3.921922289271458*^9, 
   3.921922295550026*^9}, {3.922000589516585*^9, 3.922000605735109*^9}, 
   3.92200115042592*^9, {3.922087759206943*^9, 3.922087770942597*^9}, {
   3.922094591637645*^9, 3.922094626680778*^9}, {3.922098049229426*^9, 
   3.922098130631744*^9}, {3.922133397577361*^9, 3.922133455909011*^9}, {
   3.922134103246302*^9, 3.922134191123559*^9}, {3.922134359824643*^9, 
   3.922134371815893*^9}, {3.92217410261769*^9, 3.9221741082647676`*^9}, {
   3.922174171497924*^9, 3.922174177609129*^9}, {3.922174208189384*^9, 
   3.922174209885378*^9}, {3.922181824781329*^9, 3.9221818252646112`*^9}, {
   3.922181871725789*^9, 3.922181935269558*^9}, {3.922183173695031*^9, 
   3.9221832120547857`*^9}, {3.922186286928891*^9, 3.922186311794375*^9}, 
   3.922188616860355*^9, {3.922188712993352*^9, 3.922188723533478*^9}, 
   3.930798963984124*^9, 3.930799184470267*^9, {3.930799964413578*^9, 
   3.9307999952265863`*^9}, {3.930800067610096*^9, 3.930800071653378*^9}, {
   3.930800167112943*^9, 3.930800211257351*^9}, 3.930800250437738*^9, {
   3.930800407514114*^9, 3.930800412349681*^9}, {3.930800833532151*^9, 
   3.930800854324721*^9}, 3.930800887153798*^9, {3.930824118807762*^9, 
   3.930824120172369*^9}, {3.935488145303643*^9, 3.935488155766289*^9}, {
   3.9354882064340277`*^9, 3.935488258821485*^9}, {3.935488309302096*^9, 
   3.9354883246069183`*^9}, {3.9354883929417267`*^9, 3.935488394909334*^9}, {
   3.935488438285787*^9, 3.9354884579176617`*^9}, {3.935545101639827*^9, 
   3.935545108975294*^9}, {3.9355451462241592`*^9, 3.9355451505756903`*^9}, {
   3.9355453974719667`*^9, 3.9355454302876863`*^9}, {3.935545472728133*^9, 
   3.935545473344078*^9}, {3.935545851775097*^9, 3.935545863599102*^9}, {
   3.9355460139593887`*^9, 3.935546029462945*^9}, {3.935546277343554*^9, 
   3.935546460599592*^9}, {3.935549078101664*^9, 3.935549184669874*^9}, {
   3.935549288799494*^9, 3.935549606023324*^9}, {3.935549807231414*^9, 
   3.935549816527628*^9}, {3.93554988225564*^9, 3.935549925646707*^9}, {
   3.935550010087902*^9, 3.935550014895858*^9}, {3.935550416392407*^9, 
   3.935550421311531*^9}, 3.9355504884395514`*^9, {3.935550755464168*^9, 
   3.9355507556713037`*^9}, {3.935550794144079*^9, 3.935550811543816*^9}, {
   3.935550924167426*^9, 3.9355509555042458`*^9}, {3.935551047760272*^9, 
   3.935551053560011*^9}, {3.935551155063036*^9, 3.935551160990932*^9}, {
   3.9355522549291773`*^9, 3.935552307785432*^9}, 3.935552357727501*^9, {
   3.9412668681749763`*^9, 3.941266906476533*^9}, {3.9412669736573973`*^9, 
   3.9412670558885803`*^9}, {3.941267117430084*^9, 3.941267183473654*^9}, {
   3.941267445601304*^9, 3.941267476560678*^9}, {3.9412675643536377`*^9, 
   3.9412676781191263`*^9}, {3.941267718764599*^9, 3.941267891894619*^9}, {
   3.9412686230367947`*^9, 3.941268653569624*^9}, 3.941269674982795*^9, {
   3.941280972816123*^9, 
   3.941280982734414*^9}},ExpressionUUID->"f4637967-a96d-48f9-b7db-\
410a0759650a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"integrateDeltas", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"list1", ",", "list2", ",", 
       RowBox[{"conv", "=", "InsertOutputNaming"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"list1", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], 
            RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
             RowBox[{"a_", ",", "c_"}], "]"}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaLorentz", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaLorentz", "[", 
              RowBox[{"a_", ",", "c_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaLorentz", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], 
            RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
             RowBox[{"c_", ",", "a_"}], "]"}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaLorentz", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaLorentz", "[", 
              RowBox[{"c_", ",", "a_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaLorentz", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
             RowBox[{"b_", ",", "a_"}], "]"}], 
            RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
             RowBox[{"a_", ",", "c_"}], "]"}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaLorentz", "[", 
              RowBox[{"b_", ",", "a_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaLorentz", "[", 
              RowBox[{"a_", ",", "c_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaLorentz", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
             RowBox[{"b_", ",", "a_"}], "]"}], 
            RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
             RowBox[{"c_", ",", "a_"}], "]"}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaLorentz", "[", 
              RowBox[{"b_", ",", "a_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaLorentz", "[", 
              RowBox[{"c_", ",", "a_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaLorentz", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FormTracer`Private`FTxdeltaLorentz", "[", 
           RowBox[{"a_", ",", "a_"}], "]"}], ":>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NumberQ", "[", "a", "]"}], ",", "1", ",", "4"}], "]"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaLorentz", "[", 
            RowBox[{"a_", ",", "a_"}], "]"}]}], ":>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NumberQ", "[", "a", "]"}], ",", "1", ",", "4"}], "]"}]}],
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBvec", "[", 
             RowBox[{"p_", ",", "a_"}], "]"}]}], 
           RowBox[{"conv", "@", 
            RowBox[{"TBdeltaLorentz", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}]}], 
           RowBox[{"conv", "@", 
            RowBox[{"TBvec", "[", 
             RowBox[{"q_", ",", "b_"}], "]"}]}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBsp", "[", 
            RowBox[{"p", ",", "q"}], "]"}]}]}], " ", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBvec", "[", 
             RowBox[{"p_", ",", "a_"}], "]"}]}], 
           RowBox[{"conv", "@", 
            RowBox[{"TBdeltaLorentz", "[", 
             RowBox[{"b_", ",", "a_"}], "]"}]}], 
           RowBox[{"conv", "@", 
            RowBox[{"TBvec", "[", 
             RowBox[{"q_", ",", "b_"}], "]"}]}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBsp", "[", 
            RowBox[{"p", ",", "q"}], "]"}]}]}], " ", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBvecs", "[", 
             RowBox[{"p_", ",", "a_"}], "]"}]}], 
           RowBox[{"conv", "@", 
            RowBox[{"TBdeltaLorentz", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}]}], 
           RowBox[{"conv", "@", 
            RowBox[{"TBvecs", "[", 
             RowBox[{"q_", ",", "b_"}], "]"}]}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBsps", "[", 
            RowBox[{"p", ",", "q"}], "]"}]}]}], " ", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBvecs", "[", 
             RowBox[{"p_", ",", "a_"}], "]"}]}], 
           RowBox[{"conv", "@", 
            RowBox[{"TBdeltaLorentz", "[", 
             RowBox[{"b_", ",", "a_"}], "]"}]}], 
           RowBox[{"conv", "@", 
            RowBox[{"TBvecs", "[", 
             RowBox[{"q_", ",", "b_"}], "]"}]}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBsps", "[", 
            RowBox[{"p", ",", "q"}], "]"}]}]}]}], " ", "\[IndentingNewLine]", 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"list2", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], 
            RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
             RowBox[{"a_", ",", "c_"}], "]"}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "c_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaDirac", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], 
            RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
             RowBox[{"c_", ",", "a_"}], "]"}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"c_", ",", "a_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaDirac", "[", 
            RowBox[{"c", ",", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
             RowBox[{"b_", ",", "a_"}], "]"}], 
            RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
             RowBox[{"a_", ",", "c_"}], "]"}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"b_", ",", "a_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "c_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaDirac", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
             RowBox[{"b_", ",", "a_"}], "]"}], 
            RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
             RowBox[{"c_", ",", "a_"}], "]"}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"b_", ",", "a_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"c_", ",", "a_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaDirac", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FormTracer`Private`FTxdeltaDirac", "[", 
           RowBox[{"a_", ",", "a_"}], "]"}], ":>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NumberQ", "[", "a", "]"}], ",", "1", ",", "4"}], "]"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"conv", "@", 
           RowBox[{"TBdeltaDirac", "[", 
            RowBox[{"a_", ",", "a_"}], "]"}]}], ":>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NumberQ", "[", "a", "]"}], ",", "1", ",", "4"}], "]"}]}],
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"b_", ",", "a_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBgamma", "[", 
              RowBox[{"mu_", ",", "c_", ",", "a_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBgamma", "[", 
            RowBox[{"mu", ",", "c", ",", "b"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBgamma", "[", 
              RowBox[{"mu_", ",", "c_", ",", "a_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBgamma", "[", 
            RowBox[{"mu", ",", "c", ",", "b"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"b_", ",", "a_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBgamma", "[", 
              RowBox[{"mu_", ",", "a_", ",", "c_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBgamma", "[", 
            RowBox[{"mu", ",", "b", ",", "c"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBgamma", "[", 
              RowBox[{"mu_", ",", "a_", ",", "c_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBgamma", "[", 
            RowBox[{"mu", ",", "b", ",", "c"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"b_", ",", "a_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBgamma5", "[", 
              RowBox[{"c_", ",", "a_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBgamma5", "[", 
            RowBox[{"c", ",", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBgamma5", "[", 
              RowBox[{"c_", ",", "a_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBgamma5", "[", 
            RowBox[{"c", ",", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"b_", ",", "a_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBgamma5", "[", 
              RowBox[{"a_", ",", "c_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBgamma5", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"conv", "@", 
             RowBox[{"TBdeltaDirac", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBgamma5", "[", 
              RowBox[{"a_", ",", "c_"}], "]"}]}]}], "/;", 
           RowBox[{"Not", "[", 
            RowBox[{"NumberQ", "[", "a", "]"}], "]"}]}], ":>", 
          RowBox[{"conv", "@", 
           RowBox[{"TBgamma5", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}]}]}], "\[IndentingNewLine]", 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"expr", "//.", "list1"}], "//.", "list2"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.930823507745618*^9, 3.930823624730839*^9}, {
   3.930823672166363*^9, 3.930823674401813*^9}, {3.930823716357353*^9, 
   3.930823729578874*^9}, {3.930824067213314*^9, 3.930824107286553*^9}, {
   3.930824138233536*^9, 3.930824258570298*^9}, {3.930824296213938*^9, 
   3.930824367001339*^9}, {3.930830348891626*^9, 3.930830397322238*^9}, {
   3.930830541865621*^9, 3.930830567565189*^9}, {3.930830604148001*^9, 
   3.93083061349525*^9}, {3.930847276020247*^9, 3.930847326733864*^9}, {
   3.930847768349673*^9, 3.930847888349812*^9}, {3.933260233083667*^9, 
   3.933260234397295*^9}, {3.935551197431448*^9, 3.935551496967121*^9}, {
   3.935551582713168*^9, 3.9355515949769497`*^9}, 3.935552238961692*^9, {
   3.94127167494462*^9, 
   3.941271816069439*^9}},ExpressionUUID->"18926360-5b65-4d8a-83d8-\
f07b944f6259"]
}, Closed]],

Cell[CellGroupData[{

Cell["PreTrace helper", "Subsection",
 CellChangeTimes->{{3.940261642646137*^9, 3.9402616685052233`*^9}, {
  3.943460253240127*^9, 
  3.9434602560241737`*^9}},ExpressionUUID->"bf42ef60-7287-492a-9bb1-\
52ea464446f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PreTrace", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "exprExp", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "Print", "}"}], ",", 
        RowBox[{"DisentangleLorentzStructures", "[", "False", "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"exprExp", "=", 
       RowBox[{"ExpandTerms", "[", 
        RowBox[{
         RowBox[{"expr", "//", "integrateDeltas"}], "//", 
         "InsertSU3GellManns"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"exprExp", "[", 
          RowBox[{"[", 
           RowBox[{"iDia", ",", "2", ",", "iFlavor", ",", "1"}], "]"}], "]"}],
          "=", 
         RowBox[{"SU3GellMannTrace", "[", 
          RowBox[{"ConvertInput", "[", 
           RowBox[{"exprExp", "[", 
            RowBox[{"[", 
             RowBox[{"iDia", ",", "2", ",", "iFlavor", ",", "1"}], "]"}], 
            "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"iDia", ",", 
          RowBox[{"Length", "[", "exprExp", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"iFlavor", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"exprExp", "[", 
            RowBox[{"[", 
             RowBox[{"iDia", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ImplodeTerms", "[", "exprExp", "]"}], "//", 
         "integrateDeltas"}], "//", "QuickSimplify"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.930795724527169*^9, {3.9307981439806833`*^9, 3.930798145923999*^9}, {
   3.930800956767713*^9, 3.930800966481353*^9}, {3.930840693208907*^9, 
   3.930840713432819*^9}, {3.930846695486819*^9, 3.930846711440788*^9}, 
   3.93084722277701*^9, {3.930847427654304*^9, 3.930847435355493*^9}, {
   3.930847493933448*^9, 3.930847524768281*^9}, {3.930847914849099*^9, 
   3.930847915253834*^9}, 3.93084809443848*^9, {3.935551951335071*^9, 
   3.935551954606971*^9}, 3.935552388720077*^9, 3.935553438764934*^9},
 CellLabel->
  "In[759]:=",ExpressionUUID->"5393f01d-ccc6-406d-bb8a-c45c60efc560"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simplification algorithms", "Chapter",
 CellChangeTimes->{{3.930795806151032*^9, 
  3.930795812293353*^9}},ExpressionUUID->"a8ec222a-06c2-4128-8ebf-\
16259da48732"],

Cell[CellGroupData[{

Cell["Momentum  simplifications", "Subsection",
 CellChangeTimes->{{3.93079588507541*^9, 
  3.930795889987945*^9}},ExpressionUUID->"0326ce6d-42d3-484e-afb8-\
ce1d4f618c7b"],

Cell["Some helpers for dealing with the momentum notation.", "Text",ExpressionUUID->"9b5d02cd-e32a-4fa5-a4a5-a6651ddbd837"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SeparateScalarProductsFiniteT", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"UseLorentzLinearity", "[", "expr", "]"}], "//.", 
      RowBox[{"InsertOutputNaming", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"TBsp", "[", 
           RowBox[{"q_", ",", "p_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"TBsps", "[", 
            RowBox[{"q", ",", "p"}], "]"}], "+", 
           RowBox[{
            RowBox[{"TBvec", "[", 
             RowBox[{"q", ",", "0"}], "]"}], 
            RowBox[{"TBvec", "[", 
             RowBox[{"p", ",", "0"}], "]"}]}]}]}], ",", 
         RowBox[{
          RowBox[{"TBvec", "[", 
           RowBox[{"p_", ",", 
            RowBox[{"mu_", "/;", 
             RowBox[{"mu", "=!=", "0"}]}]}], "]"}], ":>", 
          RowBox[{
           RowBox[{"TBvecs", "[", 
            RowBox[{"p", ",", "mu"}], "]"}], "+", 
           RowBox[{
            RowBox[{"TBdeltaLorentz", "[", 
             RowBox[{"mu", ",", "0"}], "]"}], 
            RowBox[{"TBvec", "[", 
             RowBox[{"p", ",", "0"}], "]"}]}]}]}]}], "}"}]}]}]}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExpandScalarProductsFiniteT", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", ",", "p"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"UseLorentzLinearity", "[", "expr", "]"}], "//.", 
       RowBox[{"InsertOutputNaming", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"TBsp", "[", 
           RowBox[{"q_", ",", "p_"}], "]"}], "->", 
          RowBox[{
           RowBox[{"TBsps", "[", 
            RowBox[{"q", ",", "p"}], "]"}], "+", 
           RowBox[{
            RowBox[{"TBvec", "[", 
             RowBox[{"q", ",", "0"}], "]"}], 
            RowBox[{"TBvec", "[", 
             RowBox[{"p", ",", "0"}], "]"}]}]}]}], "}"}]}]}], "//.", 
      RowBox[{"InsertOutputNaming", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"TBsps", "[", 
           RowBox[{"q_", ",", "p_"}], "]"}], "->", 
          RowBox[{"q", " ", "p", " ", 
           RowBox[{"cos", "[", 
            RowBox[{"q", ",", "p"}], "]"}]}]}], ",", " ", 
         RowBox[{
          RowBox[{"cos", "[", 
           RowBox[{"p_", ",", "p_"}], "]"}], "->", "1"}]}], "}"}]}]}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExpandScalarProducts", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", ",", "p"}], "}"}], ",", 
     RowBox[{
      RowBox[{"UseLorentzLinearity", "[", "expr", "]"}], "//.", 
      RowBox[{"InsertOutputNaming", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"TBsp", "[", 
           RowBox[{"q_", ",", "p_"}], "]"}], "->", 
          RowBox[{"q", " ", "p", " ", 
           RowBox[{"cos", "[", 
            RowBox[{"q", ",", "p"}], "]"}]}]}], ",", " ", 
         RowBox[{
          RowBox[{"cos", "[", 
           RowBox[{"p_", ",", "p_"}], "]"}], "->", "1"}]}], "}"}]}]}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"cos", ",", " ", "Orderless"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Derivative", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "[", "cos", "]"}], "[", 
    RowBox[{"p_", ",", "q_"}], "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Derivative", "[", 
      RowBox[{"1", ",", "0"}], "]"}], "[", "cos", "]"}], "[", 
    RowBox[{"p_", ",", "q_"}], "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cos", "[", 
     RowBox[{"p_", ",", "p_"}], "]"}], "=", "1"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyAllMomenta", "[", 
   RowBox[{"q_", ",", "expr_", ",", 
    RowBox[{"qffac_", ":", 
     RowBox[{"\[Pi]", " ", "T"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"UseLorentzLinearity", "[", "expr", "]"}], "//.", 
    RowBox[{"InsertOutputNaming", "@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"cos", "[", 
         RowBox[{"p_", ",", 
          RowBox[{"Symbol", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<f\>\""}], "]"}]}],
          "]"}], ":>", 
        RowBox[{"Symbol", "[", 
         RowBox[{"\"\<cos\>\"", "<>", 
          RowBox[{"ToString", "[", "p", "]"}], "<>", 
          RowBox[{"ToString", "[", "q", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TBvec", "[", 
         RowBox[{"q", ",", "0"}], "]"}], ":>", 
        RowBox[{"Symbol", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<0\>\""}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TBvec", "[", 
         RowBox[{
          RowBox[{"Symbol", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<f\>\""}], "]"}], 
          ",", "0"}], "]"}], ":>", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ClearAll", "[", "T", "]"}], ";", 
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{
             RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<0\>\""}], "]"}], 
           "+", "qffac"}]}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}], "//.", 
   RowBox[{"InsertOutputNaming", "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"cos", "[", 
        RowBox[{"p_", ",", "r_"}], "]"}], ":>", 
       RowBox[{"Symbol", "[", 
        RowBox[{"\"\<cos\>\"", "<>", 
         RowBox[{"ToString", "[", "p", "]"}], "<>", 
         RowBox[{"ToString", "[", "r", "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TBvec", "[", 
        RowBox[{"p_", ",", "0"}], "]"}], ":>", 
       RowBox[{"Symbol", "[", 
        RowBox[{
         RowBox[{"ToString", "[", "p", "]"}], "<>", "\"\<0\>\""}], "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Symbol", "[", 
        RowBox[{
         RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<f\>\""}], "]"}], "->",
        "q"}]}], "\[IndentingNewLine]", "}"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.916559394147103*^9, 3.916559416106717*^9}, {
   3.916559511431814*^9, 3.916559529940345*^9}, {3.9199275266237507`*^9, 
   3.919927527880868*^9}, {3.924141918276387*^9, 3.924142140603898*^9}, {
   3.924151621346219*^9, 3.924151642977441*^9}, {3.9255519751400433`*^9, 
   3.925552044640147*^9}, {3.925552089510874*^9, 3.925552184947348*^9}, 
   3.925552283124244*^9, 3.92555370733145*^9, {3.925554006437672*^9, 
   3.925554033712428*^9}, {3.925556356021154*^9, 3.925556370447487*^9}, {
   3.926515029657043*^9, 3.926515080879002*^9}, {3.9265167541491756`*^9, 
   3.92651675425388*^9}, {3.927004026231244*^9, 3.927004035631996*^9}, {
   3.927422419512899*^9, 3.927422516321888*^9}, {3.927422669980939*^9, 
   3.9274226734406776`*^9}, 3.927422827782792*^9, {3.93330194977221*^9, 
   3.933301952037055*^9}, {3.933301983235136*^9, 3.933301987561928*^9}, {
   3.933302070034832*^9, 3.933302131780591*^9}, {3.9333023143948107`*^9, 
   3.933302323538166*^9}, {3.933302397666047*^9, 3.933302399898086*^9}, {
   3.933302509058119*^9, 3.933302512074614*^9}, {3.933397283585495*^9, 
   3.933397285800907*^9}, {3.935552669272241*^9, 3.935552810457835*^9}, {
   3.9355528637854967`*^9, 3.935552955905051*^9}, {3.935552997619392*^9, 
   3.935553100064673*^9}, {3.93555324117111*^9, 3.9355533128610487`*^9}, {
   3.935558113635854*^9, 3.935558118203428*^9}, {3.935558232523546*^9, 
   3.935558248259296*^9}, {3.937476274405942*^9, 3.937476289995173*^9}, {
   3.943457910978219*^9, 3.943457919145273*^9}, {3.948799335876896*^9, 
   3.948799365721939*^9}},ExpressionUUID->"ce5f50b1-0d9e-4a19-a5f6-\
e20a8fd2e425"],

Cell["We should be also able to access symmetric points.", "Text",ExpressionUUID->"e1b9857b-c39a-48fc-9309-f4d8cc71db28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProjectToSymmetricPoint", "[", 
   RowBox[{
   "expr_", ",", "q_Symbol", ",", "p_Symbol", ",", "momenta___Symbol"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "momentaList", ",", "nMomenta", ",", "rules", ",", "qf", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"conv", "=", "InsertOutputNaming"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"momentaList", "=", 
      RowBox[{"{", "momenta", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nMomenta", "=", 
      RowBox[{"Length", "[", "momentaList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"qf", "=", 
      RowBox[{"Symbol", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<f\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"rules", "=", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBsp", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "->", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"nMomenta", "-", "1"}], ")"}]}], ")"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBsp", "[", 
              RowBox[{"p", ",", "p"}], "]"}]}]}]}], "&"}], ",", 
         RowBox[{"Subsets", "[", 
          RowBox[{"momentaList", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
       "\[Union]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBsp", "[", 
             RowBox[{"#", ",", "#"}], "]"}]}], "->", 
           RowBox[{"conv", "@", 
            RowBox[{"TBsp", "[", 
             RowBox[{"p", ",", "p"}], "]"}]}]}], "&"}], ",", "momentaList"}], 
        "]"}], "\[IndentingNewLine]", "\[Union]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBsp", "[", 
             RowBox[{"#", ",", "q"}], "]"}]}], "->", 
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<cos\>\"", "~~", 
              RowBox[{"ToString", "[", "#", "]"}], "~~", "\"\<q\>\""}], "]"}],
             " ", "p", " ", "q"}]}], "&"}], ",", "momentaList"}], "]"}], 
       "\[IndentingNewLine]", "\[Union]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBsp", "[", 
             RowBox[{"#", ",", "qf"}], "]"}]}], "->", 
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<cos\>\"", "~~", 
              RowBox[{"ToString", "[", "#", "]"}], "~~", "\"\<q\>\""}], "]"}],
             " ", "p", " ", "qf"}]}], "&"}], ",", "momentaList"}], "]"}]}]}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"\[Union]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"momentaList", "[", 
          RowBox[{"[", "nMomenta", "]"}], "]"}], "->", 
         RowBox[{"-", 
          RowBox[{"Total", "[", 
           RowBox[{"momentaList", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", 
              RowBox[{"nMomenta", "-", "1"}]}], "]"}], "]"}], "]"}]}]}], 
        "}"}]}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"UseLorentzLinearity", "[", "expr", "]"}], "//.", "rules"}], 
        "//", "UseLorentzLinearity"}], ")"}], "//.", "rules"}]}]}], "\n", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.916559442541823*^9, 3.9165594451789*^9}, {
   3.926573415046593*^9, 3.926573470871396*^9}, {3.933302352394223*^9, 
   3.933302352562035*^9}, {3.935553339208991*^9, 3.93555335908197*^9}, 
   3.93555832561948*^9, {3.9370533210882273`*^9, 3.937053347292214*^9}, 
   3.937297065189488*^9, 3.937297166581965*^9, 3.9374747029784184`*^9, {
   3.937476323451026*^9, 3.937476340967692*^9}, {3.937482020696939*^9, 
   3.93748202354045*^9}},ExpressionUUID->"810ce3c8-5285-4d8e-a1b5-\
62745856f101"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProjectToSymmetricPointFiniteT", "[", 
   RowBox[{
   "expr_", ",", "q_Symbol", ",", "p_Symbol", ",", "momenta___Symbol"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "momentaList", ",", "nMomenta", ",", "rules", ",", "qf", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"conv", "=", "InsertOutputNaming"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"momentaList", "=", 
      RowBox[{"{", "momenta", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nMomenta", "=", 
      RowBox[{"Length", "[", "momentaList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"qf", "=", 
      RowBox[{"Symbol", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<f\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"rules", "=", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBsps", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "->", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"nMomenta", "-", "1"}], ")"}]}], ")"}]}], 
            RowBox[{"conv", "@", 
             RowBox[{"TBsps", "[", 
              RowBox[{"p", ",", "p"}], "]"}]}]}]}], "&"}], ",", 
         RowBox[{"Subsets", "[", 
          RowBox[{"momentaList", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
       "\[Union]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBsps", "[", 
             RowBox[{"#", ",", "#"}], "]"}]}], "->", 
           RowBox[{"conv", "@", 
            RowBox[{"TBsps", "[", 
             RowBox[{"p", ",", "p"}], "]"}]}]}], "&"}], ",", "momentaList"}], 
        "]"}], "\[IndentingNewLine]", "\[Union]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBsps", "[", 
             RowBox[{"#", ",", "q"}], "]"}]}], "->", 
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<cos\>\"", "~~", 
              RowBox[{"ToString", "[", "#", "]"}], "~~", "\"\<q\>\""}], "]"}],
             " ", "p", " ", "q"}]}], "&"}], ",", "momentaList"}], "]"}], 
       "\[IndentingNewLine]", "\[Union]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"conv", "@", 
            RowBox[{"TBsps", "[", 
             RowBox[{"#", ",", "qf"}], "]"}]}], "->", 
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<cos\>\"", "~~", 
              RowBox[{"ToString", "[", "#", "]"}], "~~", "\"\<q\>\""}], "]"}],
             " ", "p", " ", "qf"}]}], "&"}], ",", "momentaList"}], "]"}]}]}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"\[Union]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"momentaList", "[", 
          RowBox[{"[", "nMomenta", "]"}], "]"}], "->", 
         RowBox[{"-", 
          RowBox[{"Total", "[", 
           RowBox[{"momentaList", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", 
              RowBox[{"nMomenta", "-", "1"}]}], "]"}], "]"}], "]"}]}]}], 
        "}"}]}], "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"SeparateScalarProductsFiniteT", "[", 
          RowBox[{"UseLorentzLinearity", "[", "expr", "]"}], "]"}], "//.", 
         "rules"}], "//", "UseLorentzLinearity"}], ")"}], "//.", 
      "rules"}]}]}], "\n", "]"}]}]], "Input",
 CellChangeTimes->{{3.916559442541823*^9, 3.9165594778406363`*^9}, {
   3.916559555130072*^9, 3.916559557510188*^9}, {3.926573482381485*^9, 
   3.926573503924843*^9}, {3.9333023556343207`*^9, 3.933302371892617*^9}, {
   3.933302412575669*^9, 3.933302414491004*^9}, 3.935553341344554*^9, {
   3.935553383736532*^9, 3.935553389248622*^9}, 3.935558331258843*^9, {
   3.937053358133326*^9, 3.937053362349022*^9}, {3.9374746889491253`*^9, 
   3.937474697238819*^9}, {3.937476344137278*^9, 3.937476345103366*^9}, {
   3.937482031247211*^9, 3.937482033241588*^9}, {3.938505361281211*^9, 
   3.9385053639049387`*^9}, 
   3.943524213088963*^9},ExpressionUUID->"c4d7fbfa-7df7-4fba-b5ff-\
867a707f779c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Simplification helpers", "Subsection",ExpressionUUID->"d835e7bb-e6b5-43e4-9aa1-5568243fcd2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"QuickSimplify", "[", "expr_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"expr", ",", 
      RowBox[{"TimeConstraint", " ", "->", " ", "0.1"}]}], "]"}], " ", "//", 
    " ", "Quiet"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.916035383261191*^9, 3.91603540755576*^9}, {
   3.91839699982629*^9, 3.918397016114456*^9}, {3.918807002886379*^9, 
   3.918807032755312*^9}, {3.921834312192461*^9, 3.9218343263911943`*^9}, {
   3.92200926321909*^9, 3.922009287348166*^9}, 3.923518807356018*^9, {
   3.93555340442406*^9, 3.935553414887597*^9}, {3.943356652910881*^9, 
   3.943356662143195*^9}},ExpressionUUID->"0ec10e2c-8bd4-4f6a-b38c-\
4b355ca1e641"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$StandardSimplify", "=", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetStandardSimplify", "[", "sim_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$StandardSimplify", "=", "sim"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$StandardQuickSimplify", "=", "QuickSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetStandardQuickSimplify", "[", "sim_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$StandardQuickSimplify", "=", "sim"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.923518745330213*^9, 3.923518796941533*^9}, {
  3.938507500164983*^9, 
  3.938507511856111*^9}},ExpressionUUID->"36a20289-4b57-4a63-bfe2-\
e6dd1069aed2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AdjustToNKernels", "[", "nKernels_Integer", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nKernels", "!=", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CloseKernels", "[", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"LaunchKernels", "[", "nKernels", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "DistributeDefinitions", "[", "\"\<TensorBases`Private`\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"DistributeDefinitions", "[", "\"\<FormTracer`\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"DistributeDefinitions", "[", 
         RowBox[{"ExtendedFormTrace", ",", "InsertChargeConjRules"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RestoreKernels", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CloseKernels", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"LaunchKernels", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "DistributeDefinitions", "[", "\"\<TensorBases`Private`\>\"", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"DistributeDefinitions", "[", "\"\<FormTracer`\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DistributeDefinitions", "[", 
      RowBox[{"ExtendedFormTrace", ",", "InsertChargeConjRules"}], "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DiFfRGMap", "[", "nKernels_Integer", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nKernels", "<=", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"ResourceFunction", "[", "\"\<DynamicMap\>\"", "]"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ResourceFunction", "[", "\"\<DynamicMap\>\"", "]"}], "[", 
           
           RowBox[{"#1", ",", "#2", ",", 
            RowBox[{"Parallel", "->", "nKernels"}]}], "]"}], "&"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.9220094809922523`*^9, {3.92209530643522*^9, 3.9220953073003807`*^9}, {
   3.92209570934629*^9, 3.9220957111308537`*^9}, 3.922095747060678*^9, {
   3.922096796328022*^9, 3.9220967997722263`*^9}, {3.9220968463757*^9, 
   3.922096877107787*^9}, {3.924145268445999*^9, 3.9241452971583853`*^9}, {
   3.924145429074662*^9, 3.924145438620611*^9}, {3.924145879496249*^9, 
   3.924145889617326*^9}, {3.924145933514007*^9, 3.924145933895958*^9}, {
   3.924146380579197*^9, 3.924146385560205*^9}, {3.924146428128695*^9, 
   3.924146443674434*^9}, {3.93281804908258*^9, 3.932818049942231*^9}, {
   3.941103147238089*^9, 
   3.941103152829924*^9}},ExpressionUUID->"49ae4092-f819-416e-bb7a-\
6589b3b78079"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finishing package", "Chapter",
 CellChangeTimes->{{3.919139867121632*^9, 
  3.919139874722487*^9}},ExpressionUUID->"eb83e232-65a2-4d0f-bb6d-\
f0945c3adc5b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"End", "[", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.943460195403545*^9, 3.943460198755838*^9}, 
   3.9434659664261913`*^9},ExpressionUUID->"509cad0d-91ac-465f-84aa-\
0c407dd8447e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Protect", "[", "\"\<DiFfRG`*\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.932041570050847*^9, 3.932041572308077*^9}, {
   3.9338200005526*^9, 3.933820001984568*^9}, 3.935485891940338*^9},
 CellLabel->
  "In[795]:=",ExpressionUUID->"11168ab6-9d39-4066-ac78-95e82059e15d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"EndPackage", "[", "]"}], ";"}], "*)"}]], "Code",
 CellChangeTimes->{3.935550736988943*^9, 3.9434596065541353`*^9, 
  3.943465963956756*^9},ExpressionUUID->"0b9eddaf-13f2-4674-aa20-\
9e441963e625"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
InitializationCellEvaluation->False,
InitializationCellWarning->False,
WindowSize->{1200, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.7 Inherited,
FrontEndVersion->"14.1 for Linux x86 (64-bit) (July 16, 2024)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Input"], InitializationCell -> True]}, Visible -> False, 
  FrontEndVersion -> "14.1 for Linux x86 (64-bit) (July 16, 2024)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"f773db9b-bac4-428f-be6f-dd7aa2b60e55"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 163, 3, 67, "Title",ExpressionUUID->"6248d5fa-c573-4525-a670-9e386e01b70a"],
Cell[CellGroupData[{
Cell[768, 29, 158, 3, 47, "Chapter",ExpressionUUID->"2e9a49bb-c5b9-4ce9-8785-5639cec0c785"],
Cell[CellGroupData[{
Cell[951, 36, 161, 3, 46, "Section",ExpressionUUID->"da5a7dc4-ae9d-446f-93ac-ea9cd52b1279"],
Cell[CellGroupData[{
Cell[1137, 43, 1008, 18, 91, "Input",ExpressionUUID->"94c25270-d3c0-4203-b83e-cd7c70b60a77"],
Cell[2148, 63, 4610, 68, 67, "Print",ExpressionUUID->"412ae56e-d50c-4fb0-97f4-ff95f2c10346"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6807, 137, 206, 4, 46, "Section",ExpressionUUID->"4dc5bed6-6c6a-4d50-aeab-1ddf7e9466bf"],
Cell[7016, 143, 1560, 39, 155, "Input",ExpressionUUID->"b248f05d-2dbc-4846-aac9-694723e61de3"],
Cell[8579, 184, 449, 9, 32, "Input",ExpressionUUID->"eef75579-ae63-4ec4-a33b-b226833913f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9065, 198, 197, 4, 46, "Section",ExpressionUUID->"1acf37e7-e1e9-4f65-abab-efb2f0611907"],
Cell[9265, 204, 1628, 33, 95, "Input",ExpressionUUID->"0ecf2351-416b-4029-aab2-5caad4646302",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[10930, 242, 174, 3, 46, "Section",ExpressionUUID->"099d12f8-45f0-4498-861c-4146c22241e3"],
Cell[11107, 247, 1085, 25, 130, "Input",ExpressionUUID->"f0438960-5e66-4714-ab13-348d02ca9679"],
Cell[12195, 274, 403, 9, 45, "Input",ExpressionUUID->"9368b5d6-feeb-454a-8d00-94cd703784f6"],
Cell[12601, 285, 416, 9, 45, "Input",ExpressionUUID->"b7a9e79b-a6ff-4ce9-a961-d0b7ede31244"],
Cell[13020, 296, 508, 10, 45, "Input",ExpressionUUID->"e984b499-c21d-4662-82c3-8e51dad58e88"],
Cell[13531, 308, 314, 7, 45, "Input",ExpressionUUID->"0e042229-5a4f-4fb5-a9d1-845b7b27e442"],
Cell[13848, 317, 360, 7, 47, "Input",ExpressionUUID->"af7781f0-142e-49aa-b767-d384ba23c0fe"],
Cell[14211, 326, 3021, 70, 314, "Input",ExpressionUUID->"0b416ff5-f4df-4493-8255-266f3e2d1fc1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17269, 401, 159, 3, 46, "Section",ExpressionUUID->"d9e7f4e0-bee1-441c-9357-518ec0e70346"],
Cell[17431, 406, 250, 5, 32, "Input",ExpressionUUID->"d3d9ecf5-81b9-41a4-ba9e-d222237bb21d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17730, 417, 199, 4, 47, "Chapter",ExpressionUUID->"d2b37a69-1798-45aa-ba74-ac366e35523f"],
Cell[17932, 423, 200, 3, 23, "Text",ExpressionUUID->"ad5cdf87-2437-494b-bacf-1d106e594491"],
Cell[18135, 428, 567, 16, 48, "Input",ExpressionUUID->"bd12fd7b-1c57-476f-b00d-ba3c6dae4d82"],
Cell[18705, 446, 2359, 53, 185, "Input",ExpressionUUID->"045d2a29-83b2-45f3-9096-804f8428948f",
 InitializationCell->True],
Cell[21067, 501, 2242, 50, 203, "Input",ExpressionUUID->"2249301c-6588-4290-93cc-6173e59d7027"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23346, 556, 208, 4, 47, "Chapter",ExpressionUUID->"4db05b9d-0e6c-46c1-8bc4-444d96782a81"],
Cell[23557, 562, 167, 3, 23, "Text",ExpressionUUID->"f39e01f0-a434-46ca-b8c9-036dc7d8a61d"],
Cell[23727, 567, 7364, 192, 360, "Input",ExpressionUUID->"7960f290-05bc-46c9-9e8a-e030620c84a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31128, 764, 164, 3, 47, "Chapter",ExpressionUUID->"f5ab99e5-bf40-4be4-99bc-a45c18eb6844"],
Cell[31295, 769, 4397, 90, 259, "Input",ExpressionUUID->"6f9d9584-8426-4353-ba5b-d7eb6fd0cc66"],
Cell[35695, 861, 3794, 94, 264, "Input",ExpressionUUID->"55d7a86d-c906-48bd-a3bf-992b994560a1"],
Cell[CellGroupData[{
Cell[39514, 959, 169, 3, 37, "Subsection",ExpressionUUID->"12b52e25-a4c7-4a18-be0b-c15de07921b6"],
Cell[39686, 964, 245, 6, 23, "Text",ExpressionUUID->"3361abb5-df92-442c-b140-951784d155e0"],
Cell[39934, 972, 14653, 323, 766, "Input",ExpressionUUID->"f4637967-a96d-48f9-b7db-410a0759650a"],
Cell[54590, 1297, 18691, 448, 787, "Input",ExpressionUUID->"18926360-5b65-4d8a-83d8-f07b944f6259"]
}, Closed]],
Cell[CellGroupData[{
Cell[73318, 1750, 216, 4, 27, "Subsection",ExpressionUUID->"bf42ef60-7287-492a-9bb1-52ea464446f9"],
Cell[73537, 1756, 2367, 57, 111, "Input",ExpressionUUID->"5393f01d-ccc6-406d-bb8a-c45c60efc560",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[75953, 1819, 170, 3, 47, "Chapter",ExpressionUUID->"a8ec222a-06c2-4128-8ebf-16259da48732"],
Cell[CellGroupData[{
Cell[76148, 1826, 172, 3, 37, "Subsection",ExpressionUUID->"0326ce6d-42d3-484e-afb8-ce1d4f618c7b"],
Cell[76323, 1831, 123, 0, 23, "Text",ExpressionUUID->"9b5d02cd-e32a-4fa5-a4a5-a6651ddbd837"],
Cell[76449, 1833, 8068, 209, 499, "Input",ExpressionUUID->"ce5f50b1-0d9e-4a19-a5f6-e20a8fd2e425"],
Cell[84520, 2044, 121, 0, 23, "Text",ExpressionUUID->"e1b9857b-c39a-48fc-9309-f4d8cc71db28"],
Cell[84644, 2046, 4354, 115, 239, "Input",ExpressionUUID->"810ce3c8-5285-4d8e-a1b5-62745856f101"],
Cell[89001, 2163, 4618, 119, 255, "Input",ExpressionUUID->"c4d7fbfa-7df7-4fba-b5ff-867a707f779c"]
}, Closed]],
Cell[CellGroupData[{
Cell[93656, 2287, 99, 0, 27, "Subsection",ExpressionUUID->"d835e7bb-e6b5-43e4-9aa1-5568243fcd2d"],
Cell[93758, 2289, 752, 16, 32, "Input",ExpressionUUID->"0ec10e2c-8bd4-4f6a-b38c-4b355ca1e641",
 InitializationCell->True],
Cell[94513, 2307, 966, 26, 136, "Input",ExpressionUUID->"36a20289-4b57-4a63-bfe2-e6dd1069aed2"],
Cell[95482, 2335, 3243, 72, 359, "Input",ExpressionUUID->"49ae4092-f819-416e-bb7a-6589b3b78079"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[98774, 2413, 162, 3, 47, "Chapter",ExpressionUUID->"eb83e232-65a2-4d0f-bb6d-f0945c3adc5b"],
Cell[98939, 2418, 227, 5, 32, "Input",ExpressionUUID->"509cad0d-91ac-465f-84aa-0c407dd8447e"],
Cell[99169, 2425, 312, 6, 32, "Input",ExpressionUUID->"11168ab6-9d39-4066-ac78-95e82059e15d"],
Cell[99484, 2433, 249, 6, 37, "Code",ExpressionUUID->"0b9eddaf-13f2-4674-aa20-9e441963e625"]
}, Open  ]]
}, Open  ]]
}
]
*)

